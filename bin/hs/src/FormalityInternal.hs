module FormalityInternal where
import Unsafe.Coerce
import Data.Word
import Data.Bits
import Debug.Trace
u = unsafeCoerce
run p = case p of {
  (1,f) -> (u f (\query param cont-> case query of {
    "print"    -> do { putStrLn param; run (cont ()); };
    "get_line" -> do { line <- getLine; run (u cont line); };
    "get_file" -> do { line <- readFile param; run (u cont line); };
    otherwise  -> do { u cont (); };
  }));
  (0,f) -> (u f (\value-> do { (return :: a -> IO a) value; }));
}
word_to_u16       w        = u word_to_u16_go 0 w 0
word_to_u16_go 16 w      x = u x
word_to_u16_go  i (0,f)  x = u word_to_u16_go (i+1) (0,\t-> t) (x::Word16)
word_to_u16_go  i (1,f)  x = u f (\w-> word_to_u16_go (i+1) w x)
word_to_u16_go  i (2,f)  x = u f (\w-> word_to_u16_go (i+1) w (x .|. (shiftL 1 i)))
u16_to_word       x        = u u16_to_word_go 0 x (0,\t-> t)
u16_to_word_go 16 x      w = u w
u16_to_word_go  i x      w = u u16_to_word_go (i+1) (x::Word16) (if (shiftR x (16-i-1) .&. 1) > 0 then (2,\t-> t w) else (1,\t-> t w))
monad_bind = (\_m_2-> (let _0 = _m_2 in (case _0 of {(0,f) -> u f (\_1 _2-> _1); })))
io = (\_a_1-> ())
monad_new = (\_bind_2-> (\_pure_3-> (0,\t-> t _bind_2 _pure_3)))
io_ask = (\_query_2-> (\_param_3-> (\_then_4-> (1,\t-> t _query_2 _param_3 _then_4))))
io_bind = (\_a_3-> (\_f_4-> (let _3 = _a_3 in (case _3 of {(0,f) -> u f (\_4-> (u _f_4 _4)); (1,f) -> u f (\_5 _6 _7-> (u (u (u io_ask _5) _6) (\_x_8-> (u (u io_bind (u _7 _x_8)) _f_4)))); }))))
io_end = (\_value_2-> (0,\t-> t _value_2))
io_monad = (u (u monad_new io_bind) io_end)
map = (\_a_1-> ())
maybe = (\_a_1-> ())
maybe_none = (0,\t-> t)
map_get = (\_bits_2-> (\_map_3-> (let _8 = _bits_2 in (case _8 of {(0,f) -> u f ((let _9 = _map_3 in (case _9 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_10 _11 _12-> _10); }))); (1,f) -> u f (\_13-> (let _14 = _map_3 in (case _14 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_15 _16 _17-> (u (u map_get _13) _16)); }))); (2,f) -> u f (\_18-> (let _19 = _map_3 in (case _19 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_20 _21 _22-> (u (u map_get _18) _22)); }))); }))))
bits_e = (0,\t-> t)
bool_false = False
bool_and = (\a0-> \a1-> (a0 && a1))
bool_true = True
cmp_as_lte = (\_cmp_1-> (let _23 = _cmp_1 in (case _23 of {(0,f) -> u f (bool_true); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
cmp_ltn = (0,\t-> t)
cmp_gtn = (2,\t-> t)
word_cmp_go = (\_a_2-> (\_b_3-> (\_c_4-> (let _24 = _a_2 in (case _24 of {(0,f) -> u f ((\_b_5-> _c_4)); (1,f) -> u f (\_25-> (\_b_7-> (let _26 = _b_7 in (case _26 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_27-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _27) _c_4))); (2,f) -> u f (\_28-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _28) cmp_ltn))); })) _25)); (2,f) -> u f (\_29-> (\_b_7-> (let _30 = _b_7 in (case _30 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_31-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _31) cmp_gtn))); (2,f) -> u f (\_32-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _32) _c_4))); })) _29)); })) _b_3)))
cmp_eql = (1,\t-> t)
word_cmp = (\_a_2-> (\_b_3-> (u (u (u word_cmp_go _a_2) _b_3) cmp_eql)))
word_lte = (\_a_2-> (\_b_3-> (u cmp_as_lte (u (u word_cmp _a_2) _b_3))))
nat_succ = (\_pred_1-> 1+_pred_1)
nat_zero = 0
u16_lte = (\a0-> \a1-> ((a0::Word16) <= a1))
u16_btw = (\_a_1-> (\_b_2-> (\_c_3-> (((((_a_1::Word16) <= _b_2)) && (((_b_2::Word16) <= _c_3)))))))
u16_new = (\_value_1-> (word_to_u16 _value_1))
word_e = (0,\t-> t)
word = (\_size_1-> ())
word_i = (\_pred_2-> (2,\t-> t _pred_2))
word_o = (\_pred_2-> (1,\t-> t _pred_2))
word_subber = (\_a_2-> (\_b_3-> (\_c_4-> (let _33 = _a_2 in (case _33 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_34-> (\_b_7-> (let _35 = _b_7 in (case _35 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_36-> (\_a_pred_10-> (let _37 = _c_4 in (if _37 then (u word_i (u (u (u word_subber _a_pred_10) _36) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _36) bool_false)))))); (2,f) -> u f (\_38-> (\_a_pred_10-> (let _39 = _c_4 in (if _39 then (u word_o (u (u (u word_subber _a_pred_10) _38) bool_true)) else (u word_i (u (u (u word_subber _a_pred_10) _38) bool_true)))))); })) _34)); (2,f) -> u f (\_40-> (\_b_7-> (let _41 = _b_7 in (case _41 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_42-> (\_a_pred_10-> (let _43 = _c_4 in (if _43 then (u word_o (u (u (u word_subber _a_pred_10) _42) bool_false)) else (u word_i (u (u (u word_subber _a_pred_10) _42) bool_false)))))); (2,f) -> u f (\_44-> (\_a_pred_10-> (let _45 = _c_4 in (if _45 then (u word_i (u (u (u word_subber _a_pred_10) _44) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _44) bool_false)))))); })) _40)); })) _b_3)))
word_sub = (\_a_2-> (\_b_3-> (u (u (u word_subber _a_2) _b_3) bool_false)))
u16_sub = (\a0-> \a1-> ((a0::Word16) - a1))
nat_apply = (\_n_2-> (\_f_3-> (\_x_4-> (let _46 = _n_2 in (if _46==0 then _x_4 else (u (u (u nat_apply (_46-1)) _f_3) (u _f_3 _x_4)))))))
word_inc = (\_word_2-> (let _47 = _word_2 in (case _47 of {(0,f) -> u f (word_e); (1,f) -> u f (\_48-> (u word_i _48)); (2,f) -> u f (\_49-> (u word_o (u word_inc _49))); })))
u16_inc = (\_a_1-> (let _50 = _a_1 in (u u16_new (u word_inc (u16_to_word _50)))))
word_zero = (\_size_1-> (let _51 = _size_1 in (if _51==0 then word_e else (u word_o (u word_zero (_51-1))))))
u16_zero = (u u16_new (u word_zero 16))
nat_to_u16 = (\a0-> (fromIntegral (a0::Integer)))
word_adder = (\_a_2-> (\_b_3-> (\_c_4-> (let _52 = _a_2 in (case _52 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_53-> (\_b_7-> (let _54 = _b_7 in (case _54 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_55-> (\_a_pred_10-> (let _56 = _c_4 in (if _56 then (u word_i (u (u (u word_adder _a_pred_10) _55) bool_false)) else (u word_o (u (u (u word_adder _a_pred_10) _55) bool_false)))))); (2,f) -> u f (\_57-> (\_a_pred_10-> (let _58 = _c_4 in (if _58 then (u word_o (u (u (u word_adder _a_pred_10) _57) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _57) bool_false)))))); })) _53)); (2,f) -> u f (\_59-> (\_b_7-> (let _60 = _b_7 in (case _60 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_61-> (\_a_pred_10-> (let _62 = _c_4 in (if _62 then (u word_o (u (u (u word_adder _a_pred_10) _61) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _61) bool_false)))))); (2,f) -> u f (\_63-> (\_a_pred_10-> (let _64 = _c_4 in (if _64 then (u word_i (u (u (u word_adder _a_pred_10) _63) bool_true)) else (u word_o (u (u (u word_adder _a_pred_10) _63) bool_true)))))); })) _59)); })) _b_3)))
word_add = (\_a_2-> (\_b_3-> (u (u (u word_adder _a_2) _b_3) bool_false)))
u16_add = (\a0-> \a1-> ((a0::Word16) + a1))
cmp_as_eql = (\_cmp_1-> (let _65 = _cmp_1 in (case _65 of {(0,f) -> u f (bool_false); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
word_eql = (\_a_2-> (\_b_3-> (u cmp_as_eql (u (u word_cmp _a_2) _b_3))))
u16_eql = (\a0-> \a1-> ((a0::Word16) == a1))
bits_o = (\_pred_1-> (1,\t-> t _pred_1))
bits_i = (\_pred_1-> (2,\t-> t _pred_1))
word_to_bits = (\_a_2-> (let _66 = _a_2 in (case _66 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_67-> (u bits_o (u word_to_bits _67))); (2,f) -> u f (\_68-> (u bits_i (u word_to_bits _68))); })))
word_trim = (\_new_size_2-> (\_word_3-> (let _69 = _new_size_2 in (if _69==0 then word_e else (let _70 = _word_3 in (case _70 of {(0,f) -> u f ((u word_o (u (u word_trim (_69-1)) word_e))); (1,f) -> u f (\_71-> (u word_o (u (u word_trim (_69-1)) _71))); (2,f) -> u f (\_72-> (u word_i (u (u word_trim (_69-1)) _72))); }))))))
bits_concat = (\_a_1-> (\_b_2-> (let _73 = _a_1 in (case _73 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_74-> (u bits_o (u (u bits_concat _74) _b_2))); (2,f) -> u f (\_75-> (u bits_i (u (u bits_concat _75) _b_2))); }))))
bits_reverse_tco = (\_a_1-> (\_r_2-> (let _76 = _a_1 in (case _76 of {(0,f) -> u f (_r_2); (1,f) -> u f (\_77-> (u (u bits_reverse_tco _77) (u bits_o _r_2))); (2,f) -> u f (\_78-> (u (u bits_reverse_tco _78) (u bits_i _r_2))); }))))
bits_reverse = (\_a_1-> (u (u bits_reverse_tco _a_1) bits_e))
fm_name_to_bits = (\_name_1-> (let _79 = _name_1 in (if null (_79::String) then bits_e else (let _chr_4=(fromIntegral (fromEnum (head _79 :: Char)) :: Word16) in (let _u16_5=(let _80 = (u (u (u u16_btw 65) _chr_4) 90) in (if _80 then (((_chr_4::Word16) - 65)) else (let _81 = (u (u (u u16_btw 97) _chr_4) 122) in (if _81 then (((_chr_4::Word16) - 71)) else (let _82 = (u (u (u u16_btw 48) _chr_4) 57) in (if _82 then (((_chr_4::Word16) + 4)) else (let _83 = (((46::Word16) == _chr_4)) in (if _83 then 62 else (let _84 = (((95::Word16) == _chr_4)) in (if _84 then 63 else 0)))))))))) in (let _bts_6=(let _85 = _u16_5 in (u word_to_bits (u (u word_trim 6) (u16_to_word _85)))) in (u (u bits_concat (u bits_reverse _bts_6)) (u fm_name_to_bits (tail _79)))))))))
fm_get = (\_name_2-> (\_map_3-> (u (u map_get (u fm_name_to_bits _name_2)) _map_3)))
string_cons = (\_head_1-> (\_tail_2-> ((toEnum (fromIntegral _head_1 :: Int) :: Char) : _tail_2)))
fm_synth_file_of = (\_name_1-> (let _86 = _name_1 in (if null (_86::String) then ".fm" else (let _87 = ((((fromIntegral (fromEnum (head _86 :: Char)) :: Word16)::Word16) == 46)) in (if _87 then ".fm" else (u (u string_cons (fromIntegral (fromEnum (head _86 :: Char)) :: Word16)) (u fm_synth_file_of (tail _86))))))))
io_get_file = (\_name_1-> (u (u (u io_ask "get_file") _name_1) (\_file_2-> (u io_end _file_2))))
parser = (\_v_1-> ())
parser_reply = (\_v_1-> ())
parser_reply_error = (\_idx_2-> (\_code_3-> (\_err_4-> (0,\t-> t _idx_2 _code_3 _err_4))))
parser_bind = (\_parse_3-> (\_next_4-> (\_idx_5-> (\_code_6-> (let _88 = (u (u _parse_3 _idx_5) _code_6) in (case _88 of {(0,f) -> u f (\_89 _90 _91-> (u (u (u parser_reply_error _89) _90) _91)); (1,f) -> u f (\_92 _93 _94-> (u (u (u _next_4 _94) _92) _93)); }))))))
parser_reply_value = (\_idx_2-> (\_code_3-> (\_val_4-> (1,\t-> t _idx_2 _code_3 _val_4))))
parser_pure = (\_value_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_value _idx_3) _code_4) _value_2))))
parser_monad = (u (u monad_new parser_bind) parser_pure)
parser_is_eof = (\_idx_1-> (\_code_2-> (let _95 = _code_2 in (if null (_95::String) then (u (u (u parser_reply_value _idx_1) _code_2) bool_true) else (u (u (u parser_reply_value _idx_1) _code_2) bool_false)))))
monad_pure = (\_m_2-> (let _96 = _m_2 in (case _96 of {(0,f) -> u f (\_97 _98-> _98); })))
maybe_some = (\_value_2-> (1,\t-> t _value_2))
parser_errorat_new = (\_idx_1-> (\_code_2-> (\_err_3-> (0,\t-> t _idx_1 _code_2 _err_3))))
nat_gtn = (\a0-> \a1-> ((a0::Integer) > a1))
parser_errorat_combine = (\_a_1-> (\_b_2-> (let _99 = _a_1 in (case _99 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_100-> (let _101 = _b_2 in (case _101 of {(0,f) -> u f (_a_1); (1,f) -> u f (\_102-> (let _103 = _100 in (case _103 of {(0,f) -> u f (\_104 _105 _106-> (let _107 = _102 in (case _107 of {(0,f) -> u f (\_108 _109 _110-> (let _111 = (((_104::Integer) > _108)) in (if _111 then _a_1 else _b_2))); }))); }))); }))); }))))
parser_first_of_go = (\_pars_2-> (\_err_3-> (\_idx_4-> (\_code_5-> (let _112 = _pars_2 in (case _112 of {(0,f) -> u f ((let _113 = _err_3 in (case _113 of {(0,f) -> u f ((u (u (u parser_reply_error _idx_4) _code_5) "No parse.")); (1,f) -> u f (\_114-> (let _115 = _114 in (case _115 of {(0,f) -> u f (\_116 _117 _118-> (u (u (u parser_reply_error _116) _117) _118)); }))); }))); (1,f) -> u f (\_119 _120-> (let _parsed_8=(u (u _119 _idx_4) _code_5) in (let _121 = _parsed_8 in (case _121 of {(0,f) -> u f (\_122 _123 _124-> (let _neo_12=(u maybe_some (u (u (u parser_errorat_new _122) _123) _124)) in (let _err_13=(u (u parser_errorat_combine _neo_12) _err_3) in (u (u (u (u parser_first_of_go _120) _err_13) _idx_4) _code_5)))); (1,f) -> u f (\_125 _126 _127-> (u (u (u parser_reply_value _125) _126) _127)); })))); }))))))
parser_first_of = (\_pars_2-> (u (u parser_first_of_go _pars_2) maybe_none))
list_cons = (\_head_2-> (\_tail_3-> (1,\t-> t _head_2 _tail_3)))
list = (\_a_1-> ())
list_nil = (0,\t-> t)
parser_many_go = (\_parse_2-> (\_values_3-> (\_idx_4-> (\_code_5-> (let _128 = (u (u _parse_2 _idx_4) _code_5) in (case _128 of {(0,f) -> u f (\_129 _130 _131-> (u (u (u parser_reply_value _idx_4) _code_5) (u _values_3 list_nil))); (1,f) -> u f (\_132 _133 _134-> (u (u (u (u parser_many_go _parse_2) (\_xs_9-> (u _values_3 (u (u list_cons _134) _xs_9)))) _132) _133)); }))))))
parser_many = (\_parser_2-> (u (u parser_many_go _parser_2) (\_x_3-> _x_3)))
unit_new = ()
string_concat = (\a0-> \a1-> ((a0::String) ++ a1))
string_flatten_go = (\_xs_1-> (\_res_2-> (let _135 = _xs_1 in (case _135 of {(0,f) -> u f (_res_2); (1,f) -> u f (\_136 _137-> (u (u string_flatten_go _137) (((_res_2::String) ++ _136)))); }))))
string_flatten = (\_xs_1-> (u (u string_flatten_go _xs_1) ""))
string_nil = []
parser_text_go = (\_text_1-> (\_idx_2-> (\_code_3-> (let _138 = _text_1 in (if null (_138::String) then (u (u (u parser_reply_value _idx_2) _code_3) unit_new) else (let _139 = _code_3 in (if null (_139::String) then (let _error_6=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found end of file.") list_nil)))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_6)) else (let _140 = ((((fromIntegral (fromEnum (head _138 :: Char)) :: Word16)::Word16) == (fromIntegral (fromEnum (head _139 :: Char)) :: Word16))) in (if _140 then (u (u (u parser_text (tail _138)) (u nat_succ _idx_2)) (tail _139)) else (let _error_8=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found '") (u (u list_cons (u (u string_cons (fromIntegral (fromEnum (head _139 :: Char)) :: Word16)) string_nil)) (u (u list_cons "'.") list_nil)))))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_8)))))))))))
parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _141 = (u (u (u parser_text_go _text_1) _idx_2) _code_3) in (case _141 of {(0,f) -> u f (\_142 _143 _144-> (u (u (u parser_reply_error _idx_2) _code_3) _144)); (1,f) -> u f (\_145 _146 _147-> (u (u (u parser_reply_value _145) _146) _147)); })))))
parser_until_go = (\_until_2-> (\_parse_3-> (\_values_4-> (\_idx_5-> (\_code_6-> (let _until_reply_7=(u (u _until_2 _idx_5) _code_6) in (let _148 = _until_reply_7 in (case _148 of {(0,f) -> u f (\_149 _150 _151-> (let _reply_11=(u (u _parse_3 _idx_5) _code_6) in (let _152 = _reply_11 in (case _152 of {(0,f) -> u f (\_153 _154 _155-> (u (u (u parser_reply_error _153) _154) _155)); (1,f) -> u f (\_156 _157 _158-> (u (u (u (u (u parser_until_go _until_2) _parse_3) (\_xs_15-> (u _values_4 (u (u list_cons _158) _xs_15)))) _156) _157)); })))); (1,f) -> u f (\_159 _160 _161-> (u (u (u parser_reply_value _159) _160) (u _values_4 list_nil))); }))))))))
parser_until = (\_until_2-> (\_parse_3-> (u (u (u parser_until_go _until_2) _parse_3) (\_x_4-> _x_4))))
parser_one = (\_idx_1-> (\_code_2-> (let _162 = _code_2 in (if null (_162::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected end of file.") else (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _162)) (fromIntegral (fromEnum (head _162 :: Char)) :: Word16))))))
fm_parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) (u (u list_cons (u (u (u monad_bind parser_monad) (u parser_text "//")) (\__1-> (u (u (u monad_bind parser_monad) (u (u parser_until (u parser_text "\n")) parser_one)) (\__2-> (u (u monad_pure parser_monad) unit_new)))))) list_nil)))))
fm_parser_text = (\_text_1-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__2-> (u parser_text _text_1))))
parser_many1 = (\_parser_2-> (u (u (u monad_bind parser_monad) _parser_2) (\_head_3-> (u (u (u monad_bind parser_monad) (u parser_many _parser_2)) (\_tail_4-> (u (u monad_pure parser_monad) (u (u list_cons _head_3) _tail_4)))))))
fm_name_is_letter = (\_chr_1-> (let _163 = (u (u (u u16_btw 65) _chr_1) 90) in (if _163 then bool_true else (let _164 = (u (u (u u16_btw 97) _chr_1) 122) in (if _164 then bool_true else (let _165 = (u (u (u u16_btw 48) _chr_1) 57) in (if _165 then bool_true else (let _166 = (((46::Word16) == _chr_1)) in (if _166 then bool_true else (let _167 = (((95::Word16) == _chr_1)) in (if _167 then bool_true else bool_false)))))))))))
fm_parser_letter = (\_idx_1-> (\_code_2-> (let _168 = _code_2 in (if null (_168::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected eof.") else (let _169 = (u fm_name_is_letter (fromIntegral (fromEnum (head _168 :: Char)) :: Word16)) in (if _169 then (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _168)) (fromIntegral (fromEnum (head _168 :: Char)) :: Word16)) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected letter.")))))))
list_fold = (\_list_2-> (\_nil_4-> (\_cons_5-> (let _170 = _list_2 in (case _170 of {(0,f) -> u f (_nil_4); (1,f) -> u f (\_171 _172-> (u (u _cons_5 _171) (u (u (u list_fold _172) _nil_4) _cons_5))); })))))
fm_parser_name1 = (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__1-> (u (u (u monad_bind parser_monad) (u parser_many1 fm_parser_letter)) (\_chrs_2-> (u (u monad_pure parser_monad) (u (u (u list_fold _chrs_2) string_nil) string_cons))))))
pair = (\_a_1-> (\_b_2-> ()))
parser_until1 = (\_cond_2-> (\_parser_3-> (u (u (u monad_bind parser_monad) _parser_3) (\_head_4-> (u (u (u monad_bind parser_monad) (u (u parser_until _cond_2) _parser_3)) (\_tail_5-> (u (u monad_pure parser_monad) (u (u list_cons _head_4) _tail_5))))))))
parser_maybe = (\_parse_2-> (\_idx_3-> (\_code_4-> (let _173 = (u (u _parse_2 _idx_3) _code_4) in (case _173 of {(0,f) -> u f (\_174 _175 _176-> (u (u (u parser_reply_value _idx_3) _code_4) maybe_none)); (1,f) -> u f (\_177 _178 _179-> (u (u (u parser_reply_value _177) _178) (u maybe_some _179))); })))))
fm_parser_item = (\_parser_2-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__3-> (u (u (u monad_bind parser_monad) _parser_2) (\_value_4-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ","))) (\__5-> (u (u monad_pure parser_monad) _value_4))))))))
fm_parser_name = (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__1-> (u (u (u monad_bind parser_monad) (u parser_many fm_parser_letter)) (\_chrs_2-> (u (u monad_pure parser_monad) (u (u (u list_fold _chrs_2) string_nil) string_cons))))))
parser_get_code = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _code_2)))
parser_get_index = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _idx_1)))
fm_parser_init = (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__1-> (u (u (u monad_bind parser_monad) parser_get_index) (\_from_2-> (u (u monad_pure parser_monad) _from_2)))))
fm_origin_new = (\_file_1-> (\_from_2-> (\_upto_3-> (0,\t-> t _file_1 _from_2 _upto_3))))
fm_parser_stop = (\_from_1-> (u (u (u monad_bind parser_monad) parser_get_index) (\_upto_2-> (let _orig_3=(u (u (u fm_origin_new "") _from_1) _upto_2) in (u (u monad_pure parser_monad) _orig_3)))))
fm_term_ori = (\_orig_1-> (\_expr_2-> (15,\t-> t _orig_1 _expr_2)))
fm_term_typ = (2,\t-> t)
fm_parser_type = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "Type")) (\__2-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_3-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_3) fm_term_typ))))))))
fm_term_all = (\_eras_1-> (\_self_2-> (\_name_3-> (\_xtyp_4-> (\_body_5-> (3,\t-> t _eras_1 _self_2 _name_3 _xtyp_4 _body_5))))))
fm_parser_forall = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) fm_parser_name) (\_self_2-> (u (u (u monad_bind parser_monad) fm_parser_binder) (\_bind_3-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text "->"))) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_5-> (let _term_6=(u (u (u list_fold _bind_3) _body_5) (\_x_6-> (\_t_7-> (let _180 = _x_6 in (case _180 of {(0,f) -> u f (\_181 _182 _183-> (u (u (u (u (u fm_term_all _181) "") _182) _183) (\_s_11-> (\_x_12-> _t_7)))); }))))) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_7-> (u (u monad_pure parser_monad) (let _184 = _term_6 in (case _184 of {(0,f) -> u f (\_185 _186-> _term_6); (1,f) -> u f (\_187-> _term_6); (2,f) -> u f (_term_6); (3,f) -> u f (\_188 _189 _190 _191 _192-> (u (u fm_term_ori _orig_7) (u (u (u (u (u fm_term_all _188) _self_2) _190) _191) _192))); (4,f) -> u f (\_193 _194-> _term_6); (5,f) -> u f (\_195 _196-> _term_6); (6,f) -> u f (\_197 _198 _199-> _term_6); (7,f) -> u f (\_200 _201 _202-> _term_6); (8,f) -> u f (\_203 _204 _205-> _term_6); (9,f) -> u f (\_206 _207 _208-> _term_6); (10,f) -> u f (\_209-> _term_6); (11,f) -> u f (\_210-> _term_6); (12,f) -> u f (\_211-> _term_6); (13,f) -> u f (\_212-> _term_6); (14,f) -> u f (\_213 _214 _215 _216 _217 _218-> _term_6); (15,f) -> u f (\_219 _220-> _term_6); }))))))))))))))))
fm_term_lam = (\_name_1-> (\_body_2-> (4,\t-> t _name_1 _body_2)))
fm_parser_make_lambda = (\_names_1-> (\_body_2-> (let _221 = _names_1 in (case _221 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_222 _223-> (u (u fm_term_lam _222) (\_x_5-> (u (u fm_parser_make_lambda _223) _body_2)))); }))))
fm_parser_lambda = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "(")) (\__2-> (u (u (u monad_bind parser_monad) (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_name1))) (\_name_3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _expr_6=(u (u fm_parser_make_lambda _name_3) _body_4) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) _expr_6)))))))))))))
fm_parser_lambda_erased = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "<")) (\__2-> (u (u (u monad_bind parser_monad) (u (u parser_until1 (u fm_parser_text ">")) (u fm_parser_item fm_parser_name1))) (\_name_3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _expr_6=(u (u fm_parser_make_lambda _name_3) _body_4) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) _expr_6)))))))))))))
fm_parser_lambda_nameless = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "()")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_3-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_4-> (let _expr_5=(u (u fm_term_lam "") (\_x_5-> _body_3)) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_4) _expr_5)))))))))))
fm_parser_parenthesis = (u (u (u monad_bind parser_monad) (u fm_parser_text "(")) (\__1-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_term_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text ")")) (\__3-> (u (u monad_pure parser_monad) _term_2)))))))
fm_term_ref = (\_name_1-> (1,\t-> t _name_1))
fm_term_app = (\_func_1-> (\_argm_2-> (5,\t-> t _func_1 _argm_2)))
fm_term_hol = (\_path_1-> (10,\t-> t _path_1))
fm_term_let = (\_name_1-> (\_expr_2-> (\_body_3-> (6,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_letforin = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "let ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__4-> (u (u (u monad_bind parser_monad) (u fm_parser_text "for ")) (\__5-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_elem_6-> (u (u (u monad_bind parser_monad) (u fm_parser_text "in")) (\__7-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_list_8-> (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__9-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_loop_10-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__11-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_12-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_13-> (let _term_14=(u fm_term_ref "List.for") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _list_8) in (let _term_17=(u (u fm_term_app _term_16) (u fm_term_hol bits_e)) in (let _term_18=(u (u fm_term_app _term_17) (u fm_term_ref _name_3)) in (let _lamb_19=(u (u fm_term_lam _elem_6) (\_i_19-> (u (u fm_term_lam _name_3) (\_x_20-> _loop_10)))) in (let _term_20=(u (u fm_term_app _term_18) _lamb_19) in (let _term_21=(u (u (u fm_term_let _name_3) _term_20) (\_x_21-> _body_12)) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_13) _term_21))))))))))))))))))))))))))))))))))))
fm_parser_let = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "let ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_name) (\_name_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_5-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__6-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_7-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_8-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_8) (u (u (u fm_term_let _name_3) _expr_5) (\_x_9-> _body_7))))))))))))))))))))
fm_parser_get = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "let ")) (\__2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "{")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_name) (\_nam0_4-> (u (u (u monad_bind parser_monad) (u fm_parser_text ",")) (\__5-> (u (u (u monad_bind parser_monad) fm_parser_name) (\_nam1_6-> (u (u (u monad_bind parser_monad) (u fm_parser_text "}")) (\__7-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__8-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_9-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__10-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_11-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_12-> (let _term_13=_expr_9 in (let _term_14=(u (u fm_term_app _term_13) (u (u fm_term_lam "x") (\_x_14-> (u fm_term_hol bits_e)))) in (let _term_15=(u (u fm_term_app _term_14) (u (u fm_term_lam _nam0_4) (\_x_15-> (u (u fm_term_lam _nam1_6) (\_y_16-> _body_11))))) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_12) _term_15)))))))))))))))))))))))))))))
fm_term_def = (\_name_1-> (\_expr_2-> (\_body_3-> (7,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_def = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "def ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_name) (\_name_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_5-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__6-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_7-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_8-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_8) (u (u (u fm_term_def _name_3) _expr_5) (\_x_9-> _body_7))))))))))))))))))))
fm_parser_if = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "if ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_cond_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "then")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_tcse_5-> (u (u (u monad_bind parser_monad) (u fm_parser_text "else")) (\__6-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_fcse_7-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_8-> (let _term_9=_cond_3 in (let _term_10=(u (u fm_term_app _term_9) (u (u fm_term_lam "") (\_x_10-> (u fm_term_hol bits_e)))) in (let _term_11=(u (u fm_term_app _term_10) _tcse_5) in (let _term_12=(u (u fm_term_app _term_11) _fcse_7) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_8) _term_12))))))))))))))))))))))
list_mapped = (\_as_2-> (\_f_4-> (let _224 = _as_2 in (case _224 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_225 _226-> (u (u list_cons (u _f_4 _225)) (u (u list_mapped _226) _f_4))); }))))
pair_new = (\_fst_3-> (\_snd_4-> (0,\t-> t _fst_3 _snd_4)))
fm_backslash = 92
fm_escapes = (u (u list_cons (u (u pair_new "\\b") 8)) (u (u list_cons (u (u pair_new "\\f") 12)) (u (u list_cons (u (u pair_new "\\n") 10)) (u (u list_cons (u (u pair_new "\\r") 13)) (u (u list_cons (u (u pair_new "\\t") 9)) (u (u list_cons (u (u pair_new "\\v") 11)) (u (u list_cons (u (u pair_new (u (u string_cons fm_backslash) (u (u string_cons fm_backslash) string_nil))) fm_backslash)) (u (u list_cons (u (u pair_new "\\\"") 34)) (u (u list_cons (u (u pair_new "\\0") 0)) (u (u list_cons (u (u pair_new "\\'") 39)) list_nil))))))))))
fm_parser_char_single = (u parser_first_of (u (u list_cons (u parser_first_of (u (u list_mapped fm_escapes) (\_esc_1-> (let _227 = _esc_1 in (case _227 of {(0,f) -> u f (\_228 _229-> (u (u (u monad_bind parser_monad) (u parser_text _228)) (\__4-> (u (u monad_pure parser_monad) _229)))); })))))) (u (u list_cons parser_one) list_nil)))
fm_term_chr = (\_chrx_1-> (12,\t-> t _chrx_1))
fm_parser_char = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "'")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_char_single) (\_chrx_3-> (u (u (u monad_bind parser_monad) (u parser_text "'")) (\__4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) (u fm_term_chr _chrx_3)))))))))))))
fm_term_str = (\_strx_1-> (13,\t-> t _strx_1))
fm_parser_string = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (let _quot_2=(u (u string_cons 34) string_nil) in (u (u (u monad_bind parser_monad) (u fm_parser_text _quot_2)) (\__3-> (u (u (u monad_bind parser_monad) (u (u parser_until (u parser_text _quot_2)) fm_parser_char_single)) (\_chrs_4-> (let _strx_5=(u (u (u list_fold _chrs_4) string_nil) string_cons) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_6-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_6) (u fm_term_str _strx_5)))))))))))))
fm_parser_pair = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "{")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_val0_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text ",")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_val1_5-> (u (u (u monad_bind parser_monad) (u fm_parser_text "}")) (\__6-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_7-> (let _term_8=(u fm_term_ref "Pair.new") in (let _term_9=(u (u fm_term_app _term_8) (u fm_term_hol bits_e)) in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) _val0_3) in (let _term_12=(u (u fm_term_app _term_11) _val1_5) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_7) _term_12)))))))))))))))))))))
fm_parser_sigma_type = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "{")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_typ0_5-> (u (u (u monad_bind parser_monad) (u fm_parser_text "}")) (\__6-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_typ1_7-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_8-> (let _term_9=(u fm_term_ref "Sigma") in (let _term_10=(u (u fm_term_app _term_9) _typ0_5) in (let _term_11=(u (u fm_term_app _term_10) (u (u fm_term_lam "x") (\_x_11-> _typ1_7))) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_8) _term_11)))))))))))))))))))))
fm_parser_some = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "some(")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text ")")) (\__4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _term_6=(u fm_term_ref "Maybe.some") in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_hol bits_e)) in (let _term_8=(u (u fm_term_app _term_7) _expr_3) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) _term_8)))))))))))))))
fm_parser_apply = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "apply(")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_func_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text ",")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_equa_5-> (u (u (u monad_bind parser_monad) (u fm_parser_text ")")) (\__6-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_7-> (let _term_8=(u fm_term_ref "Equal.apply") in (let _term_9=(u (u fm_term_app _term_8) (u fm_term_hol bits_e)) in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_hol bits_e)) in (let _term_12=(u (u fm_term_app _term_11) (u fm_term_hol bits_e)) in (let _term_13=(u (u fm_term_app _term_12) _func_3) in (let _term_14=(u (u fm_term_app _term_13) _equa_5) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_7) _term_14)))))))))))))))))))))))
fm_name_read = (\_str_1-> _str_1)
fm_parser_list = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "[")) (\__2-> (u (u (u monad_bind parser_monad) (u (u parser_until (u fm_parser_text "]")) (u fm_parser_item fm_parser_term))) (\_vals_3-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_4-> (u (u monad_pure parser_monad) (u (u (u list_fold _vals_3) (u (u fm_term_app (u fm_term_ref (u fm_name_read "List.nil"))) (u fm_term_hol bits_e))) (\_x_5-> (\_xs_6-> (let _term_7=(u fm_term_ref (u fm_name_read "List.cons")) in (let _term_8=(u (u fm_term_app _term_7) (u fm_term_hol bits_e)) in (let _term_9=(u (u fm_term_app _term_8) _x_5) in (let _term_10=(u (u fm_term_app _term_9) _xs_6) in (u (u fm_term_ori _orig_4) _term_10)))))))))))))))))
fm_parser_log = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "log(")) (\__2-> (u (u (u monad_bind parser_monad) (u (u parser_until (u fm_parser_text ")")) (u fm_parser_item fm_parser_term))) (\_strs_3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_cont_4-> (let _term_5=(u fm_term_ref "Debug.log") in (let _term_6=(u (u fm_term_app _term_5) (u fm_term_hol bits_e)) in (let _args_7=(u (u (u list_fold _strs_3) (u fm_term_ref "String.nil")) (\_x_7-> (\_xs_8-> (let _arg_9=(u fm_term_ref "String.concat") in (let _arg_10=(u (u fm_term_app _arg_9) _x_7) in (let _arg_11=(u (u fm_term_app _arg_10) _xs_8) in _arg_11)))))) in (let _term_8=(u (u fm_term_app _term_6) _args_7) in (let _term_9=(u (u fm_term_app _term_8) (u (u fm_term_lam "x") (\_x_9-> _cont_4))) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_10-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_10) _term_9)))))))))))))))))
fm_parser_forin = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "for ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_elem_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "in")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_list_5-> (u (u (u monad_bind parser_monad) (u fm_parser_text "with")) (\__6-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_7-> (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__8-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_loop_9-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_10-> (let _term_11=(u fm_term_ref "List.for") in (let _term_12=(u (u fm_term_app _term_11) (u fm_term_hol bits_e)) in (let _term_13=(u (u fm_term_app _term_12) _list_5) in (let _term_14=(u (u fm_term_app _term_13) (u fm_term_hol bits_e)) in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_ref _name_7)) in (let _lamb_16=(u (u fm_term_lam _elem_3) (\_i_16-> (u (u fm_term_lam _name_7) (\_x_17-> _loop_9)))) in (let _term_17=(u (u fm_term_app _term_15) _lamb_16) in (let _term_18=(u (u (u fm_term_let _name_7) _term_17) (\_x_18-> (u fm_term_ref _name_7))) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_10) _term_18))))))))))))))))))))))))))))))
fm_parser_forin2 = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "for ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_elem_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "in")) (\__4-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_list_5-> (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__6-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_7-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__8-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_loop_9-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__10-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_11-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_12-> (let _term_13=(u fm_term_ref "List.for") in (let _term_14=(u (u fm_term_app _term_13) (u fm_term_hol bits_e)) in (let _term_15=(u (u fm_term_app _term_14) _list_5) in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _term_17=(u (u fm_term_app _term_16) (u fm_term_ref _name_7)) in (let _lamb_18=(u (u fm_term_lam _elem_3) (\_i_18-> (u (u fm_term_lam _name_7) (\_x_19-> _loop_9)))) in (let _term_19=(u (u fm_term_app _term_17) _lamb_18) in (let _term_20=(u (u (u fm_term_let _name_7) _term_19) (\_x_20-> _body_11)) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_12) _term_20))))))))))))))))))))))))))))))))))
fm_parser_do_statements = (\_monad_name_1-> (u parser_first_of (u (u list_cons (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "var ")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_4-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__5-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_6-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__7-> (u (u (u monad_bind parser_monad) (u fm_parser_do_statements _monad_name_1)) (\_body_8-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_2)) (\_orig_9-> (let _term_10=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_12=(u (u fm_term_app _term_11) (u fm_term_hol bits_e)) in (let _term_13=(u (u fm_term_app _term_12) (u fm_term_hol bits_e)) in (let _term_14=(u (u fm_term_app _term_13) _expr_6) in (let _term_15=(u (u fm_term_app _term_14) (u (u fm_term_lam _name_4) (\_x_15-> _body_8))) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_9) _term_15))))))))))))))))))))))))) (u (u list_cons (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "let ")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_4-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__5-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_6-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__7-> (u (u (u monad_bind parser_monad) (u fm_parser_do_statements _monad_name_1)) (\_body_8-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_2)) (\_orig_9-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_9) (u (u (u fm_term_let _name_4) _expr_6) (\_x_10-> _body_8))))))))))))))))))))) (u (u list_cons (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "return ")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_4-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__5-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_2)) (\_orig_6-> (let _term_7=(u (u fm_term_app (u fm_term_ref "Monad.pure")) (u fm_term_ref _monad_name_1)) in (let _term_8=(u (u fm_term_app _term_7) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_9=(u (u fm_term_app _term_8) (u fm_term_hol bits_e)) in (let _term_10=(u (u fm_term_app _term_9) _expr_4) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_6) _term_10))))))))))))))))) (u (u list_cons (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_3-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__4-> (u (u (u monad_bind parser_monad) (u fm_parser_do_statements _monad_name_1)) (\_body_5-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_2)) (\_orig_6-> (let _term_7=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_8=(u (u fm_term_app _term_7) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_9=(u (u fm_term_app _term_8) (u fm_term_hol bits_e)) in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) _expr_3) in (let _term_12=(u (u fm_term_app _term_11) (u (u fm_term_lam "") (\_x_12-> _body_5))) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_6) _term_12))))))))))))))))))) (u (u list_cons (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_2-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__3-> (u (u monad_pure parser_monad) _expr_2)))))) list_nil)))))))
fm_parser_do = (u (u (u monad_bind parser_monad) (u fm_parser_text "do ")) (\__1-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "{")) (\__3-> (u (u (u monad_bind parser_monad) (u fm_parser_do_statements _name_2)) (\_term_4-> (u (u (u monad_bind parser_monad) (u fm_parser_text "}")) (\__5-> (u (u monad_pure parser_monad) _term_4)))))))))))
fm_term_nat = (\_natx_1-> (11,\t-> t _natx_1))
fm_term_unroll_nat = (\_natx_1-> (let _230 = _natx_1 in (if _230==0 then (u fm_term_ref (u fm_name_read "Nat.zero")) else (let _func_3=(u fm_term_ref (u fm_name_read "Nat.succ")) in (let _argm_4=(u fm_term_nat (_230-1)) in (u (u fm_term_app _func_3) _argm_4))))))
u16_to_bits = (\_a_1-> (let _231 = _a_1 in (u word_to_bits (u16_to_word _231))))
fm_term_unroll_chr_bits = (\_bits_1-> (let _232 = _bits_1 in (case _232 of {(0,f) -> u f ((u fm_term_ref (u fm_name_read "Bits.e"))); (1,f) -> u f (\_233-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.o"))) (u fm_term_unroll_chr_bits _233))); (2,f) -> u f (\_234-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.i"))) (u fm_term_unroll_chr_bits _234))); })))
fm_term_unroll_chr = (\_chrx_1-> (let _bits_2=(u u16_to_bits _chrx_1) in (let _term_3=(u fm_term_ref (u fm_name_read "Word.from_bits")) in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_nat 16)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_unroll_chr_bits _bits_2)) in (let _term_6=(u (u fm_term_app (u fm_term_ref (u fm_name_read "U16.new"))) _term_5) in _term_6))))))
fm_term_unroll_str = (\_strx_1-> (let _235 = _strx_1 in (if null (_235::String) then (u fm_term_ref (u fm_name_read "String.nil")) else (let _char_4=(u fm_term_chr (fromIntegral (fromEnum (head _235 :: Char)) :: Word16)) in (let _term_5=(u fm_term_ref (u fm_name_read "String.cons")) in (let _term_6=(u (u fm_term_app _term_5) _char_4) in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_str (tail _235))) in _term_7)))))))
fm_term_reduce = (\_term_1-> (\_defs_2-> (let _236 = _term_1 in (case _236 of {(0,f) -> u f (\_237 _238-> _term_1); (1,f) -> u f (\_239-> (let _240 = (u (u fm_get _239) _defs_2) in (case _240 of {(0,f) -> u f ((u fm_term_ref _239)); (1,f) -> u f (\_241-> (let _242 = _241 in (case _242 of {(0,f) -> u f (\_243 _244 _245 _246 _247 _248-> (u (u fm_term_reduce _246) _defs_2)); }))); }))); (2,f) -> u f (_term_1); (3,f) -> u f (\_249 _250 _251 _252 _253-> _term_1); (4,f) -> u f (\_254 _255-> _term_1); (5,f) -> u f (\_256 _257-> (let _func_5=(u (u fm_term_reduce _256) _defs_2) in (let _258 = _func_5 in (case _258 of {(0,f) -> u f (\_259 _260-> _term_1); (1,f) -> u f (\_261-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_262 _263 _264 _265 _266-> _term_1); (4,f) -> u f (\_267 _268-> (u (u fm_term_reduce (u _268 _257)) _defs_2)); (5,f) -> u f (\_269 _270-> _term_1); (6,f) -> u f (\_271 _272 _273-> _term_1); (7,f) -> u f (\_274 _275 _276-> _term_1); (8,f) -> u f (\_277 _278 _279-> _term_1); (9,f) -> u f (\_280 _281 _282-> _term_1); (10,f) -> u f (\_283-> _term_1); (11,f) -> u f (\_284-> _term_1); (12,f) -> u f (\_285-> _term_1); (13,f) -> u f (\_286-> _term_1); (14,f) -> u f (\_287 _288 _289 _290 _291 _292-> _term_1); (15,f) -> u f (\_293 _294-> _term_1); })))); (6,f) -> u f (\_295 _296 _297-> (u (u fm_term_reduce (u _297 _296)) _defs_2)); (7,f) -> u f (\_298 _299 _300-> (u (u fm_term_reduce (u _300 _299)) _defs_2)); (8,f) -> u f (\_301 _302 _303-> (u (u fm_term_reduce _302) _defs_2)); (9,f) -> u f (\_304 _305 _306-> _term_1); (10,f) -> u f (\_307-> _term_1); (11,f) -> u f (\_308-> (u (u fm_term_reduce (u fm_term_unroll_nat _308)) _defs_2)); (12,f) -> u f (\_309-> (u (u fm_term_reduce (u fm_term_unroll_chr _309)) _defs_2)); (13,f) -> u f (\_310-> (u (u fm_term_reduce (u fm_term_unroll_str _310)) _defs_2)); (14,f) -> u f (\_311 _312 _313 _314 _315 _316-> _term_1); (15,f) -> u f (\_317 _318-> (u (u fm_term_reduce _318) _defs_2)); }))))
map_new = (0,\t-> t)
fm_def_new = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_stat_6-> (0,\t-> t _file_1 _code_2 _name_3 _term_4 _type_5 _stat_6)))))))
fm_status_init = (0,\t-> t)
fm_parser_case_with = (u (u (u monad_bind parser_monad) (u fm_parser_text "with")) (\__1-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_type_4-> (u (u (u monad_bind parser_monad) (u fm_parser_text "=")) (\__5-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_term_6-> (u (u monad_pure parser_monad) (u (u (u (u (u (u fm_def_new "") "") _name_2) _term_6) _type_4) fm_status_init))))))))))))))
fm_parser_case_case = (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_term_3-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ","))) (\__4-> (u (u monad_pure parser_monad) (u (u pair_new _name_1) _term_3))))))))))
map_tie = (\_val_2-> (\_lft_3-> (\_rgt_4-> (1,\t-> t _val_2 _lft_3 _rgt_4))))
map_set = (\_bits_2-> (\_val_3-> (\_map_4-> (let _319 = _bits_2 in (case _319 of {(0,f) -> u f ((let _320 = _map_4 in (case _320 of {(0,f) -> u f ((u (u (u map_tie (u maybe_some _val_3)) map_new) map_new)); (1,f) -> u f (\_321 _322 _323-> (u (u (u map_tie (u maybe_some _val_3)) _322) _323)); }))); (1,f) -> u f (\_324-> (let _325 = _map_4 in (case _325 of {(0,f) -> u f ((u (u (u map_tie maybe_none) (u (u (u map_set _324) _val_3) map_new)) map_new)); (1,f) -> u f (\_326 _327 _328-> (u (u (u map_tie _326) (u (u (u map_set _324) _val_3) _327)) _328)); }))); (2,f) -> u f (\_329-> (let _330 = _map_4 in (case _330 of {(0,f) -> u f ((u (u (u map_tie maybe_none) map_new) (u (u (u map_set _329) _val_3) map_new))); (1,f) -> u f (\_331 _332 _333-> (u (u (u map_tie _331) _332) (u (u (u map_set _329) _val_3) _333))); }))); })))))
map_from_list = (\_f_3-> (\_xs_4-> (let _334 = _xs_4 in (case _334 of {(0,f) -> u f (map_new); (1,f) -> u f (\_335 _336-> (let _337 = _335 in (case _337 of {(0,f) -> u f (\_338 _339-> (u (u (u map_set (u _f_3 _338)) _339) (u (u map_from_list _f_3) _336))); }))); }))))
fm_term_cse = (\_path_1-> (\_expr_2-> (\_name_3-> (\_with_4-> (\_cses_5-> (\_moti_6-> (14,\t-> t _path_1 _expr_2 _name_3 _with_4 _cses_5 _moti_6)))))))
fm_parser_case = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "case ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_4-> (u (u (u monad_bind parser_monad) (u parser_maybe (u (u (u monad_bind parser_monad) (u fm_parser_text "as")) (\__5-> fm_parser_name1)))) (\_name_5-> (let _name_6=(let _340 = _name_5 in (case _340 of {(0,f) -> u f ((let _341 = (u (u fm_term_reduce _expr_4) map_new) in (case _341 of {(0,f) -> u f (\_342 _343-> _342); (1,f) -> u f (\_344-> _344); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_345 _346 _347 _348 _349-> (u fm_name_read "self")); (4,f) -> u f (\_350 _351-> (u fm_name_read "self")); (5,f) -> u f (\_352 _353-> (u fm_name_read "self")); (6,f) -> u f (\_354 _355 _356-> (u fm_name_read "self")); (7,f) -> u f (\_357 _358 _359-> (u fm_name_read "self")); (8,f) -> u f (\_360 _361 _362-> (u fm_name_read "self")); (9,f) -> u f (\_363 _364 _365-> (u fm_name_read "self")); (10,f) -> u f (\_366-> (u fm_name_read "self")); (11,f) -> u f (\_367-> (u fm_name_read "self")); (12,f) -> u f (\_368-> (u fm_name_read "self")); (13,f) -> u f (\_369-> (u fm_name_read "self")); (14,f) -> u f (\_370 _371 _372 _373 _374 _375-> (u fm_name_read "self")); (15,f) -> u f (\_376 _377-> (u fm_name_read "self")); }))); (1,f) -> u f (\_378-> _378); })) in (u (u (u monad_bind parser_monad) (u parser_many fm_parser_case_with)) (\_wyth_7-> (u (u (u monad_bind parser_monad) (u fm_parser_text "{")) (\__8-> (u (u (u monad_bind parser_monad) (u (u parser_until (u fm_parser_text "}")) fm_parser_case_case)) (\_cses_9-> (let _cses_10=(u (u map_from_list fm_name_to_bits) _cses_9) in (u (u (u monad_bind parser_monad) (u parser_first_of (u (u list_cons (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__11-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_term_12-> (u (u monad_pure parser_monad) (u maybe_some _term_12))))))) (u (u list_cons (u (u (u monad_bind parser_monad) (u fm_parser_text "!")) (\__11-> (u (u monad_pure parser_monad) maybe_none)))) (u (u list_cons (u (u monad_pure parser_monad) (u maybe_some (u fm_term_hol bits_e)))) list_nil))))) (\_moti_11-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_12-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_12) (u (u (u (u (u (u fm_term_cse bits_e) _expr_4) _name_6) _wyth_7) _cses_10) _moti_11)))))))))))))))))))))))))
fm_parser_open = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "open ")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_expr_4-> (u (u (u monad_bind parser_monad) (u parser_maybe (u (u (u monad_bind parser_monad) (u fm_parser_text "as")) (\__5-> fm_parser_name1)))) (\_name_5-> (u (u (u monad_bind parser_monad) (u parser_maybe (u fm_parser_text ";"))) (\__6-> (let _name_7=(let _379 = _name_5 in (case _379 of {(0,f) -> u f ((let _380 = (u (u fm_term_reduce _expr_4) map_new) in (case _380 of {(0,f) -> u f (\_381 _382-> _381); (1,f) -> u f (\_383-> _383); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_384 _385 _386 _387 _388-> (u fm_name_read "self")); (4,f) -> u f (\_389 _390-> (u fm_name_read "self")); (5,f) -> u f (\_391 _392-> (u fm_name_read "self")); (6,f) -> u f (\_393 _394 _395-> (u fm_name_read "self")); (7,f) -> u f (\_396 _397 _398-> (u fm_name_read "self")); (8,f) -> u f (\_399 _400 _401-> (u fm_name_read "self")); (9,f) -> u f (\_402 _403 _404-> (u fm_name_read "self")); (10,f) -> u f (\_405-> (u fm_name_read "self")); (11,f) -> u f (\_406-> (u fm_name_read "self")); (12,f) -> u f (\_407-> (u fm_name_read "self")); (13,f) -> u f (\_408-> (u fm_name_read "self")); (14,f) -> u f (\_409 _410 _411 _412 _413 _414-> (u fm_name_read "self")); (15,f) -> u f (\_415 _416-> (u fm_name_read "self")); }))); (1,f) -> u f (\_417-> _417); })) in (let _wyth_8=list_nil in (u (u (u monad_bind parser_monad) fm_parser_term) (\_rest_9-> (let _cses_10=(u (u map_from_list fm_name_to_bits) (u (u list_cons (u (u pair_new "_") _rest_9)) list_nil)) in (let _moti_11=(u maybe_some (u fm_term_hol bits_e)) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_12-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_12) (u (u (u (u (u (u fm_term_cse bits_e) _expr_4) _name_7) _wyth_8) _cses_10) _moti_11)))))))))))))))))))))))
parser_digit = (\_idx_1-> (\_code_2-> (let _418 = _code_2 in (if null (_418::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit.") else (let _sidx_5=(u nat_succ _idx_1) in (let _419 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 48)) in (if _419 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 0) else (let _420 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 49)) in (if _420 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 1) else (let _421 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 50)) in (if _421 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 2) else (let _422 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 51)) in (if _422 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 3) else (let _423 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 52)) in (if _423 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 4) else (let _424 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 53)) in (if _424 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 5) else (let _425 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 54)) in (if _425 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 6) else (let _426 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 55)) in (if _426 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 7) else (let _427 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 56)) in (if _427 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 8) else (let _428 = ((((fromIntegral (fromEnum (head _418 :: Char)) :: Word16)::Word16) == 57)) in (if _428 then (u (u (u parser_reply_value _sidx_5) (tail _418)) 9) else (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit."))))))))))))))))))))))))))
nat_add = (\a0-> \a1-> ((a0::Integer) + a1))
nat_mul = (\a0-> \a1-> ((a0::Integer) * a1))
nat_from_base_go = (\_b_1-> (\_ds_2-> (\_p_3-> (\_res_4-> (let _429 = _ds_2 in (case _429 of {(0,f) -> u f (_res_4); (1,f) -> u f (\_430 _431-> (u (u (u (u nat_from_base_go _b_1) _431) (((_b_1::Integer) * _p_3))) ((((((_430::Integer) * _p_3))::Integer) + _res_4)))); }))))))
list_reverse_go = (\_xs_2-> (\_res_3-> (let _432 = _xs_2 in (case _432 of {(0,f) -> u f (_res_3); (1,f) -> u f (\_433 _434-> (u (u list_reverse_go _434) (u (u list_cons _433) _res_3))); }))))
list_reverse = (\_xs_2-> (u (u list_reverse_go _xs_2) list_nil))
nat_from_base = (\_base_1-> (\_ds_2-> (u (u (u (u nat_from_base_go _base_1) (u list_reverse _ds_2)) 1) 0)))
parser_nat = (u (u (u monad_bind parser_monad) (u parser_many1 parser_digit)) (\_digits_1-> (u (u monad_pure parser_monad) (u (u nat_from_base 10) _digits_1))))
bits_tail = (\_a_1-> (let _435 = _a_1 in (case _435 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_436-> _436); (2,f) -> u f (\_437-> _437); })))
bits_inc = (\_a_1-> (let _438 = _a_1 in (case _438 of {(0,f) -> u f ((u bits_i bits_e)); (1,f) -> u f (\_439-> (u bits_i _439)); (2,f) -> u f (\_440-> (u bits_o (u bits_inc _440))); })))
nat_to_bits = (\_n_1-> (let _441 = _n_1 in (if _441==0 then bits_e else (u bits_inc (u nat_to_bits (_441-1))))))
maybe_to_bool = (\_m_2-> (let _442 = _m_2 in (case _442 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_443-> bool_true); })))
fm_term_gol = (\_name_1-> (\_dref_2-> (\_verb_3-> (9,\t-> t _name_1 _dref_2 _verb_3))))
fm_parser_goal = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "?")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_name) (\_name_3-> (u (u (u monad_bind parser_monad) (u parser_many (u (u (u monad_bind parser_monad) (u fm_parser_text "-")) (\__4-> (u (u (u monad_bind parser_monad) parser_nat) (\_nat_5-> (let _bits_6=(u bits_reverse (u bits_tail (u bits_reverse (u nat_to_bits _nat_5)))) in (u (u monad_pure parser_monad) _bits_6)))))))) (\_dref_4-> (u (u (u monad_bind parser_monad) (u (u (u monad_bind parser_monad) (u parser_maybe (u parser_text "-"))) (\_verb_5-> (u (u monad_pure parser_monad) (u maybe_to_bool _verb_5))))) (\_verb_5-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_6-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_6) (u (u (u fm_term_gol _name_3) _dref_4) _verb_5)))))))))))))))
fm_parser_hole = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text "_")) (\__2-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_3-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_3) (u fm_term_hol bits_e)))))))))
fm_parser_u8 = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__2-> (u (u (u monad_bind parser_monad) parser_nat) (\_natx_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "b")) (\__4-> (let _term_5=(u fm_term_ref "Nat.to_u8") in (let _term_6=(u (u fm_term_app _term_5) (u fm_term_nat _natx_3)) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_7-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_7) _term_6))))))))))))))
fm_parser_u16 = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__2-> (u (u (u monad_bind parser_monad) parser_nat) (\_natx_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "s")) (\__4-> (let _term_5=(u fm_term_ref "Nat.to_u16") in (let _term_6=(u (u fm_term_app _term_5) (u fm_term_nat _natx_3)) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_7-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_7) _term_6))))))))))))))
fm_parser_u32 = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__2-> (u (u (u monad_bind parser_monad) parser_nat) (\_natx_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "u")) (\__4-> (let _term_5=(u fm_term_ref "Nat.to_u32") in (let _term_6=(u (u fm_term_app _term_5) (u fm_term_nat _natx_3)) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_7-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_7) _term_6))))))))))))))
fm_parser_u64 = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__2-> (u (u (u monad_bind parser_monad) parser_nat) (\_natx_3-> (u (u (u monad_bind parser_monad) (u fm_parser_text "l")) (\__4-> (let _term_5=(u fm_term_ref "Nat.to_u64") in (let _term_6=(u (u fm_term_app _term_5) (u fm_term_nat _natx_3)) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_7-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_7) _term_6))))))))))))))
fm_parser_nat = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__2-> (u (u (u monad_bind parser_monad) parser_nat) (\_natx_3-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_4-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_4) (u fm_term_nat _natx_3)))))))))))
string_eql = (\a0-> \a1-> ((a0::String) == a1))
parser_fail = (\_error_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_error _idx_3) _code_4) _error_2))))
fm_parser_reference = (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_1-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_2-> (let _444 = (((_name_2::String) == "case")) in (if _444 then (u parser_fail "Reserved keyword.") else (let _445 = (((_name_2::String) == "do")) in (if _445 then (u parser_fail "Reserved keyword.") else (let _446 = (((_name_2::String) == "if")) in (if _446 then (u parser_fail "Reserved keyword.") else (let _447 = (((_name_2::String) == "let")) in (if _447 then (u parser_fail "Reserved keyword.") else (let _448 = (((_name_2::String) == "def")) in (if _448 then (u parser_fail "Reserved keyword.") else (let _449 = (((_name_2::String) == "true")) in (if _449 then (u (u monad_pure parser_monad) (u fm_term_ref "Bool.true")) else (let _450 = (((_name_2::String) == "false")) in (if _450 then (u (u monad_pure parser_monad) (u fm_term_ref "Bool.false")) else (let _451 = (((_name_2::String) == "unit")) in (if _451 then (u (u monad_pure parser_monad) (u fm_term_ref "Unit.new")) else (let _452 = (((_name_2::String) == "none")) in (if _452 then (let _term_3=(u fm_term_ref "Maybe.none") in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_hol bits_e)) in (u (u monad_pure parser_monad) _term_4))) else (let _453 = (((_name_2::String) == "refl")) in (if _453 then (let _term_3=(u fm_term_ref "Equal.refl") in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_hol bits_e)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_hol bits_e)) in (u (u monad_pure parser_monad) _term_5)))) else (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_3-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_3) (u fm_term_ref _name_2)))))))))))))))))))))))))))))
list_for = (\_xs_2-> (\_b_4-> (\_f_5-> (let _454 = _xs_2 in (case _454 of {(0,f) -> u f (_b_4); (1,f) -> u f (\_455 _456-> (u (u (u list_for _456) (u (u _f_5 _455) _b_4)) _f_5)); })))))
fm_parser_application = (\_init_1-> (\_func_2-> (u (u (u monad_bind parser_monad) (u parser_text "(")) (\__3-> (u (u (u monad_bind parser_monad) (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_term))) (\_args_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _expr_6=(u (u (u list_for _args_4) _func_2) (\_x_6-> (\_f_7-> (u (u fm_term_app _f_7) _x_6)))) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) _expr_6)))))))))))
parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) list_nil))))
parser_spaces_text = (\_text_1-> (u (u (u monad_bind parser_monad) parser_spaces) (\__2-> (u parser_text _text_1))))
fm_parser_application_erased = (\_init_1-> (\_func_2-> (u (u (u monad_bind parser_monad) parser_get_index) (\_init_3-> (u (u (u monad_bind parser_monad) (u parser_text "<")) (\__4-> (u (u (u monad_bind parser_monad) (u (u parser_until1 (u parser_spaces_text ">")) (u fm_parser_item fm_parser_term))) (\_args_5-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_3)) (\_orig_6-> (let _expr_7=(u (u (u list_for _args_5) _func_2) (\_x_7-> (\_f_8-> (u (u fm_term_app _f_8) _x_7)))) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_6) _expr_7)))))))))))))
fm_parser_arrow = (\_init_1-> (\_xtyp_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "->")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_body_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) (u (u (u (u (u fm_term_all bool_false) "") "") _xtyp_2) (\_s_6-> (\_x_7-> _body_4)))))))))))))
fm_parser_op = (\_sym_1-> (\_ref_2-> (\_init_3-> (\_val0_4-> (u (u (u monad_bind parser_monad) (u fm_parser_text _sym_1)) (\__5-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_val1_6-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_3)) (\_orig_7-> (let _term_8=(u fm_term_ref _ref_2) in (let _term_9=(u (u fm_term_app _term_8) _val0_4) in (let _term_10=(u (u fm_term_app _term_9) _val1_6) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_7) _term_10)))))))))))))))
fm_parser_add = (u (u fm_parser_op "+") "Nat.add")
fm_parser_sub = (u (u fm_parser_op "+") "Nat.add")
fm_parser_mul = (u (u fm_parser_op "*") "Nat.mul")
fm_parser_div = (u (u fm_parser_op "/") "Nat.div")
fm_parser_mod = (u (u fm_parser_op "%") "Nat.mod")
fm_parser_cons = (\_init_1-> (\_head_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "&")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_tail_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _term_6=(u fm_term_ref "List.cons") in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_hol bits_e)) in (let _term_8=(u (u fm_term_app _term_7) _head_2) in (let _term_9=(u (u fm_term_app _term_8) _tail_4) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_10-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_10) _term_9))))))))))))))))
fm_parser_concat = (\_init_1-> (\_lst0_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "++")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_lst1_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _term_6=(u fm_term_ref "List.concat") in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_hol bits_e)) in (let _term_8=(u (u fm_term_app _term_7) _lst0_2) in (let _term_9=(u (u fm_term_app _term_8) _lst1_4) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_10-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_10) _term_9))))))))))))))))
fm_parser_string_concat = (\_init_1-> (\_str0_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "|")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_str1_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _term_6=(u fm_term_ref "String.concat") in (let _term_7=(u (u fm_term_app _term_6) _str0_2) in (let _term_8=(u (u fm_term_app _term_7) _str1_4) in (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_9-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_9) _term_8)))))))))))))))
fm_parser_sigma = (\_init_1-> (\_val0_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "~")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_val1_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _term_6=(u fm_term_ref "Sigma.new") in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_hol bits_e)) in (let _term_8=(u (u fm_term_app _term_7) (u fm_term_hol bits_e)) in (let _term_9=(u (u fm_term_app _term_8) _val0_2) in (let _term_10=(u (u fm_term_app _term_9) _val1_4) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) _term_10)))))))))))))))
fm_parser_equality = (\_init_1-> (\_val0_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "==")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_val1_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (let _term_6=(u fm_term_ref "Equal") in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_hol bits_e)) in (let _term_8=(u (u fm_term_app _term_7) _val0_2) in (let _term_9=(u (u fm_term_app _term_8) _val1_4) in (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) _term_9))))))))))))))
fm_term_ann = (\_done_1-> (\_term_2-> (\_type_3-> (8,\t-> t _done_1 _term_2 _type_3))))
fm_parser_annotation = (\_init_1-> (\_term_2-> (u (u (u monad_bind parser_monad) (u fm_parser_text "::")) (\__3-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_type_4-> (u (u (u monad_bind parser_monad) (u fm_parser_stop _init_1)) (\_orig_5-> (u (u monad_pure parser_monad) (u (u fm_term_ori _orig_5) (u (u (u fm_term_ann bool_false) _term_2) _type_4)))))))))))
fm_parser_suffix = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _suffix_parser_5=(u parser_first_of (u (u list_cons (u (u fm_parser_application _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_erased _init_1) _term_2)) (u (u list_cons (u (u fm_parser_arrow _init_1) _term_2)) (u (u list_cons (u (u fm_parser_add _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sub _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mul _init_1) _term_2)) (u (u list_cons (u (u fm_parser_div _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mod _init_1) _term_2)) (u (u list_cons (u (u fm_parser_cons _init_1) _term_2)) (u (u list_cons (u (u fm_parser_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_string_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sigma _init_1) _term_2)) (u (u list_cons (u (u fm_parser_equality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_annotation _init_1) _term_2)) list_nil))))))))))))))) in (let _457 = (u (u _suffix_parser_5 _idx_3) _code_4) in (case _457 of {(0,f) -> u f (\_458 _459 _460-> (u (u (u parser_reply_value _idx_3) _code_4) _term_2)); (1,f) -> u f (\_461 _462 _463-> (u (u (u (u fm_parser_suffix _init_1) _463) _461) _462)); })))))))
fm_parser_term = (u (u (u monad_bind parser_monad) parser_get_code) (\_code_1-> (u (u (u monad_bind parser_monad) fm_parser_init) (\_init_2-> (u (u (u monad_bind parser_monad) (u parser_first_of (u (u list_cons fm_parser_type) (u (u list_cons fm_parser_forall) (u (u list_cons fm_parser_lambda) (u (u list_cons fm_parser_lambda_erased) (u (u list_cons fm_parser_lambda_nameless) (u (u list_cons fm_parser_parenthesis) (u (u list_cons fm_parser_letforin) (u (u list_cons fm_parser_let) (u (u list_cons fm_parser_get) (u (u list_cons fm_parser_def) (u (u list_cons fm_parser_if) (u (u list_cons fm_parser_char) (u (u list_cons fm_parser_string) (u (u list_cons fm_parser_pair) (u (u list_cons fm_parser_sigma_type) (u (u list_cons fm_parser_some) (u (u list_cons fm_parser_apply) (u (u list_cons fm_parser_list) (u (u list_cons fm_parser_log) (u (u list_cons fm_parser_forin) (u (u list_cons fm_parser_forin2) (u (u list_cons fm_parser_do) (u (u list_cons fm_parser_case) (u (u list_cons fm_parser_open) (u (u list_cons fm_parser_goal) (u (u list_cons fm_parser_hole) (u (u list_cons fm_parser_u8) (u (u list_cons fm_parser_u16) (u (u list_cons fm_parser_u32) (u (u list_cons fm_parser_u64) (u (u list_cons fm_parser_nat) (u (u list_cons fm_parser_reference) list_nil)))))))))))))))))))))))))))))))))) (\_term_3-> (u (u fm_parser_suffix _init_2) _term_3)))))))
fm_parser_name_term = (u (u (u monad_bind parser_monad) fm_parser_name) (\_name_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__2-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_type_3-> (u (u monad_pure parser_monad) (u (u pair_new _name_1) _type_3))))))))
fm_binder_new = (\_eras_1-> (\_name_2-> (\_term_3-> (0,\t-> t _eras_1 _name_2 _term_3))))
fm_parser_binder_homo = (\_eras_1-> (u (u (u monad_bind parser_monad) (u fm_parser_text (let _464 = _eras_1 in (if _464 then "<" else "(")))) (\__2-> (u (u (u monad_bind parser_monad) (u (u parser_until1 (u fm_parser_text (let _465 = _eras_1 in (if _465 then ">" else ")")))) (u fm_parser_item fm_parser_name_term))) (\_bind_3-> (u (u monad_pure parser_monad) (u (u list_mapped _bind_3) (\_pair_4-> (let _466 = _pair_4 in (case _466 of {(0,f) -> u f (\_467 _468-> (u (u (u fm_binder_new _eras_1) _467) _468)); }))))))))))
list_concat = (\_as_2-> (\_bs_3-> (let _469 = _as_2 in (case _469 of {(0,f) -> u f (_bs_3); (1,f) -> u f (\_470 _471-> (u (u list_cons _470) (u (u list_concat _471) _bs_3))); }))))
list_flatten = (\_xs_2-> (let _472 = _xs_2 in (case _472 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_473 _474-> (u (u list_concat _473) (u list_flatten _474))); })))
fm_parser_binder = (u (u (u monad_bind parser_monad) (u parser_many1 (u parser_first_of (u (u list_cons (u fm_parser_binder_homo bool_true)) (u (u list_cons (u fm_parser_binder_homo bool_false)) list_nil))))) (\_lists_1-> (u (u monad_pure parser_monad) (u list_flatten _lists_1))))
fm_parser_make_forall = (\_binds_1-> (\_body_2-> (let _475 = _binds_1 in (case _475 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_476 _477-> (let _478 = _476 in (case _478 of {(0,f) -> u f (\_479 _480 _481-> (u (u (u (u (u fm_term_all _479) "") _480) _481) (\_s_8-> (\_x_9-> (u (u fm_parser_make_forall _477) _body_2))))); }))); }))))
list_at = (\_index_2-> (\_list_3-> (let _482 = _list_3 in (case _482 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_483 _484-> (let _485 = _index_2 in (if _485==0 then (u maybe_some _483) else (u (u list_at (_485-1)) _484)))); }))))
list_at_last = (\_index_2-> (\_list_3-> (u (u list_at _index_2) (u list_reverse _list_3))))
fm_term_var = (\_name_1-> (\_indx_2-> (0,\t-> t _name_1 _indx_2)))
pair_snd = (\_pair_3-> (let _486 = _pair_3 in (case _486 of {(0,f) -> u f (\_487 _488-> _488); })))
fm_name_eql = (\_a_1-> (\_b_2-> (((_a_1::String) == _b_2))))
fm_context_find = (\_name_1-> (\_ctx_2-> (let _489 = _ctx_2 in (case _489 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_490 _491-> (let _492 = _490 in (case _492 of {(0,f) -> u f (\_493 _494-> (let _495 = (u (u fm_name_eql _name_1) _493) in (if _495 then (u maybe_some _494) else (u (u fm_context_find _name_1) _491)))); }))); }))))
list_length = (\_xs_2-> (let _496 = _xs_2 in (case _496 of {(0,f) -> u f (0); (1,f) -> u f (\_497 _498-> (u nat_succ (u list_length _498))); })))
fm_path_o = (\_path_1-> (\_x_2-> (u _path_1 (u bits_o _x_2))))
fm_path_i = (\_path_1-> (\_x_2-> (u _path_1 (u bits_i _x_2))))
fm_path_to_bits = (\_path_1-> (u _path_1 bits_e))
fm_term_bind = (\_vars_1-> (\_path_2-> (\_term_3-> (let _499 = _term_3 in (case _499 of {(0,f) -> u f (\_500 _501-> (let _502 = (u (u list_at_last _501) _vars_1) in (case _502 of {(0,f) -> u f ((u (u fm_term_var _500) _501)); (1,f) -> u f (\_503-> (u pair_snd _503)); }))); (1,f) -> u f (\_504-> (let _505 = (u (u fm_context_find _504) _vars_1) in (case _505 of {(0,f) -> u f ((u fm_term_ref _504)); (1,f) -> u f (\_506-> _506); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_507 _508 _509 _510 _511-> (let _vlen_9=(u list_length _vars_1) in (u (u (u (u (u fm_term_all _507) _508) _509) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _510)) (\_s_10-> (\_x_11-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _509) _x_11)) (u (u list_cons (u (u pair_new _508) _s_10)) _vars_1))) (u fm_path_i _path_2)) (u (u _511 (u (u fm_term_var _508) _vlen_9)) (u (u fm_term_var _509) (u nat_succ _vlen_9))))))))); (4,f) -> u f (\_512 _513-> (let _vlen_6=(u list_length _vars_1) in (u (u fm_term_lam _512) (\_x_7-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _512) _x_7)) _vars_1)) (u fm_path_o _path_2)) (u _513 (u (u fm_term_var _512) _vlen_6))))))); (5,f) -> u f (\_514 _515-> (u (u fm_term_app (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _514)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _515))); (6,f) -> u f (\_516 _517 _518-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_let _516) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _517)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _516) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _518 (u (u fm_term_var _516) _vlen_7))))))); (7,f) -> u f (\_519 _520 _521-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_def _519) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _520)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _519) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _521 (u (u fm_term_var _519) _vlen_7))))))); (8,f) -> u f (\_522 _523 _524-> (u (u (u fm_term_ann _522) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _523)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _524))); (9,f) -> u f (\_525 _526 _527-> (u (u (u fm_term_gol _525) _526) _527)); (10,f) -> u f (\_528-> (u fm_term_hol (u fm_path_to_bits _path_2))); (11,f) -> u f (\_529-> (u fm_term_nat _529)); (12,f) -> u f (\_530-> (u fm_term_chr _530)); (13,f) -> u f (\_531-> (u fm_term_str _531)); (14,f) -> u f (\_532 _533 _534 _535 _536 _537-> (let _expr_10=(u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _533) in (let _name_11=_534 in (let _wyth_12=_535 in (let _cses_13=_536 in (let _moti_14=_537 in (u (u (u (u (u (u fm_term_cse (u fm_path_to_bits _path_2)) _expr_10) _name_11) _wyth_12) _cses_13) _moti_14))))))); (15,f) -> u f (\_538 _539-> (u (u fm_term_ori _538) (u (u (u fm_term_bind _vars_1) _path_2) _539))); })))))
fm_status_done = (2,\t-> t)
fm_set = (\_name_2-> (\_val_3-> (\_map_4-> (u (u (u map_set (u fm_name_to_bits _name_2)) _val_3) _map_4))))
fm_define = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_done_6-> (\_defs_7-> (let _stat_8=(let _540 = _done_6 in (if _540 then fm_status_done else fm_status_init)) in (u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_4) _type_5) _stat_8)) _defs_7)))))))))
fm_parser_file_def = (\_file_1-> (\_code_2-> (\_defs_3-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_4-> (u (u (u monad_bind parser_monad) (u parser_many fm_parser_binder)) (\_args_5-> (let _args_6=(u list_flatten _args_5) in (u (u (u monad_bind parser_monad) (u fm_parser_text ":")) (\__7-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_type_8-> (u (u (u monad_bind parser_monad) fm_parser_term) (\_term_9-> (let _type_10=(u (u fm_parser_make_forall _args_6) _type_8) in (let _term_11=(u (u fm_parser_make_lambda (u (u list_mapped _args_6) (\_x_11-> (let _541 = _x_11 in (case _541 of {(0,f) -> u f (\_542 _543 _544-> _543); }))))) _term_9) in (let _type_12=(u (u (u fm_term_bind list_nil) (\_x_12-> (u bits_i _x_12))) _type_10) in (let _term_13=(u (u (u fm_term_bind list_nil) (\_x_13-> (u bits_o _x_13))) _term_11) in (let _defs_14=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _name_4) _term_13) _type_12) bool_false) _defs_3) in (u (u monad_pure parser_monad) _defs_14))))))))))))))))))))
maybe_default = (\_a_2-> (\_m_3-> (let _545 = _m_3 in (case _545 of {(0,f) -> u f (_a_2); (1,f) -> u f (\_546-> _546); }))))
fm_constructor_new = (\_name_1-> (\_args_2-> (\_inds_3-> (0,\t-> t _name_1 _args_2 _inds_3))))
fm_parser_constructor = (\_namespace_1-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_2-> (u (u (u monad_bind parser_monad) (u parser_maybe fm_parser_binder)) (\_args_3-> (u (u (u monad_bind parser_monad) (u parser_maybe (u (u (u monad_bind parser_monad) (u fm_parser_text "~")) (\__4-> fm_parser_binder)))) (\_inds_4-> (let _args_5=(u (u maybe_default list_nil) _args_3) in (let _inds_6=(u (u maybe_default list_nil) _inds_4) in (u (u monad_pure parser_monad) (u (u (u fm_constructor_new _name_2) _args_5) _inds_6)))))))))))
fm_datatype_new = (\_name_1-> (\_pars_2-> (\_inds_3-> (\_ctrs_4-> (0,\t-> t _name_1 _pars_2 _inds_3 _ctrs_4)))))
fm_parser_datatype = (u (u (u monad_bind parser_monad) (u fm_parser_text "type ")) (\__1-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_name_2-> (u (u (u monad_bind parser_monad) (u parser_maybe fm_parser_binder)) (\_pars_3-> (u (u (u monad_bind parser_monad) (u parser_maybe (u (u (u monad_bind parser_monad) (u fm_parser_text "~")) (\__4-> fm_parser_binder)))) (\_inds_4-> (let _pars_5=(u (u maybe_default list_nil) _pars_3) in (let _inds_6=(u (u maybe_default list_nil) _inds_4) in (u (u (u monad_bind parser_monad) (u fm_parser_text "{")) (\__7-> (u (u (u monad_bind parser_monad) (u (u parser_until (u fm_parser_text "}")) (u fm_parser_item (u fm_parser_constructor _name_2)))) (\_ctrs_8-> (u (u monad_pure parser_monad) (u (u (u (u fm_datatype_new _name_2) _pars_5) _inds_6) _ctrs_8))))))))))))))))
fm_datatype_build_term_motive_go = (\_type_1-> (\_name_2-> (\_inds_3-> (let _547 = _inds_3 in (case _547 of {(0,f) -> u f ((let _548 = _type_1 in (case _548 of {(0,f) -> u f (\_549 _550 _551 _552-> (let _slf_8=(u fm_term_ref _name_2) in (let _slf_9=(u (u (u list_for _550) _slf_8) (\_var_9-> (\_slf_10-> (u (u fm_term_app _slf_10) (u fm_term_ref (let _553 = _var_9 in (case _553 of {(0,f) -> u f (\_554 _555 _556-> _555); }))))))) in (let _slf_10=(u (u (u list_for _551) _slf_9) (\_var_10-> (\_slf_11-> (u (u fm_term_app _slf_11) (u fm_term_ref (let _557 = _var_10 in (case _557 of {(0,f) -> u f (\_558 _559 _560-> _559); }))))))) in (u (u (u (u (u fm_term_all bool_false) "") "") _slf_10) (\_s_11-> (\_x_12-> fm_term_typ))))))); }))); (1,f) -> u f (\_561 _562-> (let _563 = _561 in (case _563 of {(0,f) -> u f (\_564 _565 _566-> (u (u (u (u (u fm_term_all _564) "") _565) _566) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_motive_go _type_1) _name_2) _562))))); }))); })))))
fm_datatype_build_term_motive = (\_type_1-> (let _567 = _type_1 in (case _567 of {(0,f) -> u f (\_568 _569 _570 _571-> (u (u (u fm_datatype_build_term_motive_go _type_1) _568) _570)); })))
fm_datatype_build_term_constructor_go = (\_type_1-> (\_ctor_2-> (\_args_3-> (let _572 = _args_3 in (case _572 of {(0,f) -> u f ((let _573 = _type_1 in (case _573 of {(0,f) -> u f (\_574 _575 _576 _577-> (let _578 = _ctor_2 in (case _578 of {(0,f) -> u f (\_579 _580 _581-> (let _ret_11=(u fm_term_ref (u fm_name_read "P")) in (let _ret_12=(u (u (u list_for _581) _ret_11) (\_var_12-> (\_ret_13-> (u (u fm_term_app _ret_13) (let _582 = _var_12 in (case _582 of {(0,f) -> u f (\_583 _584 _585-> _585); })))))) in (let _ctr_13=(u string_flatten (u (u list_cons _574) (u (u list_cons (u fm_name_read ".")) (u (u list_cons _579) list_nil)))) in (let _slf_14=(u fm_term_ref _ctr_13) in (let _slf_15=(u (u (u list_for _575) _slf_14) (\_var_15-> (\_slf_16-> (u (u fm_term_app _slf_16) (u fm_term_ref (let _586 = _var_15 in (case _586 of {(0,f) -> u f (\_587 _588 _589-> _588); }))))))) in (let _slf_16=(u (u (u list_for _580) _slf_15) (\_var_16-> (\_slf_17-> (u (u fm_term_app _slf_17) (u fm_term_ref (let _590 = _var_16 in (case _590 of {(0,f) -> u f (\_591 _592 _593-> _592); }))))))) in (u (u fm_term_app _ret_12) _slf_16)))))))); }))); }))); (1,f) -> u f (\_594 _595-> (let _596 = _594 in (case _596 of {(0,f) -> u f (\_597 _598 _599-> (let _eras_9=_597 in (let _name_10=_598 in (let _xtyp_11=_599 in (let _body_12=(u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _595) in (u (u (u (u (u fm_term_all _eras_9) "") _name_10) _xtyp_11) (\_s_13-> (\_x_14-> _body_12)))))))); }))); })))))
fm_datatype_build_term_constructor = (\_type_1-> (\_ctor_2-> (let _600 = _ctor_2 in (case _600 of {(0,f) -> u f (\_601 _602 _603-> (u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _602)); }))))
fm_datatype_build_term_constructors_go = (\_type_1-> (\_name_2-> (\_ctrs_3-> (let _604 = _ctrs_3 in (case _604 of {(0,f) -> u f ((let _605 = _type_1 in (case _605 of {(0,f) -> u f (\_606 _607 _608 _609-> (let _ret_8=(u fm_term_ref (u fm_name_read "P")) in (let _ret_9=(u (u (u list_for _608) _ret_8) (\_var_9-> (\_ret_10-> (u (u fm_term_app _ret_10) (u fm_term_ref (let _610 = _var_9 in (case _610 of {(0,f) -> u f (\_611 _612 _613-> _612); }))))))) in (u (u fm_term_app _ret_9) (u fm_term_ref (((_name_2::String) ++ ".Self"))))))); }))); (1,f) -> u f (\_614 _615-> (let _616 = _614 in (case _616 of {(0,f) -> u f (\_617 _618 _619-> (u (u (u (u (u fm_term_all bool_false) "") _617) (u (u fm_datatype_build_term_constructor _type_1) _614)) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _name_2) _615))))); }))); })))))
fm_datatype_build_term_constructors = (\_type_1-> (let _620 = _type_1 in (case _620 of {(0,f) -> u f (\_621 _622 _623 _624-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _621) _624)); })))
fm_datatype_build_term_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _625 = _pars_3 in (case _625 of {(0,f) -> u f ((let _626 = _inds_4 in (case _626 of {(0,f) -> u f ((u (u (u (u (u fm_term_all bool_true) (((_name_2::String) ++ ".Self"))) (u fm_name_read "P")) (u fm_datatype_build_term_motive _type_1)) (\_s_5-> (\_x_6-> (u fm_datatype_build_term_constructors _type_1))))); (1,f) -> u f (\_627 _628-> (let _629 = _627 in (case _629 of {(0,f) -> u f (\_630 _631 _632-> (u (u fm_term_lam _631) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _pars_3) _628)))); }))); }))); (1,f) -> u f (\_633 _634-> (let _635 = _633 in (case _635 of {(0,f) -> u f (\_636 _637 _638-> (u (u fm_term_lam _637) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _634) _inds_4)))); }))); }))))))
fm_datatype_build_term = (\_type_1-> (let _639 = _type_1 in (case _639 of {(0,f) -> u f (\_640 _641 _642 _643-> (u (u (u (u fm_datatype_build_term_go _type_1) _640) _641) _642)); })))
fm_datatype_build_type_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _644 = _pars_3 in (case _644 of {(0,f) -> u f ((let _645 = _inds_4 in (case _645 of {(0,f) -> u f (fm_term_typ); (1,f) -> u f (\_646 _647-> (let _648 = _646 in (case _648 of {(0,f) -> u f (\_649 _650 _651-> (u (u (u (u (u fm_term_all bool_false) "") _650) _651) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _pars_3) _647))))); }))); }))); (1,f) -> u f (\_652 _653-> (let _654 = _652 in (case _654 of {(0,f) -> u f (\_655 _656 _657-> (u (u (u (u (u fm_term_all bool_false) "") _656) _657) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _653) _inds_4))))); }))); }))))))
fm_datatype_build_type = (\_type_1-> (let _658 = _type_1 in (case _658 of {(0,f) -> u f (\_659 _660 _661 _662-> (u (u (u (u fm_datatype_build_type_go _type_1) _659) _660) _661)); })))
fm_constructor_build_term_opt_go = (\_type_1-> (\_ctor_2-> (\_ctrs_3-> (let _663 = _ctrs_3 in (case _663 of {(0,f) -> u f ((let _664 = _ctor_2 in (case _664 of {(0,f) -> u f (\_665 _666 _667-> (let _ret_7=(u fm_term_ref _665) in (let _ret_8=(u (u (u list_for _666) _ret_7) (\_arg_8-> (\_ret_9-> (u (u fm_term_app _ret_9) (u fm_term_ref (let _668 = _arg_8 in (case _668 of {(0,f) -> u f (\_669 _670 _671-> _670); }))))))) in _ret_8))); }))); (1,f) -> u f (\_672 _673-> (let _674 = _672 in (case _674 of {(0,f) -> u f (\_675 _676 _677-> (u (u fm_term_lam _675) (\_x_9-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _673)))); }))); })))))
fm_constructor_build_term_opt = (\_type_1-> (\_ctor_2-> (let _678 = _type_1 in (case _678 of {(0,f) -> u f (\_679 _680 _681 _682-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _682)); }))))
fm_constructor_build_term_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _683 = _pars_4 in (case _683 of {(0,f) -> u f ((let _684 = _args_5 in (case _684 of {(0,f) -> u f ((u (u fm_term_lam (u fm_name_read "P")) (\_x_6-> (u (u fm_constructor_build_term_opt _type_1) _ctor_2)))); (1,f) -> u f (\_685 _686-> (let _687 = _685 in (case _687 of {(0,f) -> u f (\_688 _689 _690-> (u (u fm_term_lam _689) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _pars_4) _686)))); }))); }))); (1,f) -> u f (\_691 _692-> (let _693 = _691 in (case _693 of {(0,f) -> u f (\_694 _695 _696-> (u (u fm_term_lam _695) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _692) _args_5)))); }))); })))))))
fm_constructor_build_term = (\_type_1-> (\_ctor_2-> (let _697 = _type_1 in (case _697 of {(0,f) -> u f (\_698 _699 _700 _701-> (let _702 = _ctor_2 in (case _702 of {(0,f) -> u f (\_703 _704 _705-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _698) _699) _704)); }))); }))))
fm_constructor_build_type_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _706 = _pars_4 in (case _706 of {(0,f) -> u f ((let _707 = _args_5 in (case _707 of {(0,f) -> u f ((let _708 = _type_1 in (case _708 of {(0,f) -> u f (\_709 _710 _711 _712-> (let _713 = _ctor_2 in (case _713 of {(0,f) -> u f (\_714 _715 _716-> (let _type_13=(u fm_term_ref _name_3) in (let _type_14=(u (u (u list_for _710) _type_13) (\_var_14-> (\_type_15-> (u (u fm_term_app _type_15) (u fm_term_ref (let _717 = _var_14 in (case _717 of {(0,f) -> u f (\_718 _719 _720-> _719); }))))))) in (let _type_15=(u (u (u list_for _716) _type_14) (\_var_15-> (\_type_16-> (u (u fm_term_app _type_16) (let _721 = _var_15 in (case _721 of {(0,f) -> u f (\_722 _723 _724-> _724); })))))) in _type_15)))); }))); }))); (1,f) -> u f (\_725 _726-> (let _727 = _725 in (case _727 of {(0,f) -> u f (\_728 _729 _730-> (u (u (u (u (u fm_term_all _728) "") _729) _730) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _pars_4) _726))))); }))); }))); (1,f) -> u f (\_731 _732-> (let _733 = _731 in (case _733 of {(0,f) -> u f (\_734 _735 _736-> (u (u (u (u (u fm_term_all _734) "") _735) _736) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _732) _args_5))))); }))); })))))))
fm_constructor_build_type = (\_type_1-> (\_ctor_2-> (let _737 = _type_1 in (case _737 of {(0,f) -> u f (\_738 _739 _740 _741-> (let _742 = _ctor_2 in (case _742 of {(0,f) -> u f (\_743 _744 _745-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _738) _739) _744)); }))); }))))
fm_parser_file_adt = (\_file_1-> (\_code_2-> (\_defs_3-> (u (u (u monad_bind parser_monad) fm_parser_datatype) (\_adt_4-> (let _746 = _adt_4 in (case _746 of {(0,f) -> u f (\_747 _748 _749 _750-> (let _term_9=(u fm_datatype_build_term _adt_4) in (let _term_10=(u (u (u fm_term_bind list_nil) (\_x_10-> (u bits_i _x_10))) _term_9) in (let _type_11=(u fm_datatype_build_type _adt_4) in (let _type_12=(u (u (u fm_term_bind list_nil) (\_x_12-> (u bits_o _x_12))) _type_11) in (let _defs_13=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _747) _term_10) _type_12) bool_false) _defs_3) in (let _defs_14=(u (u (u list_fold _750) _defs_13) (\_ctr_14-> (\_defs_15-> (let _typ_name_16=_747 in (let _ctr_name_17=(u string_flatten (u (u list_cons _typ_name_16) (u (u list_cons (u fm_name_read ".")) (u (u list_cons (let _751 = _ctr_14 in (case _751 of {(0,f) -> u f (\_752 _753 _754-> _752); }))) list_nil)))) in (let _ctr_term_18=(u (u fm_constructor_build_term _adt_4) _ctr_14) in (let _ctr_term_19=(u (u (u fm_term_bind list_nil) (\_x_19-> (u bits_i _x_19))) _ctr_term_18) in (let _ctr_type_20=(u (u fm_constructor_build_type _adt_4) _ctr_14) in (let _ctr_type_21=(u (u (u fm_term_bind list_nil) (\_x_21-> (u bits_o _x_21))) _ctr_type_20) in (u (u (u (u (u (u (u fm_define _file_1) _code_2) _ctr_name_17) _ctr_term_19) _ctr_type_21) bool_false) _defs_15)))))))))) in (u (u monad_pure parser_monad) _defs_14)))))))); })))))))
parser_eof = (\_idx_1-> (\_code_2-> (let _755 = _code_2 in (if null (_755::String) then (u (u (u parser_reply_value _idx_1) _code_2) unit_new) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected end-of-file.")))))
fm_parser_file_end = (\_file_1-> (\_code_2-> (\_defs_3-> (u (u (u monad_bind parser_monad) fm_parser_spaces) (\__4-> (u (u (u monad_bind parser_monad) parser_eof) (\__5-> (u (u monad_pure parser_monad) _defs_3))))))))
fm_parser_file = (\_file_1-> (\_code_2-> (\_defs_3-> (u (u (u monad_bind parser_monad) parser_is_eof) (\_stop_4-> (let _756 = _stop_4 in (if _756 then (u (u monad_pure parser_monad) _defs_3) else (u parser_first_of (u (u list_cons (u (u (u monad_bind parser_monad) (u fm_parser_text "#")) (\__5-> (u (u (u monad_bind parser_monad) fm_parser_name1) (\_file_6-> (u (u (u fm_parser_file _file_6) _code_2) _defs_3)))))) (u (u list_cons (u (u (u monad_bind parser_monad) (u parser_first_of (u (u list_cons (u (u (u fm_parser_file_def _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_adt _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_end _file_1) _code_2) _defs_3)) list_nil))))) (\_defs_5-> (u (u (u fm_parser_file _file_1) _code_2) _defs_5)))) list_nil))))))))))
either = (\_a_1-> (\_b_2-> ()))
string_join_go = (\_sep_1-> (\_list_2-> (\_fst_3-> (let _757 = _list_2 in (case _757 of {(0,f) -> u f (""); (1,f) -> u f (\_758 _759-> (u string_flatten (u (u list_cons (let _760 = _fst_3 in (if _760 then "" else _sep_1))) (u (u list_cons _758) (u (u list_cons (u (u (u string_join_go _sep_1) _759) bool_false)) list_nil))))); })))))
string_join = (\_sep_1-> (\_list_2-> (u (u (u string_join_go _sep_1) _list_2) bool_true)))
fm_highlight_end = (\_col_1-> (\_row_2-> (\_res_3-> (u (u string_join "\n") _res_3))))
maybe_extract = (\_m_2-> (\_a_4-> (\_f_5-> (let _761 = _m_2 in (case _761 of {(0,f) -> u f (_a_4); (1,f) -> u f (\_762-> (u _f_5 _762)); })))))
nat_is_zero = (\_n_1-> (let _763 = _n_1 in (if _763==0 then bool_true else bool_false)))
nat_double = (\_n_1-> (let _764 = _n_1 in (if _764==0 then nat_zero else (u nat_succ (u nat_succ (u nat_double (_764-1)))))))
nat_pred = (\_n_1-> (let _765 = _n_1 in (if _765==0 then nat_zero else (_765-1))))
list_take = (\_n_2-> (\_xs_3-> (let _766 = _xs_3 in (case _766 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_767 _768-> (let _769 = _n_2 in (if _769==0 then list_nil else (u (u list_cons _767) (u (u list_take (_769-1)) _768))))); }))))
string_reverse_go = (\_xs_1-> (\_res_2-> (let _770 = _xs_1 in (if null (_770::String) then _res_2 else (u (u string_reverse_go (tail _770)) (u (u string_cons (fromIntegral (fromEnum (head _770 :: Char)) :: Word16)) _res_2))))))
string_reverse = (\_xs_1-> (u (u string_reverse_go _xs_1) string_nil))
string_pad_right = (\_size_1-> (\_chr_2-> (\_str_3-> (let _771 = _size_1 in (if _771==0 then _str_3 else (let _772 = _str_3 in (if null (_772::String) then (u (u string_cons _chr_2) (u (u (u string_pad_right (_771-1)) _chr_2) "")) else (u (u string_cons (fromIntegral (fromEnum (head _772 :: Char)) :: Word16)) (u (u (u string_pad_right (_771-1)) _chr_2) (tail _772))))))))))
string_pad_left = (\_size_1-> (\_chr_2-> (\_str_3-> (u string_reverse (u (u (u string_pad_right _size_1) _chr_2) (u string_reverse _str_3))))))
either_left = (\_value_3-> (0,\t-> t _value_3))
either_right = (\_value_3-> (1,\t-> t _value_3))
nat_sub_rem = (\_n_1-> (\_m_2-> (let _773 = _m_2 in (if _773==0 then (u either_left _n_1) else (let _774 = _n_1 in (if _774==0 then (u either_right (u nat_succ (_773-1))) else (u (u nat_sub_rem (_774-1)) (_773-1))))))))
nat_div_mod_go = (\_n_1-> (\_m_2-> (\_d_3-> (let _775 = (u (u nat_sub_rem _n_1) _m_2) in (case _775 of {(0,f) -> u f (\_776-> (u (u (u nat_div_mod_go _776) _m_2) (u nat_succ _d_3))); (1,f) -> u f (\_777-> (u (u pair_new _d_3) _n_1)); })))))
nat_div_mod = (\_n_1-> (\_m_2-> (u (u (u nat_div_mod_go _n_1) _m_2) nat_zero)))
nat_to_base_go = (\_base_1-> (\_nat_2-> (\_res_3-> (let _778 = (u (u nat_div_mod _nat_2) _base_1) in (case _778 of {(0,f) -> u f (\_779 _780-> (let _781 = _779 in (if _781==0 then (u (u list_cons _780) _res_3) else (u (u (u nat_to_base_go _base_1) _779) (u (u list_cons _780) _res_3))))); })))))
nat_to_base = (\_base_1-> (\_nat_2-> (u (u (u nat_to_base_go _base_1) _nat_2) list_nil)))
nat_mod_go = (\_n_1-> (\_m_2-> (\_r_3-> (let _782 = _m_2 in (if _782==0 then (u (u (u nat_mod_go _n_1) _r_3) _m_2) else (let _783 = _n_1 in (if _783==0 then _r_3 else (u (u (u nat_mod_go (_783-1)) (_782-1)) (u nat_succ _r_3)))))))))
nat_mod = (\_n_1-> (\_m_2-> (u (u (u nat_mod_go _n_1) _m_2) 0)))
nat_lte = (\a0-> \a1-> ((a0::Integer) <= a1))
nat_show_digit = (\_base_1-> (\_n_2-> (let _m_3=(u (u nat_mod _n_2) _base_1) in (let _base64_4=(u (u list_cons 48) (u (u list_cons 49) (u (u list_cons 50) (u (u list_cons 51) (u (u list_cons 52) (u (u list_cons 53) (u (u list_cons 54) (u (u list_cons 55) (u (u list_cons 56) (u (u list_cons 57) (u (u list_cons 65) (u (u list_cons 66) (u (u list_cons 67) (u (u list_cons 68) (u (u list_cons 69) (u (u list_cons 70) (u (u list_cons 71) (u (u list_cons 72) (u (u list_cons 73) (u (u list_cons 74) (u (u list_cons 75) (u (u list_cons 76) (u (u list_cons 77) (u (u list_cons 78) (u (u list_cons 79) (u (u list_cons 80) (u (u list_cons 81) (u (u list_cons 82) (u (u list_cons 83) (u (u list_cons 84) (u (u list_cons 85) (u (u list_cons 86) (u (u list_cons 87) (u (u list_cons 88) (u (u list_cons 89) (u (u list_cons 90) (u (u list_cons 97) (u (u list_cons 98) (u (u list_cons 99) (u (u list_cons 100) (u (u list_cons 101) (u (u list_cons 102) (u (u list_cons 103) (u (u list_cons 104) (u (u list_cons 105) (u (u list_cons 106) (u (u list_cons 107) (u (u list_cons 108) (u (u list_cons 109) (u (u list_cons 110) (u (u list_cons 111) (u (u list_cons 112) (u (u list_cons 113) (u (u list_cons 114) (u (u list_cons 115) (u (u list_cons 116) (u (u list_cons 117) (u (u list_cons 118) (u (u list_cons 119) (u (u list_cons 120) (u (u list_cons 121) (u (u list_cons 122) (u (u list_cons 43) (u (u list_cons 47) list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (let _784 = (((((_base_1::Integer) > 0)) && (((_base_1::Integer) <= 64)))) in (if _784 then (let _785 = (u (u list_at _m_3) _base64_4) in (case _785 of {(0,f) -> u f (35); (1,f) -> u f (\_786-> _786); })) else 35))))))
nat_to_string_base = (\_base_1-> (\_nat_2-> (u (u (u list_fold (u (u nat_to_base _base_1) _nat_2)) string_nil) (\_n_3-> (\_str_4-> (u (u string_cons (u (u nat_show_digit _base_1) _n_3)) _str_4))))))
nat_show = (\_n_1-> (u (u nat_to_string_base 10) _n_1))
bool_not = (\a0-> (not a0))
fm_color = (\_col_1-> (\_str_2-> (u (u string_cons 27) (u (u string_cons 91) (((_col_1::String) ++ (u (u string_cons 109) (((_str_2::String) ++ (u (u string_cons 27) (u (u string_cons 91) (u (u string_cons 48) (u (u string_cons 109) string_nil)))))))))))))
fm_highlight_tc = (\_code_1-> (\_ix0_2-> (\_ix1_3-> (\_col_4-> (\_row_5-> (\_lft_6-> (\_lin_7-> (\_res_8-> (let _787 = _code_1 in (if null (_787::String) then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _788 = ((((fromIntegral (fromEnum (head _787 :: Char)) :: Word16)::Word16) == 10)) in (if _788 then (let _stp_11=(u (u (u maybe_extract _lft_6) bool_false) nat_is_zero) in (let _789 = _stp_11 in (if _789 then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _spa_12=3 in (let _siz_13=(u nat_succ (u nat_double _spa_12)) in (let _lft_14=(let _790 = _ix1_3 in (if _790==0 then (let _791 = _lft_6 in (case _791 of {(0,f) -> u f ((u maybe_some _spa_12)); (1,f) -> u f (\_792-> (u maybe_some (u nat_pred _792))); })) else _lft_6)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=0 in (let _row_18=(u nat_succ _row_5) in (let _res_19=(u (u list_take _siz_13) (u (u list_cons (u string_reverse _lin_7)) _res_8)) in (let _lin_20=(u string_reverse (u string_flatten (u (u list_cons (u (u (u string_pad_left 4) 32) (u nat_show _row_18))) (u (u list_cons " | ") list_nil)))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _787)) _ix0_15) _ix1_16) _col_17) _row_18) _lft_14) _lin_20) _res_19))))))))))))) else (let _chr_11=(u (u string_cons (fromIntegral (fromEnum (head _787 :: Char)) :: Word16)) string_nil) in (let _chr_12=(let _793 = (((u nat_is_zero _ix0_2) && ((not (u nat_is_zero _ix1_3))))) in (if _793 then (u string_reverse (u (u fm_color "31") (u (u fm_color "4") _chr_11))) else _chr_11)) in (let _ix0_13=(u nat_pred _ix0_2) in (let _ix1_14=(u nat_pred _ix1_3) in (let _col_15=(u nat_succ _col_4) in (let _lin_16=(u string_flatten (u (u list_cons _chr_12) (u (u list_cons _lin_7) list_nil))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _787)) _ix0_13) _ix1_14) _col_15) _row_5) _lft_6) _lin_16) _res_8)))))))))))))))))))
fm_highlight = (\_code_1-> (\_idx0_2-> (\_idx1_3-> (u (u (u (u (u (u (u (u fm_highlight_tc _code_1) _idx0_2) _idx1_3) 0) 1) maybe_none) (u string_reverse "   1 | ")) list_nil))))
fm_defs_read = (\_file_1-> (\_code_2-> (\_defs_3-> (let _794 = (u (u (u (u (u fm_parser_file _file_1) _code_2) _defs_3) 0) _code_2) in (case _794 of {(0,f) -> u f (\_795 _796 _797-> (let _err_7=_797 in (let _hig_8=(u (u (u fm_highlight _code_2) _795) (u nat_succ _795)) in (let _str_9=(u string_flatten (u (u list_cons _err_7) (u (u list_cons "\n") (u (u list_cons _hig_8) list_nil)))) in (u either_left _str_9))))); (1,f) -> u f (\_798 _799 _800-> (u either_right _800)); })))))
fm_synth_load = (\_name_1-> (\_defs_2-> (let _file_3=(u fm_synth_file_of _name_1) in (u (u (u monad_bind io_monad) (u io_get_file _file_3)) (\_code_4-> (let _read_5=(u (u (u fm_defs_read _file_3) _code_4) _defs_2) in (let _801 = _read_5 in (case _801 of {(0,f) -> u f (\_802-> (u (u monad_pure io_monad) maybe_none)); (1,f) -> u f (\_803-> (let _defs_7=_803 in (let _804 = (u (u fm_get _name_1) _defs_7) in (case _804 of {(0,f) -> u f ((u (u monad_pure io_monad) maybe_none)); (1,f) -> u f (\_805-> (u (u monad_pure io_monad) (u maybe_some _defs_7))); })))); }))))))))
io_print = (\_text_1-> (u (u (u io_ask "print") _text_1) (\_skip_2-> (u io_end unit_new))))
fm_status_wait = (1,\t-> t)
fm_check = (\_v_1-> ())
fm_check_result = (\_value_2-> (\_errors_3-> (0,\t-> t _value_2 _errors_3)))
fm_check_bind = (\_a_3-> (\_f_4-> (let _806 = _a_3 in (case _806 of {(0,f) -> u f (\_807 _808-> (let _809 = _807 in (case _809 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _808)); (1,f) -> u f (\_810-> (let _811 = (u _f_4 _810) in (case _811 of {(0,f) -> u f (\_812 _813-> (u (u fm_check_result _812) (u (u list_concat _808) _813))); }))); }))); }))))
fm_check_pure = (\_value_2-> (u (u fm_check_result (u maybe_some _value_2)) list_nil))
fm_check_monad = (u (u monad_new fm_check_bind) fm_check_pure)
fm_error_undefined_reference = (\_origin_1-> (\_name_2-> (5,\t-> t _origin_1 _name_2)))
fm_error_waiting = (\_name_1-> (2,\t-> t _name_1))
fm_error_indirect = (\_name_1-> (3,\t-> t _name_1))
maybe_mapped = (\_m_2-> (\_f_4-> (let _814 = _m_2 in (case _814 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_815-> (u maybe_some (u _f_4 _815))); }))))
fm_mpath_o = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_o))
fm_mpath_i = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_i))
fm_error_cant_infer = (\_origin_1-> (\_term_2-> (\_context_3-> (6,\t-> t _origin_1 _term_2 _context_3))))
fm_error_type_mismatch = (\_origin_1-> (\_expected_2-> (\_detected_3-> (\_context_4-> (0,\t-> t _origin_1 _expected_2 _detected_3 _context_4)))))
fm_error_show_goal = (\_name_1-> (\_dref_2-> (\_verb_3-> (\_goal_4-> (\_context_5-> (1,\t-> t _name_1 _dref_2 _verb_3 _goal_4 _context_5))))))
fm_term_normalize = (\_term_1-> (\_defs_2-> (let _816 = (u (u fm_term_reduce _term_1) _defs_2) in (case _816 of {(0,f) -> u f (\_817 _818-> (u (u fm_term_var _817) _818)); (1,f) -> u f (\_819-> (u fm_term_ref _819)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_820 _821 _822 _823 _824-> (u (u (u (u (u fm_term_all _820) _821) _822) (u (u fm_term_normalize _823) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_normalize (u (u _824 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_825 _826-> (u (u fm_term_lam _825) (\_x_5-> (u (u fm_term_normalize (u _826 _x_5)) _defs_2)))); (5,f) -> u f (\_827 _828-> (u (u fm_term_app (u (u fm_term_normalize _827) _defs_2)) (u (u fm_term_normalize _828) _defs_2))); (6,f) -> u f (\_829 _830 _831-> (u (u (u fm_term_let _829) (u (u fm_term_normalize _830) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _831 _x_6)) _defs_2)))); (7,f) -> u f (\_832 _833 _834-> (u (u (u fm_term_def _832) (u (u fm_term_normalize _833) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _834 _x_6)) _defs_2)))); (8,f) -> u f (\_835 _836 _837-> (u (u (u fm_term_ann _835) (u (u fm_term_normalize _836) _defs_2)) (u (u fm_term_normalize _837) _defs_2))); (9,f) -> u f (\_838 _839 _840-> (u (u (u fm_term_gol _838) _839) _840)); (10,f) -> u f (\_841-> (u fm_term_hol _841)); (11,f) -> u f (\_842-> (u fm_term_nat _842)); (12,f) -> u f (\_843-> (u fm_term_chr _843)); (13,f) -> u f (\_844-> (u fm_term_str _844)); (14,f) -> u f (\_845 _846 _847 _848 _849 _850-> _term_1); (15,f) -> u f (\_851 _852-> (u (u fm_term_normalize _852) _defs_2)); }))))
list_tail = (\_xs_2-> (let _853 = _xs_2 in (case _853 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_854 _855-> _855); })))
fm_smartmotive_vals_cont = (\_expr_1-> (\_term_2-> (\_args_3-> (\_defs_4-> (let _856 = (u (u fm_term_reduce _term_2) _defs_4) in (case _856 of {(0,f) -> u f (\_857 _858-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (1,f) -> u f (\_859-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (2,f) -> u f ((u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (3,f) -> u f (\_860 _861 _862 _863 _864-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (4,f) -> u f (\_865 _866-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (5,f) -> u f (\_867 _868-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _867) (u (u list_cons _868) _args_3)) _defs_4)); (6,f) -> u f (\_869 _870 _871-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (7,f) -> u f (\_872 _873 _874-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (8,f) -> u f (\_875 _876 _877-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (9,f) -> u f (\_878 _879 _880-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (10,f) -> u f (\_881-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (11,f) -> u f (\_882-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (12,f) -> u f (\_883-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (13,f) -> u f (\_884-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (14,f) -> u f (\_885 _886 _887 _888 _889 _890-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (15,f) -> u f (\_891 _892-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); }))))))
fm_smartmotive_vals = (\_expr_1-> (\_type_2-> (\_defs_3-> (let _893 = (u (u fm_term_reduce _type_2) _defs_3) in (case _893 of {(0,f) -> u f (\_894 _895-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (1,f) -> u f (\_896-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (2,f) -> u f ((u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (3,f) -> u f (\_897 _898 _899 _900 _901-> (u (u (u fm_smartmotive_vals _expr_1) (u (u _901 fm_term_typ) fm_term_typ)) _defs_3)); (4,f) -> u f (\_902 _903-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (5,f) -> u f (\_904 _905-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (6,f) -> u f (\_906 _907 _908-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (7,f) -> u f (\_909 _910 _911-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (8,f) -> u f (\_912 _913 _914-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (9,f) -> u f (\_915 _916 _917-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (10,f) -> u f (\_918-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (11,f) -> u f (\_919-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (12,f) -> u f (\_920-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (13,f) -> u f (\_921-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (14,f) -> u f (\_922 _923 _924 _925 _926 _927-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (15,f) -> u f (\_928 _929-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); })))))
fm_smartmotive_nams_cont = (\_name_1-> (\_term_2-> (\_binds_3-> (\_defs_4-> (let _930 = (u (u fm_term_reduce _term_2) _defs_4) in (case _930 of {(0,f) -> u f (\_931 _932-> (u (u list_cons _name_1) (u list_tail _binds_3))); (1,f) -> u f (\_933-> (u (u list_cons _name_1) (u list_tail _binds_3))); (2,f) -> u f ((u (u list_cons _name_1) (u list_tail _binds_3))); (3,f) -> u f (\_934 _935 _936 _937 _938-> (u (u (u (u fm_smartmotive_nams_cont _name_1) (u (u _938 (u fm_term_ref _935)) (u fm_term_ref _936))) (u (u list_cons (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _936) list_nil))))) _binds_3)) _defs_4)); (4,f) -> u f (\_939 _940-> (u (u list_cons _name_1) (u list_tail _binds_3))); (5,f) -> u f (\_941 _942-> (u (u list_cons _name_1) (u list_tail _binds_3))); (6,f) -> u f (\_943 _944 _945-> (u (u list_cons _name_1) (u list_tail _binds_3))); (7,f) -> u f (\_946 _947 _948-> (u (u list_cons _name_1) (u list_tail _binds_3))); (8,f) -> u f (\_949 _950 _951-> (u (u list_cons _name_1) (u list_tail _binds_3))); (9,f) -> u f (\_952 _953 _954-> (u (u list_cons _name_1) (u list_tail _binds_3))); (10,f) -> u f (\_955-> (u (u list_cons _name_1) (u list_tail _binds_3))); (11,f) -> u f (\_956-> (u (u list_cons _name_1) (u list_tail _binds_3))); (12,f) -> u f (\_957-> (u (u list_cons _name_1) (u list_tail _binds_3))); (13,f) -> u f (\_958-> (u (u list_cons _name_1) (u list_tail _binds_3))); (14,f) -> u f (\_959 _960 _961 _962 _963 _964-> (u (u list_cons _name_1) (u list_tail _binds_3))); (15,f) -> u f (\_965 _966-> (u (u list_cons _name_1) (u list_tail _binds_3))); }))))))
fm_smartmotive_nams = (\_name_1-> (\_type_2-> (\_defs_3-> (let _967 = (u (u fm_term_reduce _type_2) _defs_3) in (case _967 of {(0,f) -> u f (\_968 _969-> list_nil); (1,f) -> u f (\_970-> list_nil); (2,f) -> u f (list_nil); (3,f) -> u f (\_971 _972 _973 _974 _975-> (u (u (u (u fm_smartmotive_nams_cont _name_1) _974) list_nil) _defs_3)); (4,f) -> u f (\_976 _977-> list_nil); (5,f) -> u f (\_978 _979-> list_nil); (6,f) -> u f (\_980 _981 _982-> list_nil); (7,f) -> u f (\_983 _984 _985-> list_nil); (8,f) -> u f (\_986 _987 _988-> list_nil); (9,f) -> u f (\_989 _990 _991-> list_nil); (10,f) -> u f (\_992-> list_nil); (11,f) -> u f (\_993-> list_nil); (12,f) -> u f (\_994-> list_nil); (13,f) -> u f (\_995-> list_nil); (14,f) -> u f (\_996 _997 _998 _999 _1000 _1001-> list_nil); (15,f) -> u f (\_1002 _1003-> list_nil); })))))
list_zip = (\_as_3-> (\_bs_4-> (let _1004 = _as_3 in (case _1004 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_1005 _1006-> (let _1007 = _bs_4 in (case _1007 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_1008 _1009-> (u (u list_cons (u (u pair_new _1005) _1008)) (u (u list_zip _1006) _1009))); }))); }))))
nat_gte = (\a0-> \a1-> ((a0::Integer) >= a1))
nat_sub = (\a0-> \a1-> ((a0::Integer) - a1))
fm_term_serialize_name = (\_name_1-> (u fm_name_to_bits _name_1))
fm_term_serialize = (\_term_1-> (\_depth_2-> (\_init_3-> (\_x_4-> (let _1010 = _term_1 in (case _1010 of {(0,f) -> u f (\_1011 _1012-> (let _1013 = (((_1012::Integer) >= _init_3)) in (if _1013 then (let _name_7=(u bits_concat (u nat_to_bits (u nat_pred (((_depth_2::Integer) - _1012))))) in (u bits_o (u bits_o (u bits_i (u _name_7 _x_4))))) else (let _name_7=(u bits_concat (u nat_to_bits _1012)) in (u bits_o (u bits_i (u bits_o (u _name_7 _x_4)))))))); (1,f) -> u f (\_1014-> (let _name_6=(u bits_concat (u fm_term_serialize_name _1014)) in (u bits_o (u bits_o (u bits_o (u _name_6 _x_4)))))); (2,f) -> u f ((u bits_o (u bits_i (u bits_i _x_4)))); (3,f) -> u f (\_1015 _1016 _1017 _1018 _1019-> (let _eras_10=(let _1020 = _1015 in (if _1020 then bits_i else bits_o)) in (let _self_11=(u bits_concat (u fm_name_to_bits _1016)) in (let _xtyp_12=(u (u (u fm_term_serialize _1018) _depth_2) _init_3) in (let _body_13=(u (u (u fm_term_serialize (u (u _1019 (u (u fm_term_var _1016) _depth_2)) (u (u fm_term_var _1017) (u nat_succ _depth_2)))) (u nat_succ (u nat_succ _depth_2))) _init_3) in (u bits_i (u bits_o (u bits_o (u _eras_10 (u _self_11 (u _xtyp_12 (u _body_13 _x_4)))))))))))); (4,f) -> u f (\_1021 _1022-> (let _body_7=(u (u (u fm_term_serialize (u _1022 (u (u fm_term_var _1021) _depth_2))) (u nat_succ _depth_2)) _init_3) in (u bits_i (u bits_o (u bits_i (u _body_7 _x_4)))))); (5,f) -> u f (\_1023 _1024-> (let _func_7=(u (u (u fm_term_serialize _1023) _depth_2) _init_3) in (let _argm_8=(u (u (u fm_term_serialize _1024) _depth_2) _init_3) in (u bits_i (u bits_i (u bits_o (u _func_7 (u _argm_8 _x_4)))))))); (6,f) -> u f (\_1025 _1026 _1027-> (let _expr_8=(u (u (u fm_term_serialize _1026) _depth_2) _init_3) in (let _body_9=(u (u (u fm_term_serialize (u _1027 (u (u fm_term_var _1025) _depth_2))) (u nat_succ _depth_2)) _init_3) in (u bits_i (u bits_i (u bits_i (u _expr_8 (u _body_9 _x_4)))))))); (7,f) -> u f (\_1028 _1029 _1030-> (u (u (u (u fm_term_serialize (u _1030 _1029)) _depth_2) _init_3) _x_4)); (8,f) -> u f (\_1031 _1032 _1033-> (u (u (u (u fm_term_serialize _1032) _depth_2) _init_3) _x_4)); (9,f) -> u f (\_1034 _1035 _1036-> (let _name_8=(u bits_concat (u fm_name_to_bits _1034)) in (u bits_o (u bits_o (u bits_o (u _name_8 _x_4)))))); (10,f) -> u f (\_1037-> _x_4); (11,f) -> u f (\_1038-> (u (u (u (u fm_term_serialize (u fm_term_unroll_nat _1038)) _depth_2) _init_3) _x_4)); (12,f) -> u f (\_1039-> (u (u (u (u fm_term_serialize (u fm_term_unroll_chr _1039)) _depth_2) _init_3) _x_4)); (13,f) -> u f (\_1040-> (u (u (u (u fm_term_serialize (u fm_term_unroll_str _1040)) _depth_2) _init_3) _x_4)); (14,f) -> u f (\_1041 _1042 _1043 _1044 _1045 _1046-> _x_4); (15,f) -> u f (\_1047 _1048-> (u (u (u (u fm_term_serialize _1048) _depth_2) _init_3) _x_4)); }))))))
bits_eql = (\_a_1-> (\_b_2-> (let _1049 = _a_1 in (case _1049 of {(0,f) -> u f ((let _1050 = _b_2 in (case _1050 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_1051-> bool_false); (2,f) -> u f (\_1052-> bool_false); }))); (1,f) -> u f (\_1053-> (let _1054 = _b_2 in (case _1054 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_1055-> (u (u bits_eql _1053) _1055)); (2,f) -> u f (\_1056-> bool_false); }))); (2,f) -> u f (\_1057-> (let _1058 = _b_2 in (case _1058 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_1059-> bool_false); (2,f) -> u f (\_1060-> (u (u bits_eql _1057) _1060)); }))); }))))
fm_term_identical = (\_a_1-> (\_b_2-> (\_lv_3-> (let _ah_4=(u (u (u (u fm_term_serialize _a_1) _lv_3) _lv_3) bits_e) in (let _bh_5=(u (u (u (u fm_term_serialize _b_2) _lv_3) _lv_3) bits_e) in (u (u bits_eql _ah_4) _bh_5))))))
fm_smartmotive_replace = (\_term_1-> (\_from_2-> (\_to_3-> (\_lv_4-> (let _1061 = (u (u (u fm_term_identical _term_1) _from_2) _lv_4) in (if _1061 then _to_3 else (let _1062 = _term_1 in (case _1062 of {(0,f) -> u f (\_1063 _1064-> (u (u fm_term_var _1063) _1064)); (1,f) -> u f (\_1065-> (u fm_term_ref _1065)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_1066 _1067 _1068 _1069 _1070-> (let _xtyp_10=(u (u (u (u fm_smartmotive_replace _1069) _from_2) _to_3) _lv_4) in (let _body_11=(u (u _1070 (u fm_term_ref _1067)) (u fm_term_ref _1068)) in (let _body_12=(u (u (u (u fm_smartmotive_replace _body_11) _from_2) _to_3) (u nat_succ (u nat_succ _lv_4))) in (u (u (u (u (u fm_term_all _1066) _1067) _1068) _xtyp_10) (\_s_13-> (\_x_14-> _body_12))))))); (4,f) -> u f (\_1071 _1072-> (let _body_7=(u _1072 (u fm_term_ref _1071)) in (let _body_8=(u (u (u (u fm_smartmotive_replace _body_7) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u fm_term_lam _1071) (\_x_9-> _body_8))))); (5,f) -> u f (\_1073 _1074-> (let _func_7=(u (u (u (u fm_smartmotive_replace _1073) _from_2) _to_3) _lv_4) in (let _argm_8=(u (u (u (u fm_smartmotive_replace _1074) _from_2) _to_3) _lv_4) in (u (u fm_term_app _func_7) _argm_8)))); (6,f) -> u f (\_1075 _1076 _1077-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _1076) _from_2) _to_3) _lv_4) in (let _body_9=(u _1077 (u fm_term_ref _1075)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_let _1075) _expr_8) (\_x_11-> _body_10)))))); (7,f) -> u f (\_1078 _1079 _1080-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _1079) _from_2) _to_3) _lv_4) in (let _body_9=(u _1080 (u fm_term_ref _1078)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_def _1078) _expr_8) (\_x_11-> _body_10)))))); (8,f) -> u f (\_1081 _1082 _1083-> (let _term_8=(u (u (u (u fm_smartmotive_replace _1082) _from_2) _to_3) _lv_4) in (let _type_9=(u (u (u (u fm_smartmotive_replace _1083) _from_2) _to_3) _lv_4) in (u (u (u fm_term_ann _1081) _term_8) _type_9)))); (9,f) -> u f (\_1084 _1085 _1086-> _term_1); (10,f) -> u f (\_1087-> _term_1); (11,f) -> u f (\_1088-> _term_1); (12,f) -> u f (\_1089-> _term_1); (13,f) -> u f (\_1090-> _term_1); (14,f) -> u f (\_1091 _1092 _1093 _1094 _1095 _1096-> _term_1); (15,f) -> u f (\_1097 _1098-> (u (u (u (u fm_smartmotive_replace _1098) _from_2) _to_3) _lv_4)); }))))))))
fm_smartmotive_make = (\_name_1-> (\_expr_2-> (\_type_3-> (\_moti_4-> (\_lv_5-> (\_defs_6-> (let _vals_7=(u (u (u fm_smartmotive_vals _expr_2) _type_3) _defs_6) in (let _nams_8=(u (u (u fm_smartmotive_nams _name_1) _type_3) _defs_6) in (let _subs_9=(u (u list_zip _nams_8) _vals_7) in (let _moti_10=(u (u (u list_fold _subs_9) _moti_4) (\_sub_10-> (\_moti_11-> (let _1099 = _sub_10 in (case _1099 of {(0,f) -> u f (\_1100 _1101-> (u (u (u (u fm_smartmotive_replace _moti_11) _1101) (u fm_term_ref _1100)) _lv_5)); }))))) in _moti_10))))))))))
fm_term_desugar_cse_motive = (\_wyth_1-> (\_moti_2-> (let _1102 = _wyth_1 in (case _1102 of {(0,f) -> u f (_moti_2); (1,f) -> u f (\_1103 _1104-> (let _1105 = _1103 in (case _1105 of {(0,f) -> u f (\_1106 _1107 _1108 _1109 _1110 _1111-> (u (u (u (u (u fm_term_all bool_false) "") _1108) _1110) (\_s_11-> (\_x_12-> (u (u fm_term_desugar_cse_motive _1104) _moti_2))))); }))); }))))
string_is_empty = (\_str_1-> (let _1112 = _str_1 in (if null (_1112::String) then bool_true else bool_false)))
fm_term_desugar_cse_argument = (\_name_1-> (\_wyth_2-> (\_type_3-> (\_body_4-> (\_defs_5-> (let _1113 = (u (u fm_term_reduce _type_3) _defs_5) in (case _1113 of {(0,f) -> u f (\_1114 _1115-> (let _1116 = _wyth_2 in (case _1116 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1117 _1118-> (let _1119 = _1117 in (case _1119 of {(0,f) -> u f (\_1120 _1121 _1122 _1123 _1124 _1125-> (u (u fm_term_lam _1122) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1118) _type_3) _body_4) _defs_5)))); }))); }))); (1,f) -> u f (\_1126-> (let _1127 = _wyth_2 in (case _1127 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1128 _1129-> (let _1130 = _1128 in (case _1130 of {(0,f) -> u f (\_1131 _1132 _1133 _1134 _1135 _1136-> (u (u fm_term_lam _1133) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1129) _type_3) _body_4) _defs_5)))); }))); }))); (2,f) -> u f ((let _1137 = _wyth_2 in (case _1137 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1138 _1139-> (let _1140 = _1138 in (case _1140 of {(0,f) -> u f (\_1141 _1142 _1143 _1144 _1145 _1146-> (u (u fm_term_lam _1143) (\_x_14-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1139) _type_3) _body_4) _defs_5)))); }))); }))); (3,f) -> u f (\_1147 _1148 _1149 _1150 _1151-> (u (u fm_term_lam (let _1152 = (u string_is_empty _1149) in (if _1152 then _name_1 else (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _1149) list_nil))))))) (\_x_11-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _wyth_2) (u (u _1151 (u (u fm_term_var _1148) 0)) (u (u fm_term_var _1149) 0))) _body_4) _defs_5)))); (4,f) -> u f (\_1153 _1154-> (let _1155 = _wyth_2 in (case _1155 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1156 _1157-> (let _1158 = _1156 in (case _1158 of {(0,f) -> u f (\_1159 _1160 _1161 _1162 _1163 _1164-> (u (u fm_term_lam _1161) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1157) _type_3) _body_4) _defs_5)))); }))); }))); (5,f) -> u f (\_1165 _1166-> (let _1167 = _wyth_2 in (case _1167 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1168 _1169-> (let _1170 = _1168 in (case _1170 of {(0,f) -> u f (\_1171 _1172 _1173 _1174 _1175 _1176-> (u (u fm_term_lam _1173) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1169) _type_3) _body_4) _defs_5)))); }))); }))); (6,f) -> u f (\_1177 _1178 _1179-> (let _1180 = _wyth_2 in (case _1180 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1181 _1182-> (let _1183 = _1181 in (case _1183 of {(0,f) -> u f (\_1184 _1185 _1186 _1187 _1188 _1189-> (u (u fm_term_lam _1186) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1182) _type_3) _body_4) _defs_5)))); }))); }))); (7,f) -> u f (\_1190 _1191 _1192-> (let _1193 = _wyth_2 in (case _1193 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1194 _1195-> (let _1196 = _1194 in (case _1196 of {(0,f) -> u f (\_1197 _1198 _1199 _1200 _1201 _1202-> (u (u fm_term_lam _1199) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1195) _type_3) _body_4) _defs_5)))); }))); }))); (8,f) -> u f (\_1203 _1204 _1205-> (let _1206 = _wyth_2 in (case _1206 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1207 _1208-> (let _1209 = _1207 in (case _1209 of {(0,f) -> u f (\_1210 _1211 _1212 _1213 _1214 _1215-> (u (u fm_term_lam _1212) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1208) _type_3) _body_4) _defs_5)))); }))); }))); (9,f) -> u f (\_1216 _1217 _1218-> (let _1219 = _wyth_2 in (case _1219 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1220 _1221-> (let _1222 = _1220 in (case _1222 of {(0,f) -> u f (\_1223 _1224 _1225 _1226 _1227 _1228-> (u (u fm_term_lam _1225) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1221) _type_3) _body_4) _defs_5)))); }))); }))); (10,f) -> u f (\_1229-> (let _1230 = _wyth_2 in (case _1230 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1231 _1232-> (let _1233 = _1231 in (case _1233 of {(0,f) -> u f (\_1234 _1235 _1236 _1237 _1238 _1239-> (u (u fm_term_lam _1236) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1232) _type_3) _body_4) _defs_5)))); }))); }))); (11,f) -> u f (\_1240-> (let _1241 = _wyth_2 in (case _1241 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1242 _1243-> (let _1244 = _1242 in (case _1244 of {(0,f) -> u f (\_1245 _1246 _1247 _1248 _1249 _1250-> (u (u fm_term_lam _1247) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1243) _type_3) _body_4) _defs_5)))); }))); }))); (12,f) -> u f (\_1251-> (let _1252 = _wyth_2 in (case _1252 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1253 _1254-> (let _1255 = _1253 in (case _1255 of {(0,f) -> u f (\_1256 _1257 _1258 _1259 _1260 _1261-> (u (u fm_term_lam _1258) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1254) _type_3) _body_4) _defs_5)))); }))); }))); (13,f) -> u f (\_1262-> (let _1263 = _wyth_2 in (case _1263 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1264 _1265-> (let _1266 = _1264 in (case _1266 of {(0,f) -> u f (\_1267 _1268 _1269 _1270 _1271 _1272-> (u (u fm_term_lam _1269) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1265) _type_3) _body_4) _defs_5)))); }))); }))); (14,f) -> u f (\_1273 _1274 _1275 _1276 _1277 _1278-> (let _1279 = _wyth_2 in (case _1279 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1280 _1281-> (let _1282 = _1280 in (case _1282 of {(0,f) -> u f (\_1283 _1284 _1285 _1286 _1287 _1288-> (u (u fm_term_lam _1285) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1281) _type_3) _body_4) _defs_5)))); }))); }))); (15,f) -> u f (\_1289 _1290-> (let _1291 = _wyth_2 in (case _1291 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_1292 _1293-> (let _1294 = _1292 in (case _1294 of {(0,f) -> u f (\_1295 _1296 _1297 _1298 _1299 _1300-> (u (u fm_term_lam _1297) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _1293) _type_3) _body_4) _defs_5)))); }))); }))); })))))))
maybe_or = (\_a_2-> (\_b_3-> (let _1301 = _a_2 in (case _1301 of {(0,f) -> u f (_b_3); (1,f) -> u f (\_1302-> (u maybe_some _1302)); }))))
fm_term_desugar_cse_cases = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_type_5-> (\_defs_6-> (\_ctxt_7-> (let _1303 = (u (u fm_term_reduce _type_5) _defs_6) in (case _1303 of {(0,f) -> u f (\_1304 _1305-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _1306 = _defn_10 in (case _1306 of {(0,f) -> u f (\_1307 _1308 _1309 _1310 _1311 _1312-> _1310); })))))) in _expr_10)); (1,f) -> u f (\_1313-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _1314 = _defn_9 in (case _1314 of {(0,f) -> u f (\_1315 _1316 _1317 _1318 _1319 _1320-> _1318); })))))) in _expr_9)); (2,f) -> u f ((let _expr_8=(u (u (u list_for _wyth_3) _expr_1) (\_defn_8-> (\_expr_9-> (u (u fm_term_app _expr_9) (let _1321 = _defn_8 in (case _1321 of {(0,f) -> u f (\_1322 _1323 _1324 _1325 _1326 _1327-> _1325); })))))) in _expr_8)); (3,f) -> u f (\_1328 _1329 _1330 _1331 _1332-> (let _got_13=(u (u maybe_or (u (u fm_get _1330) _cses_4)) (u (u fm_get "_") _cses_4)) in (let _1333 = _got_13 in (case _1333 of {(0,f) -> u f ((let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (let _1334 = _defn_14 in (case _1334 of {(0,f) -> u f (\_1335 _1336 _1337 _1338 _1339 _1340-> (u (u fm_term_app _expr_15) _1338)); }))))) in _expr_14)); (1,f) -> u f (\_1341-> (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) _wyth_3) _1331) _1341) _defs_6) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _1332 (u (u fm_term_var _1329) 0)) (u (u fm_term_var _1330) 0)) in (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_6) _ctxt_7))))); })))); (4,f) -> u f (\_1342 _1343-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _1344 = _defn_10 in (case _1344 of {(0,f) -> u f (\_1345 _1346 _1347 _1348 _1349 _1350-> _1348); })))))) in _expr_10)); (5,f) -> u f (\_1351 _1352-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _1353 = _defn_10 in (case _1353 of {(0,f) -> u f (\_1354 _1355 _1356 _1357 _1358 _1359-> _1357); })))))) in _expr_10)); (6,f) -> u f (\_1360 _1361 _1362-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _1363 = _defn_11 in (case _1363 of {(0,f) -> u f (\_1364 _1365 _1366 _1367 _1368 _1369-> _1367); })))))) in _expr_11)); (7,f) -> u f (\_1370 _1371 _1372-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _1373 = _defn_11 in (case _1373 of {(0,f) -> u f (\_1374 _1375 _1376 _1377 _1378 _1379-> _1377); })))))) in _expr_11)); (8,f) -> u f (\_1380 _1381 _1382-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _1383 = _defn_11 in (case _1383 of {(0,f) -> u f (\_1384 _1385 _1386 _1387 _1388 _1389-> _1387); })))))) in _expr_11)); (9,f) -> u f (\_1390 _1391 _1392-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _1393 = _defn_11 in (case _1393 of {(0,f) -> u f (\_1394 _1395 _1396 _1397 _1398 _1399-> _1397); })))))) in _expr_11)); (10,f) -> u f (\_1400-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _1401 = _defn_9 in (case _1401 of {(0,f) -> u f (\_1402 _1403 _1404 _1405 _1406 _1407-> _1405); })))))) in _expr_9)); (11,f) -> u f (\_1408-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _1409 = _defn_9 in (case _1409 of {(0,f) -> u f (\_1410 _1411 _1412 _1413 _1414 _1415-> _1413); })))))) in _expr_9)); (12,f) -> u f (\_1416-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _1417 = _defn_9 in (case _1417 of {(0,f) -> u f (\_1418 _1419 _1420 _1421 _1422 _1423-> _1421); })))))) in _expr_9)); (13,f) -> u f (\_1424-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _1425 = _defn_9 in (case _1425 of {(0,f) -> u f (\_1426 _1427 _1428 _1429 _1430 _1431-> _1429); })))))) in _expr_9)); (14,f) -> u f (\_1432 _1433 _1434 _1435 _1436 _1437-> (let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (u (u fm_term_app _expr_15) (let _1438 = _defn_14 in (case _1438 of {(0,f) -> u f (\_1439 _1440 _1441 _1442 _1443 _1444-> _1442); })))))) in _expr_14)); (15,f) -> u f (\_1445 _1446-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _1447 = _defn_10 in (case _1447 of {(0,f) -> u f (\_1448 _1449 _1450 _1451 _1452 _1453-> _1451); })))))) in _expr_10)); })))))))))
fm_term_desugar_cse = (\_expr_1-> (\_name_2-> (\_with_3-> (\_cses_4-> (\_moti_5-> (\_type_6-> (\_defs_7-> (\_ctxt_8-> (let _1454 = (u (u fm_term_reduce _type_6) _defs_7) in (case _1454 of {(0,f) -> u f (\_1455 _1456-> maybe_none); (1,f) -> u f (\_1457-> maybe_none); (2,f) -> u f (maybe_none); (3,f) -> u f (\_1458 _1459 _1460 _1461 _1462-> (let _moti_14=(u (u fm_term_desugar_cse_motive _with_3) _moti_5) in (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) list_nil) _1461) _moti_14) _defs_7) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _1462 (u (u fm_term_var _1459) 0)) (u (u fm_term_var _1460) 0)) in (u maybe_some (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _with_3) _cses_4) _type_17) _defs_7) _ctxt_8))))))); (4,f) -> u f (\_1463 _1464-> maybe_none); (5,f) -> u f (\_1465 _1466-> maybe_none); (6,f) -> u f (\_1467 _1468 _1469-> maybe_none); (7,f) -> u f (\_1470 _1471 _1472-> maybe_none); (8,f) -> u f (\_1473 _1474 _1475-> maybe_none); (9,f) -> u f (\_1476 _1477 _1478-> maybe_none); (10,f) -> u f (\_1479-> maybe_none); (11,f) -> u f (\_1480-> maybe_none); (12,f) -> u f (\_1481-> maybe_none); (13,f) -> u f (\_1482-> maybe_none); (14,f) -> u f (\_1483 _1484 _1485 _1486 _1487 _1488-> maybe_none); (15,f) -> u f (\_1489 _1490-> maybe_none); }))))))))))
fm_error_patch = (\_path_1-> (\_term_2-> (4,\t-> t _path_1 _term_2)))
fm_mpath_to_bits = (\_path_1-> (let _1491 = _path_1 in (case _1491 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_1492-> (u _1492 bits_e)); })))
set_has = (\_bits_1-> (\_set_2-> (let _1493 = (u (u map_get _bits_1) _set_2) in (case _1493 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_1494-> bool_true); }))))
fm_term_equal_patch = (\_path_2-> (\_term_3-> (\_ret_4-> (u (u fm_check_result (u maybe_some _ret_4)) (u (u list_cons (u (u fm_error_patch _path_2) (u (u fm_term_normalize _term_3) map_new))) list_nil)))))
fm_term_equal_extra_holes = (\_a_1-> (\_b_2-> (let _1495 = _a_1 in (case _1495 of {(0,f) -> u f (\_1496 _1497-> (let _1498 = _b_2 in (case _1498 of {(0,f) -> u f (\_1499 _1500-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1501-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1502 _1503 _1504 _1505 _1506-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1507 _1508-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1509 _1510-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1511 _1512 _1513-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1514 _1515 _1516-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1517 _1518 _1519-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1520 _1521 _1522-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1523-> (u (u (u fm_term_equal_patch _1523) _a_1) unit_new)); (11,f) -> u f (\_1524-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1525-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1526-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1527 _1528 _1529 _1530 _1531 _1532-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1533 _1534-> (u (u fm_term_equal_extra_holes _a_1) _1534)); }))); (1,f) -> u f (\_1535-> (let _1536 = _b_2 in (case _1536 of {(0,f) -> u f (\_1537 _1538-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1539-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1540 _1541 _1542 _1543 _1544-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1545 _1546-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1547 _1548-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1549 _1550 _1551-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1552 _1553 _1554-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1555 _1556 _1557-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1558 _1559 _1560-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1561-> (u (u (u fm_term_equal_patch _1561) _a_1) unit_new)); (11,f) -> u f (\_1562-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1563-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1564-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1565 _1566 _1567 _1568 _1569 _1570-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1571 _1572-> (u (u fm_term_equal_extra_holes _a_1) _1572)); }))); (2,f) -> u f ((let _1573 = _b_2 in (case _1573 of {(0,f) -> u f (\_1574 _1575-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1576-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1577 _1578 _1579 _1580 _1581-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1582 _1583-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1584 _1585-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1586 _1587 _1588-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1589 _1590 _1591-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1592 _1593 _1594-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1595 _1596 _1597-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1598-> (u (u (u fm_term_equal_patch _1598) _a_1) unit_new)); (11,f) -> u f (\_1599-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1600-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1601-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1602 _1603 _1604 _1605 _1606 _1607-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1608 _1609-> (u (u fm_term_equal_extra_holes _a_1) _1609)); }))); (3,f) -> u f (\_1610 _1611 _1612 _1613 _1614-> (let _1615 = _b_2 in (case _1615 of {(0,f) -> u f (\_1616 _1617-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1618-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1619 _1620 _1621 _1622 _1623-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1624 _1625-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1626 _1627-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1628 _1629 _1630-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1631 _1632 _1633-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1634 _1635 _1636-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1637 _1638 _1639-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1640-> (u (u (u fm_term_equal_patch _1640) _a_1) unit_new)); (11,f) -> u f (\_1641-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1642-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1643-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1644 _1645 _1646 _1647 _1648 _1649-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1650 _1651-> (u (u fm_term_equal_extra_holes _a_1) _1651)); }))); (4,f) -> u f (\_1652 _1653-> (let _1654 = _b_2 in (case _1654 of {(0,f) -> u f (\_1655 _1656-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1657-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1658 _1659 _1660 _1661 _1662-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1663 _1664-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1665 _1666-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1667 _1668 _1669-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1670 _1671 _1672-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1673 _1674 _1675-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1676 _1677 _1678-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1679-> (u (u (u fm_term_equal_patch _1679) _a_1) unit_new)); (11,f) -> u f (\_1680-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1681-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1682-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1683 _1684 _1685 _1686 _1687 _1688-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1689 _1690-> (u (u fm_term_equal_extra_holes _a_1) _1690)); }))); (5,f) -> u f (\_1691 _1692-> (let _1693 = _b_2 in (case _1693 of {(0,f) -> u f (\_1694 _1695-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1696-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1697 _1698 _1699 _1700 _1701-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1702 _1703-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1704 _1705-> (u (u (u monad_bind fm_check_monad) (u (u fm_term_equal_extra_holes _1691) _1704)) (\__7-> (u (u fm_term_equal_extra_holes _1692) _1705)))); (6,f) -> u f (\_1706 _1707 _1708-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1709 _1710 _1711-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1712 _1713 _1714-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1715 _1716 _1717-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1718-> (u (u (u fm_term_equal_patch _1718) _a_1) unit_new)); (11,f) -> u f (\_1719-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1720-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1721-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1722 _1723 _1724 _1725 _1726 _1727-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1728 _1729-> (u (u fm_term_equal_extra_holes _a_1) _1729)); }))); (6,f) -> u f (\_1730 _1731 _1732-> (let _1733 = _b_2 in (case _1733 of {(0,f) -> u f (\_1734 _1735-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1736-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1737 _1738 _1739 _1740 _1741-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1742 _1743-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1744 _1745-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1746 _1747 _1748-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1749 _1750 _1751-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1752 _1753 _1754-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1755 _1756 _1757-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1758-> (u (u (u fm_term_equal_patch _1758) _a_1) unit_new)); (11,f) -> u f (\_1759-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1760-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1761-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1762 _1763 _1764 _1765 _1766 _1767-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1768 _1769-> (u (u fm_term_equal_extra_holes _a_1) _1769)); }))); (7,f) -> u f (\_1770 _1771 _1772-> (let _1773 = _b_2 in (case _1773 of {(0,f) -> u f (\_1774 _1775-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1776-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1777 _1778 _1779 _1780 _1781-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1782 _1783-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1784 _1785-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1786 _1787 _1788-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1789 _1790 _1791-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1792 _1793 _1794-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1795 _1796 _1797-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1798-> (u (u (u fm_term_equal_patch _1798) _a_1) unit_new)); (11,f) -> u f (\_1799-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1800-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1801-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1802 _1803 _1804 _1805 _1806 _1807-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1808 _1809-> (u (u fm_term_equal_extra_holes _a_1) _1809)); }))); (8,f) -> u f (\_1810 _1811 _1812-> (let _1813 = _b_2 in (case _1813 of {(0,f) -> u f (\_1814 _1815-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1816-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1817 _1818 _1819 _1820 _1821-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1822 _1823-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1824 _1825-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1826 _1827 _1828-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1829 _1830 _1831-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1832 _1833 _1834-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1835 _1836 _1837-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1838-> (u (u (u fm_term_equal_patch _1838) _a_1) unit_new)); (11,f) -> u f (\_1839-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1840-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1841-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1842 _1843 _1844 _1845 _1846 _1847-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1848 _1849-> (u (u fm_term_equal_extra_holes _a_1) _1849)); }))); (9,f) -> u f (\_1850 _1851 _1852-> (let _1853 = _b_2 in (case _1853 of {(0,f) -> u f (\_1854 _1855-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1856-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1857 _1858 _1859 _1860 _1861-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1862 _1863-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1864 _1865-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1866 _1867 _1868-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1869 _1870 _1871-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1872 _1873 _1874-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1875 _1876 _1877-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1878-> (u (u (u fm_term_equal_patch _1878) _a_1) unit_new)); (11,f) -> u f (\_1879-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1880-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1881-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1882 _1883 _1884 _1885 _1886 _1887-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1888 _1889-> (u (u fm_term_equal_extra_holes _a_1) _1889)); }))); (10,f) -> u f (\_1890-> (u (u (u fm_term_equal_patch _1890) _b_2) unit_new)); (11,f) -> u f (\_1891-> (let _1892 = _b_2 in (case _1892 of {(0,f) -> u f (\_1893 _1894-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1895-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1896 _1897 _1898 _1899 _1900-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1901 _1902-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1903 _1904-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1905 _1906 _1907-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1908 _1909 _1910-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1911 _1912 _1913-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1914 _1915 _1916-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1917-> (u (u (u fm_term_equal_patch _1917) _a_1) unit_new)); (11,f) -> u f (\_1918-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1919-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1920-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1921 _1922 _1923 _1924 _1925 _1926-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1927 _1928-> (u (u fm_term_equal_extra_holes _a_1) _1928)); }))); (12,f) -> u f (\_1929-> (let _1930 = _b_2 in (case _1930 of {(0,f) -> u f (\_1931 _1932-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1933-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1934 _1935 _1936 _1937 _1938-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1939 _1940-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1941 _1942-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1943 _1944 _1945-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1946 _1947 _1948-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1949 _1950 _1951-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1952 _1953 _1954-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1955-> (u (u (u fm_term_equal_patch _1955) _a_1) unit_new)); (11,f) -> u f (\_1956-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1957-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1958-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1959 _1960 _1961 _1962 _1963 _1964-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_1965 _1966-> (u (u fm_term_equal_extra_holes _a_1) _1966)); }))); (13,f) -> u f (\_1967-> (let _1968 = _b_2 in (case _1968 of {(0,f) -> u f (\_1969 _1970-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_1971-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_1972 _1973 _1974 _1975 _1976-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_1977 _1978-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_1979 _1980-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_1981 _1982 _1983-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_1984 _1985 _1986-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_1987 _1988 _1989-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_1990 _1991 _1992-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_1993-> (u (u (u fm_term_equal_patch _1993) _a_1) unit_new)); (11,f) -> u f (\_1994-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_1995-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_1996-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_1997 _1998 _1999 _2000 _2001 _2002-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_2003 _2004-> (u (u fm_term_equal_extra_holes _a_1) _2004)); }))); (14,f) -> u f (\_2005 _2006 _2007 _2008 _2009 _2010-> (let _2011 = _b_2 in (case _2011 of {(0,f) -> u f (\_2012 _2013-> (u (u monad_pure fm_check_monad) unit_new)); (1,f) -> u f (\_2014-> (u (u monad_pure fm_check_monad) unit_new)); (2,f) -> u f ((u (u monad_pure fm_check_monad) unit_new)); (3,f) -> u f (\_2015 _2016 _2017 _2018 _2019-> (u (u monad_pure fm_check_monad) unit_new)); (4,f) -> u f (\_2020 _2021-> (u (u monad_pure fm_check_monad) unit_new)); (5,f) -> u f (\_2022 _2023-> (u (u monad_pure fm_check_monad) unit_new)); (6,f) -> u f (\_2024 _2025 _2026-> (u (u monad_pure fm_check_monad) unit_new)); (7,f) -> u f (\_2027 _2028 _2029-> (u (u monad_pure fm_check_monad) unit_new)); (8,f) -> u f (\_2030 _2031 _2032-> (u (u monad_pure fm_check_monad) unit_new)); (9,f) -> u f (\_2033 _2034 _2035-> (u (u monad_pure fm_check_monad) unit_new)); (10,f) -> u f (\_2036-> (u (u (u fm_term_equal_patch _2036) _a_1) unit_new)); (11,f) -> u f (\_2037-> (u (u monad_pure fm_check_monad) unit_new)); (12,f) -> u f (\_2038-> (u (u monad_pure fm_check_monad) unit_new)); (13,f) -> u f (\_2039-> (u (u monad_pure fm_check_monad) unit_new)); (14,f) -> u f (\_2040 _2041 _2042 _2043 _2044 _2045-> (u (u monad_pure fm_check_monad) unit_new)); (15,f) -> u f (\_2046 _2047-> (u (u fm_term_equal_extra_holes _a_1) _2047)); }))); (15,f) -> u f (\_2048 _2049-> (u (u fm_term_equal_extra_holes _2049) _b_2)); }))))
set_set = (\_bits_1-> (\_set_2-> (u (u (u map_set _bits_1) unit_new) _set_2)))
bool_eql = (\_a_1-> (\_b_2-> (let _2050 = _a_1 in (if _2050 then _b_2 else ((not _b_2))))))
fm_term_equal = (\_a_1-> (\_b_2-> (\_defs_3-> (\_lv_4-> (\_seen_5-> (let _ah_6=(u (u (u (u fm_term_serialize (u (u fm_term_reduce _a_1) map_new)) _lv_4) _lv_4) bits_e) in (let _bh_7=(u (u (u (u fm_term_serialize (u (u fm_term_reduce _b_2) map_new)) _lv_4) _lv_4) bits_e) in (let _2051 = (u (u bits_eql _ah_6) _bh_7) in (if _2051 then (u (u monad_pure fm_check_monad) bool_true) else (let _a1_8=(u (u fm_term_reduce _a_1) _defs_3) in (let _b1_9=(u (u fm_term_reduce _b_2) _defs_3) in (let _ah_10=(u (u (u (u fm_term_serialize _a1_8) _lv_4) _lv_4) bits_e) in (let _bh_11=(u (u (u (u fm_term_serialize _b1_9) _lv_4) _lv_4) bits_e) in (let _2052 = (u (u bits_eql _ah_10) _bh_11) in (if _2052 then (u (u monad_pure fm_check_monad) bool_true) else (let _id_12=(u (u bits_concat _ah_10) _bh_11) in (let _2053 = (u (u set_has _id_12) _seen_5) in (if _2053 then (u (u (u monad_bind fm_check_monad) (u (u fm_term_equal_extra_holes _a_1) _b_2)) (\__13-> (u (u monad_pure fm_check_monad) bool_true))) else (let _2054 = _a1_8 in (case _2054 of {(0,f) -> u f (\_2055 _2056-> (let _2057 = _b1_9 in (case _2057 of {(0,f) -> u f (\_2058 _2059-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2060-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2061 _2062 _2063 _2064 _2065-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2066 _2067-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2068 _2069-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2070 _2071 _2072-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2073 _2074 _2075-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2076 _2077 _2078-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2079 _2080 _2081-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2082-> (u (u (u fm_term_equal_patch _2082) _a_1) bool_true)); (11,f) -> u f (\_2083-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2084-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2085-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2086 _2087 _2088 _2089 _2090 _2091-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2092 _2093-> (u (u monad_pure fm_check_monad) bool_false)); }))); (1,f) -> u f (\_2094-> (let _2095 = _b1_9 in (case _2095 of {(0,f) -> u f (\_2096 _2097-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2098-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2099 _2100 _2101 _2102 _2103-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2104 _2105-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2106 _2107-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2108 _2109 _2110-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2111 _2112 _2113-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2114 _2115 _2116-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2117 _2118 _2119-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2120-> (u (u (u fm_term_equal_patch _2120) _a_1) bool_true)); (11,f) -> u f (\_2121-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2122-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2123-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2124 _2125 _2126 _2127 _2128 _2129-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2130 _2131-> (u (u monad_pure fm_check_monad) bool_false)); }))); (2,f) -> u f ((let _2132 = _b1_9 in (case _2132 of {(0,f) -> u f (\_2133 _2134-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2135-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2136 _2137 _2138 _2139 _2140-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2141 _2142-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2143 _2144-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2145 _2146 _2147-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2148 _2149 _2150-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2151 _2152 _2153-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2154 _2155 _2156-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2157-> (u (u (u fm_term_equal_patch _2157) _a_1) bool_true)); (11,f) -> u f (\_2158-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2159-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2160-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2161 _2162 _2163 _2164 _2165 _2166-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2167 _2168-> (u (u monad_pure fm_check_monad) bool_false)); }))); (3,f) -> u f (\_2169 _2170 _2171 _2172 _2173-> (let _2174 = _b1_9 in (case _2174 of {(0,f) -> u f (\_2175 _2176-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2177-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2178 _2179 _2180 _2181 _2182-> (let _seen_23=(u (u set_set _id_12) _seen_5) in (let _a1_body_24=(u (u _2173 (u (u fm_term_var _2170) _lv_4)) (u (u fm_term_var _2171) (u nat_succ _lv_4))) in (let _b1_body_25=(u (u _2182 (u (u fm_term_var _2179) _lv_4)) (u (u fm_term_var _2180) (u nat_succ _lv_4))) in (let _eq_self_26=(((_2170::String) == _2179)) in (let _eq_eras_27=(u (u bool_eql _2169) _2178) in (let _2183 = ((_eq_self_26 && _eq_eras_27)) in (if _2183 then (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _2172) _2181) _defs_3) _lv_4) _seen_23)) (\_eq_type_28-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _a1_body_24) _b1_body_25) _defs_3) (u nat_succ (u nat_succ _lv_4))) _seen_23)) (\_eq_body_29-> (u (u monad_pure fm_check_monad) ((_eq_type_28 && _eq_body_29))))))) else (u (u monad_pure fm_check_monad) bool_false))))))))); (4,f) -> u f (\_2184 _2185-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2186 _2187-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2188 _2189 _2190-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2191 _2192 _2193-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2194 _2195 _2196-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2197 _2198 _2199-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2200-> (u (u (u fm_term_equal_patch _2200) _a_1) bool_true)); (11,f) -> u f (\_2201-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2202-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2203-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2204 _2205 _2206 _2207 _2208 _2209-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2210 _2211-> (u (u monad_pure fm_check_monad) bool_false)); }))); (4,f) -> u f (\_2212 _2213-> (let _2214 = _b1_9 in (case _2214 of {(0,f) -> u f (\_2215 _2216-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2217-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2218 _2219 _2220 _2221 _2222-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2223 _2224-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _a1_body_18=(u _2213 (u (u fm_term_var _2212) _lv_4)) in (let _b1_body_19=(u _2224 (u (u fm_term_var _2223) _lv_4)) in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _a1_body_18) _b1_body_19) _defs_3) (u nat_succ _lv_4)) _seen_17)) (\_eq_body_20-> (u (u monad_pure fm_check_monad) _eq_body_20))))))); (5,f) -> u f (\_2225 _2226-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2227 _2228 _2229-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2230 _2231 _2232-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2233 _2234 _2235-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2236 _2237 _2238-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2239-> (u (u (u fm_term_equal_patch _2239) _a_1) bool_true)); (11,f) -> u f (\_2240-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2241-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2242-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2243 _2244 _2245 _2246 _2247 _2248-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2249 _2250-> (u (u monad_pure fm_check_monad) bool_false)); }))); (5,f) -> u f (\_2251 _2252-> (let _2253 = _b1_9 in (case _2253 of {(0,f) -> u f (\_2254 _2255-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2256-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2257 _2258 _2259 _2260 _2261-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2262 _2263-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2264 _2265-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _2251) _2264) _defs_3) _lv_4) _seen_17)) (\_eq_func_18-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _2252) _2265) _defs_3) _lv_4) _seen_17)) (\_eq_argm_19-> (u (u monad_pure fm_check_monad) ((_eq_func_18 && _eq_argm_19))))))))); (6,f) -> u f (\_2266 _2267 _2268-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2269 _2270 _2271-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2272 _2273 _2274-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2275 _2276 _2277-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2278-> (u (u (u fm_term_equal_patch _2278) _a_1) bool_true)); (11,f) -> u f (\_2279-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2280-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2281-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2282 _2283 _2284 _2285 _2286 _2287-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2288 _2289-> (u (u monad_pure fm_check_monad) bool_false)); }))); (6,f) -> u f (\_2290 _2291 _2292-> (let _2293 = _b1_9 in (case _2293 of {(0,f) -> u f (\_2294 _2295-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2296-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2297 _2298 _2299 _2300 _2301-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2302 _2303-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2304 _2305-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2306 _2307 _2308-> (let _seen_19=(u (u set_set _id_12) _seen_5) in (let _a1_body_20=(u _2292 (u (u fm_term_var _2290) _lv_4)) in (let _b1_body_21=(u _2308 (u (u fm_term_var _2306) _lv_4)) in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _2291) _2307) _defs_3) _lv_4) _seen_19)) (\_eq_expr_22-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _a1_body_20) _b1_body_21) _defs_3) (u nat_succ _lv_4)) _seen_19)) (\_eq_body_23-> (u (u monad_pure fm_check_monad) ((_eq_expr_22 && _eq_body_23))))))))))); (7,f) -> u f (\_2309 _2310 _2311-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2312 _2313 _2314-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2315 _2316 _2317-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2318-> (u (u (u fm_term_equal_patch _2318) _a_1) bool_true)); (11,f) -> u f (\_2319-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2320-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2321-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2322 _2323 _2324 _2325 _2326 _2327-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2328 _2329-> (u (u monad_pure fm_check_monad) bool_false)); }))); (7,f) -> u f (\_2330 _2331 _2332-> (let _2333 = _b1_9 in (case _2333 of {(0,f) -> u f (\_2334 _2335-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2336-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2337 _2338 _2339 _2340 _2341-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2342 _2343-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2344 _2345-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2346 _2347 _2348-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2349 _2350 _2351-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2352 _2353 _2354-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2355 _2356 _2357-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2358-> (u (u (u fm_term_equal_patch _2358) _a_1) bool_true)); (11,f) -> u f (\_2359-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2360-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2361-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2362 _2363 _2364 _2365 _2366 _2367-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2368 _2369-> (u (u monad_pure fm_check_monad) bool_false)); }))); (8,f) -> u f (\_2370 _2371 _2372-> (let _2373 = _b1_9 in (case _2373 of {(0,f) -> u f (\_2374 _2375-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2376-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2377 _2378 _2379 _2380 _2381-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2382 _2383-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2384 _2385-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2386 _2387 _2388-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2389 _2390 _2391-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2392 _2393 _2394-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2395 _2396 _2397-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2398-> (u (u (u fm_term_equal_patch _2398) _a_1) bool_true)); (11,f) -> u f (\_2399-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2400-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2401-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2402 _2403 _2404 _2405 _2406 _2407-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2408 _2409-> (u (u monad_pure fm_check_monad) bool_false)); }))); (9,f) -> u f (\_2410 _2411 _2412-> (let _2413 = _b1_9 in (case _2413 of {(0,f) -> u f (\_2414 _2415-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2416-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2417 _2418 _2419 _2420 _2421-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2422 _2423-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2424 _2425-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2426 _2427 _2428-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2429 _2430 _2431-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2432 _2433 _2434-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2435 _2436 _2437-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2438-> (u (u (u fm_term_equal_patch _2438) _a_1) bool_true)); (11,f) -> u f (\_2439-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2440-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2441-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2442 _2443 _2444 _2445 _2446 _2447-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2448 _2449-> (u (u monad_pure fm_check_monad) bool_false)); }))); (10,f) -> u f (\_2450-> (u (u (u fm_term_equal_patch _2450) _b_2) bool_true)); (11,f) -> u f (\_2451-> (let _2452 = _b1_9 in (case _2452 of {(0,f) -> u f (\_2453 _2454-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2455-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2456 _2457 _2458 _2459 _2460-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2461 _2462-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2463 _2464-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2465 _2466 _2467-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2468 _2469 _2470-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2471 _2472 _2473-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2474 _2475 _2476-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2477-> (u (u (u fm_term_equal_patch _2477) _a_1) bool_true)); (11,f) -> u f (\_2478-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2479-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2480-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2481 _2482 _2483 _2484 _2485 _2486-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2487 _2488-> (u (u monad_pure fm_check_monad) bool_false)); }))); (12,f) -> u f (\_2489-> (let _2490 = _b1_9 in (case _2490 of {(0,f) -> u f (\_2491 _2492-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2493-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2494 _2495 _2496 _2497 _2498-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2499 _2500-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2501 _2502-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2503 _2504 _2505-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2506 _2507 _2508-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2509 _2510 _2511-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2512 _2513 _2514-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2515-> (u (u (u fm_term_equal_patch _2515) _a_1) bool_true)); (11,f) -> u f (\_2516-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2517-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2518-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2519 _2520 _2521 _2522 _2523 _2524-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2525 _2526-> (u (u monad_pure fm_check_monad) bool_false)); }))); (13,f) -> u f (\_2527-> (let _2528 = _b1_9 in (case _2528 of {(0,f) -> u f (\_2529 _2530-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2531-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2532 _2533 _2534 _2535 _2536-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2537 _2538-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2539 _2540-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2541 _2542 _2543-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2544 _2545 _2546-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2547 _2548 _2549-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2550 _2551 _2552-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2553-> (u (u (u fm_term_equal_patch _2553) _a_1) bool_true)); (11,f) -> u f (\_2554-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2555-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2556-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2557 _2558 _2559 _2560 _2561 _2562-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2563 _2564-> (u (u monad_pure fm_check_monad) bool_false)); }))); (14,f) -> u f (\_2565 _2566 _2567 _2568 _2569 _2570-> (let _2571 = _b1_9 in (case _2571 of {(0,f) -> u f (\_2572 _2573-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2574-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2575 _2576 _2577 _2578 _2579-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2580 _2581-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2582 _2583-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2584 _2585 _2586-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2587 _2588 _2589-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2590 _2591 _2592-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2593 _2594 _2595-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2596-> (u (u (u fm_term_equal_patch _2596) _a_1) bool_true)); (11,f) -> u f (\_2597-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2598-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2599-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2600 _2601 _2602 _2603 _2604 _2605-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2606 _2607-> (u (u monad_pure fm_check_monad) bool_false)); }))); (15,f) -> u f (\_2608 _2609-> (let _2610 = _b1_9 in (case _2610 of {(0,f) -> u f (\_2611 _2612-> (u (u monad_pure fm_check_monad) bool_false)); (1,f) -> u f (\_2613-> (u (u monad_pure fm_check_monad) bool_false)); (2,f) -> u f ((u (u monad_pure fm_check_monad) bool_false)); (3,f) -> u f (\_2614 _2615 _2616 _2617 _2618-> (u (u monad_pure fm_check_monad) bool_false)); (4,f) -> u f (\_2619 _2620-> (u (u monad_pure fm_check_monad) bool_false)); (5,f) -> u f (\_2621 _2622-> (u (u monad_pure fm_check_monad) bool_false)); (6,f) -> u f (\_2623 _2624 _2625-> (u (u monad_pure fm_check_monad) bool_false)); (7,f) -> u f (\_2626 _2627 _2628-> (u (u monad_pure fm_check_monad) bool_false)); (8,f) -> u f (\_2629 _2630 _2631-> (u (u monad_pure fm_check_monad) bool_false)); (9,f) -> u f (\_2632 _2633 _2634-> (u (u monad_pure fm_check_monad) bool_false)); (10,f) -> u f (\_2635-> (u (u (u fm_term_equal_patch _2635) _a_1) bool_true)); (11,f) -> u f (\_2636-> (u (u monad_pure fm_check_monad) bool_false)); (12,f) -> u f (\_2637-> (u (u monad_pure fm_check_monad) bool_false)); (13,f) -> u f (\_2638-> (u (u monad_pure fm_check_monad) bool_false)); (14,f) -> u f (\_2639 _2640 _2641 _2642 _2643 _2644-> (u (u monad_pure fm_check_monad) bool_false)); (15,f) -> u f (\_2645 _2646-> (u (u monad_pure fm_check_monad) bool_false)); }))); }))))))))))))))))))))
set_new = map_new
fm_term_check = (\_term_1-> (\_type_2-> (\_defs_3-> (\_ctx_4-> (\_path_5-> (\_orig_6-> (u (u (u monad_bind fm_check_monad) (let _2647 = _term_1 in (case _2647 of {(0,f) -> u f (\_2648 _2649-> (let _2650 = (u (u list_at_last _2649) _ctx_4) in (case _2650 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _2648)) list_nil))); (1,f) -> u f (\_2651-> (u (u monad_pure fm_check_monad) (let _2652 = _2651 in (case _2652 of {(0,f) -> u f (\_2653 _2654-> _2654); })))); }))); (1,f) -> u f (\_2655-> (let _2656 = (u (u fm_get _2655) _defs_3) in (case _2656 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _2655)) list_nil))); (1,f) -> u f (\_2657-> (let _2658 = _2657 in (case _2658 of {(0,f) -> u f (\_2659 _2660 _2661 _2662 _2663 _2664-> (let _ref_name_15=_2661 in (let _ref_type_16=_2663 in (let _ref_term_17=_2662 in (let _ref_stat_18=_2664 in (let _2665 = _ref_stat_18 in (case _2665 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_waiting _ref_name_15)) list_nil))); (1,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (3,f) -> u f (\_2666-> (u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_indirect _ref_name_15)) list_nil))); }))))))); }))); }))); (2,f) -> u f ((u (u monad_pure fm_check_monad) fm_term_typ)); (3,f) -> u f (\_2667 _2668 _2669 _2670 _2671-> (let _ctx_size_12=(u list_length _ctx_4) in (let _self_var_13=(u (u fm_term_var _2668) _ctx_size_12) in (let _body_var_14=(u (u fm_term_var _2669) (u nat_succ _ctx_size_12)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _2669) _2670)) (u (u list_cons (u (u pair_new _2668) _term_1)) _ctx_4)) in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _2670) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6)) (\__16-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check (u (u _2671 _self_var_13) _body_var_14)) (u maybe_some fm_term_typ)) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6)) (\__17-> (u (u monad_pure fm_check_monad) fm_term_typ)))))))))); (4,f) -> u f (\_2672 _2673-> (let _2674 = _type_2 in (case _2674 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_2675-> (let _typv_10=(u (u fm_term_reduce _2675) _defs_3) in (let _2676 = _typv_10 in (case _2676 of {(0,f) -> u f (\_2677 _2678-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_2679-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "Function") in (let _detected_12=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_2680 _2681 _2682 _2683 _2684-> (let _ctx_size_16=(u list_length _ctx_4) in (let _self_var_17=_term_1 in (let _body_var_18=(u (u fm_term_var _2672) _ctx_size_16) in (let _body_typ_19=(u (u _2684 _self_var_17) _body_var_18) in (let _body_ctx_20=(u (u list_cons (u (u pair_new _2672) _2683)) _ctx_4) in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check (u _2673 _body_var_18)) (u maybe_some _body_typ_19)) _defs_3) _body_ctx_20) (u fm_mpath_o _path_5)) _orig_6)) (\__21-> (u (u monad_pure fm_check_monad) _2675))))))))); (4,f) -> u f (\_2685 _2686-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_2687 _2688-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_2689 _2690 _2691-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_2692 _2693 _2694-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_2695 _2696 _2697-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_2698 _2699 _2700-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_2701-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_2702-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_2703-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_2704-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_2705 _2706 _2707 _2708 _2709 _2710-> (let _expected_17=(u either_left "Function") in (let _detected_18=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_2711 _2712-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _2675) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))); }))); (5,f) -> u f (\_2713 _2714-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _2713) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6)) (\_func_typ_9-> (let _func_typ_10=(u (u fm_term_reduce _func_typ_9) _defs_3) in (let _2715 = _func_typ_10 in (case _2715 of {(0,f) -> u f (\_2716 _2717-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_2718-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "Function") in (let _detected_12=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_2719 _2720 _2721 _2722 _2723-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _2714) (u maybe_some _2722)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6)) (\__16-> (u (u monad_pure fm_check_monad) (u (u _2723 _2713) _2714))))); (4,f) -> u f (\_2724 _2725-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_2726 _2727-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_2728 _2729 _2730-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_2731 _2732 _2733-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_2734 _2735 _2736-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_2737 _2738 _2739-> (let _expected_14=(u either_left "Function") in (let _detected_15=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_2740-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_2741-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_2742-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_2743-> (let _expected_12=(u either_left "Function") in (let _detected_13=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_2744 _2745 _2746 _2747 _2748 _2749-> (let _expected_17=(u either_left "Function") in (let _detected_18=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_2750 _2751-> (let _expected_13=(u either_left "Function") in (let _detected_14=(u either_right _func_typ_10) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))))); (6,f) -> u f (\_2752 _2753 _2754-> (let _ctx_size_10=(u list_length _ctx_4) in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _2753) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6)) (\_expr_typ_11-> (let _body_val_12=(u _2754 (u (u fm_term_var _2752) _ctx_size_10)) in (let _body_ctx_13=(u (u list_cons (u (u pair_new _2752) _expr_typ_11)) _ctx_4) in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _body_val_12) _type_2) _defs_3) _body_ctx_13) (u fm_mpath_i _path_5)) _orig_6)) (\_body_typ_14-> (u (u monad_pure fm_check_monad) _body_typ_14))))))))); (7,f) -> u f (\_2755 _2756 _2757-> (u (u (u (u (u (u fm_term_check (u _2757 _2756)) _type_2) _defs_3) _ctx_4) _path_5) _orig_6)); (8,f) -> u f (\_2758 _2759 _2760-> (let _2761 = _2758 in (if _2761 then (u (u monad_pure fm_check_monad) _2760) else (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _2759) (u maybe_some _2760)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6)) (\__10-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _2760) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6)) (\__11-> (u (u monad_pure fm_check_monad) _2760)))))))); (9,f) -> u f (\_2762 _2763 _2764-> (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u (u fm_error_show_goal _2762) _2763) _2764) _type_2) _ctx_4)) list_nil))); (10,f) -> u f (\_2765-> (u (u fm_check_result _type_2) list_nil)); (11,f) -> u f (\_2766-> (u (u monad_pure fm_check_monad) (u fm_term_ref "Nat"))); (12,f) -> u f (\_2767-> (u (u monad_pure fm_check_monad) (u fm_term_ref "Char"))); (13,f) -> u f (\_2768-> (u (u monad_pure fm_check_monad) (u fm_term_ref "String"))); (14,f) -> u f (\_2769 _2770 _2771 _2772 _2773 _2774-> (let _expr_13=_2770 in (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _expr_13) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6)) (\_etyp_14-> (let _dsug_15=(let _2775 = _2774 in (case _2775 of {(0,f) -> u f ((let _moti_15=(let _2776 = _type_2 in (case _2776 of {(0,f) -> u f ((u fm_term_hol bits_e)); (1,f) -> u f (\_2777-> (let _size_16=(u list_length _ctx_4) in (let _typv_17=(u (u fm_term_normalize _2777) map_new) in (let _moti_18=(u (u (u (u (u (u fm_smartmotive_make _2771) _2770) _etyp_14) _typv_17) _size_16) _defs_3) in _moti_18)))); })) in (u maybe_some (u (u (u (u (u (u fm_term_cse _2769) _2770) _2771) _2772) _2773) (u maybe_some _moti_15))))); (1,f) -> u f (\_2778-> (u (u (u (u (u (u (u (u fm_term_desugar_cse _2770) _2771) _2772) _2773) _2778) _etyp_14) _defs_3) _ctx_4)); })) in (let _2779 = _dsug_15 in (case _2779 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_2780-> (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _2780)) list_nil))); }))))))); (15,f) -> u f (\_2781 _2782-> (u (u (u (u (u (u fm_term_check _2782) _type_2) _defs_3) _ctx_4) _path_5) (u maybe_some _2781))); }))) (\_infr_7-> (let _2783 = _type_2 in (case _2783 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _infr_7)) list_nil)); (1,f) -> u f (\_2784-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u fm_term_equal _2784) _infr_7) _defs_3) (u list_length _ctx_4)) set_new)) (\_eqls_9-> (let _2785 = _eqls_9 in (if _2785 then (u (u monad_pure fm_check_monad) _2784) else (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) (u either_right _2784)) (u either_right _infr_7)) _ctx_4)) list_nil))))))); }))))))))))
fm_path_nil = (\_x_1-> _x_1)
fm_mpath_nil = (u maybe_some fm_path_nil)
list_is_empty = (\_list_2-> (let _2786 = _list_2 in (case _2786 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_2787 _2788-> bool_false); })))
fm_term_patch_at = (\_path_1-> (\_term_2-> (\_fn_3-> (let _2789 = _term_2 in (case _2789 of {(0,f) -> u f (\_2790 _2791-> (let _2792 = _path_1 in (case _2792 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2793-> _term_2); (2,f) -> u f (\_2794-> _term_2); }))); (1,f) -> u f (\_2795-> (let _2796 = _path_1 in (case _2796 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2797-> _term_2); (2,f) -> u f (\_2798-> _term_2); }))); (2,f) -> u f ((let _2799 = _path_1 in (case _2799 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2800-> _term_2); (2,f) -> u f (\_2801-> _term_2); }))); (3,f) -> u f (\_2802 _2803 _2804 _2805 _2806-> (let _2807 = _path_1 in (case _2807 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2808-> (u (u (u (u (u fm_term_all _2802) _2803) _2804) (u (u (u fm_term_patch_at _2808) _2805) _fn_3)) _2806)); (2,f) -> u f (\_2809-> (u (u (u (u (u fm_term_all _2802) _2803) _2804) _2805) (\_s_10-> (\_x_11-> (u (u (u fm_term_patch_at _2809) (u (u _2806 _s_10) _x_11)) _fn_3))))); }))); (4,f) -> u f (\_2810 _2811-> (let _2812 = _path_1 in (case _2812 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2813-> (u (u fm_term_lam _2810) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _2811 _x_7)) _fn_3)))); (2,f) -> u f (\_2814-> (u (u fm_term_lam _2810) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _2811 _x_7)) _fn_3)))); }))); (5,f) -> u f (\_2815 _2816-> (let _2817 = _path_1 in (case _2817 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2818-> (u (u fm_term_app (u (u (u fm_term_patch_at _2818) _2815) _fn_3)) _2816)); (2,f) -> u f (\_2819-> (u (u fm_term_app _2815) (u (u (u fm_term_patch_at _2819) _2816) _fn_3))); }))); (6,f) -> u f (\_2820 _2821 _2822-> (let _2823 = _path_1 in (case _2823 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2824-> (u (u (u fm_term_let _2820) (u (u (u fm_term_patch_at _2824) _2821) _fn_3)) _2822)); (2,f) -> u f (\_2825-> (u (u (u fm_term_let _2820) _2821) (\_x_8-> (u (u (u fm_term_patch_at _2825) (u _2822 _x_8)) _fn_3)))); }))); (7,f) -> u f (\_2826 _2827 _2828-> (let _2829 = _path_1 in (case _2829 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2830-> (u (u (u fm_term_def _2826) (u (u (u fm_term_patch_at _2830) _2827) _fn_3)) _2828)); (2,f) -> u f (\_2831-> (u (u (u fm_term_def _2826) _2827) (\_x_8-> (u (u (u fm_term_patch_at _2831) (u _2828 _x_8)) _fn_3)))); }))); (8,f) -> u f (\_2832 _2833 _2834-> (let _2835 = _path_1 in (case _2835 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2836-> (u (u (u fm_term_ann _2832) (u (u (u fm_term_patch_at _path_1) _2833) _fn_3)) _2834)); (2,f) -> u f (\_2837-> (u (u (u fm_term_ann _2832) (u (u (u fm_term_patch_at _path_1) _2833) _fn_3)) _2834)); }))); (9,f) -> u f (\_2838 _2839 _2840-> (let _2841 = _path_1 in (case _2841 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2842-> _term_2); (2,f) -> u f (\_2843-> _term_2); }))); (10,f) -> u f (\_2844-> (let _2845 = _path_1 in (case _2845 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2846-> _term_2); (2,f) -> u f (\_2847-> _term_2); }))); (11,f) -> u f (\_2848-> (let _2849 = _path_1 in (case _2849 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2850-> _term_2); (2,f) -> u f (\_2851-> _term_2); }))); (12,f) -> u f (\_2852-> (let _2853 = _path_1 in (case _2853 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2854-> _term_2); (2,f) -> u f (\_2855-> _term_2); }))); (13,f) -> u f (\_2856-> (let _2857 = _path_1 in (case _2857 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2858-> _term_2); (2,f) -> u f (\_2859-> _term_2); }))); (14,f) -> u f (\_2860 _2861 _2862 _2863 _2864 _2865-> (let _2866 = _path_1 in (case _2866 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_2867-> _term_2); (2,f) -> u f (\_2868-> _term_2); }))); (15,f) -> u f (\_2869 _2870-> (u (u (u fm_term_patch_at _path_1) _2870) _fn_3)); })))))
fm_synth_fix = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_defs_6-> (\_errs_7-> (\_fixd_8-> (let _2871 = _errs_7 in (case _2871 of {(0,f) -> u f ((let _2872 = _fixd_8 in (if _2872 then (let _type_9=(u (u (u fm_term_bind list_nil) (\_x_9-> (u bits_i _x_9))) _type_5) in (let _term_10=(u (u (u fm_term_bind list_nil) (\_x_10-> (u bits_o _x_10))) _term_4) in (let _defs_11=(u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_10) _type_9) fm_status_init)) _defs_6) in (u (u monad_pure io_monad) (u maybe_some _defs_11))))) else (u (u monad_pure io_monad) maybe_none)))); (1,f) -> u f (\_2873 _2874-> (let _2875 = _2873 in (case _2875 of {(0,f) -> u f (\_2876 _2877 _2878 _2879-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _2874) _fixd_8)); (1,f) -> u f (\_2880 _2881 _2882 _2883 _2884-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _2874) _fixd_8)); (2,f) -> u f (\_2885-> (u (u (u monad_bind io_monad) (u (u fm_synth_one _2885) _defs_6)) (\_defs_12-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_12) _2874) bool_true)))); (3,f) -> u f (\_2886-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _2874) _fixd_8)); (4,f) -> u f (\_2887 _2888-> (let _2889 = _2887 in (case _2889 of {(0,f) -> u f ((u (u monad_pure io_monad) maybe_none)); (1,f) -> u f (\_2890-> (let _term_14=(u (u (u fm_term_patch_at _2890) _term_4) (\_x_14-> _2888)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_14) _type_5) _defs_6) _2874) bool_true))); (2,f) -> u f (\_2891-> (let _type_14=(u (u (u fm_term_patch_at _2891) _type_5) (\_x_14-> _2888)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_14) _defs_6) _2874) bool_true))); }))); (5,f) -> u f (\_2892 _2893-> (u (u (u monad_bind io_monad) (u (u fm_synth_one _2893) _defs_6)) (\_defs_13-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_13) _2874) bool_true)))); (6,f) -> u f (\_2894 _2895 _2896-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _2874) _fixd_8)); }))); }))))))))))
fm_status_fail = (\_errors_1-> (3,\t-> t _errors_1))
fm_synth_one = (\_name_1-> (\_defs_2-> (let _2897 = (u (u fm_get _name_1) _defs_2) in (case _2897 of {(0,f) -> u f ((u (u (u monad_bind io_monad) (u (u fm_synth_load _name_1) _defs_2)) (\_loaded_3-> (let _2898 = _loaded_3 in (case _2898 of {(0,f) -> u f ((u (u (u monad_bind io_monad) (u io_print (u string_flatten (u (u list_cons "Undefined: ") (u (u list_cons _name_1) list_nil))))) (\__4-> (u (u monad_pure io_monad) _defs_2)))); (1,f) -> u f (\_2899-> (u (u fm_synth_one _name_1) _2899)); }))))); (1,f) -> u f (\_2900-> (let _2901 = _2900 in (case _2901 of {(0,f) -> u f (\_2902 _2903 _2904 _2905 _2906 _2907-> (let _file_10=_2902 in (let _code_11=_2903 in (let _name_12=_2904 in (let _term_13=_2905 in (let _type_14=_2906 in (let _stat_15=_2907 in (let _2908 = _stat_15 in (case _2908 of {(0,f) -> u f ((let _defs_16=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) fm_status_wait)) _defs_2) in (let _checked_17=(u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _type_14) (u maybe_some fm_term_typ)) _defs_16) list_nil) (u fm_mpath_i fm_mpath_nil)) maybe_none)) (\_chk_type_17-> (u (u (u monad_bind fm_check_monad) (u (u (u (u (u (u fm_term_check _term_13) (u maybe_some _type_14)) _defs_16) list_nil) (u fm_mpath_o fm_mpath_nil)) maybe_none)) (\_chk_term_18-> (u (u monad_pure fm_check_monad) unit_new))))) in (let _2909 = _checked_17 in (case _2909 of {(0,f) -> u f (\_2910 _2911-> (let _2912 = (u list_is_empty _2911) in (if _2912 then (let _defs_20=(u (u (u (u (u (u (u fm_define _file_10) _code_11) _name_12) _term_13) _type_14) bool_true) _defs_16) in (u (u monad_pure io_monad) _defs_20)) else (u (u (u monad_bind io_monad) (u (u (u (u (u (u (u (u fm_synth_fix _file_10) _code_11) _name_12) _term_13) _type_14) _defs_16) _2911) bool_false)) (\_fixed_20-> (let _2913 = _fixed_20 in (case _2913 of {(0,f) -> u f ((let _stat_21=(u fm_status_fail _2911) in (let _defs_22=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) _stat_21)) _defs_16) in (u (u monad_pure io_monad) _defs_22)))); (1,f) -> u f (\_2914-> (u (u fm_synth_one _name_12) _2914)); }))))))); }))))); (1,f) -> u f ((u (u monad_pure io_monad) _defs_2)); (2,f) -> u f ((u (u monad_pure io_monad) _defs_2)); (3,f) -> u f (\_2915-> (u (u monad_pure io_monad) _defs_2)); }))))))))); }))); }))))
map_values_go = (\_xs_2-> (\_list_3-> (let _2916 = _xs_2 in (case _2916 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_2917 _2918 _2919-> (let _list0_7=(let _2920 = _2917 in (case _2920 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_2921-> (u (u list_cons _2921) _list_3)); })) in (let _list1_8=(u (u map_values_go _2918) _list0_7) in (let _list2_9=(u (u map_values_go _2919) _list1_8) in _list2_9)))); }))))
map_values = (\_xs_2-> (u (u map_values_go _xs_2) list_nil))
fm_name_show = (\_name_1-> _name_1)
bits_to_nat = (\_b_1-> (let _2922 = _b_1 in (case _2922 of {(0,f) -> u f (0); (1,f) -> u f (\_2923-> (((2::Integer) * (u bits_to_nat _2923)))); (2,f) -> u f (\_2924-> (u nat_succ (((2::Integer) * (u bits_to_nat _2924))))); })))
u16_show_hex = (\_a_1-> (let _2925 = _a_1 in (u (u nat_to_string_base 16) (u bits_to_nat (u word_to_bits (u16_to_word _2925))))))
fm_escape_char = (\_chr_1-> (let _2926 = (((_chr_1::Word16) == fm_backslash)) in (if _2926 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _2927 = (((_chr_1::Word16) == 34)) in (if _2927 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _2928 = (((_chr_1::Word16) == 39)) in (if _2928 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _2929 = (u (u (u u16_btw 32) _chr_1) 126) in (if _2929 then (u (u string_cons _chr_1) string_nil) else (u string_flatten (u (u list_cons (u (u string_cons fm_backslash) string_nil)) (u (u list_cons "u{") (u (u list_cons (u u16_show_hex _chr_1)) (u (u list_cons "}") (u (u list_cons string_nil) list_nil)))))))))))))))
fm_escape = (\_str_1-> (let _2930 = _str_1 in (if null (_2930::String) then string_nil else (let _head_4=(u fm_escape_char (fromIntegral (fromEnum (head _2930 :: Char)) :: Word16)) in (let _tail_5=(u fm_escape (tail _2930)) in (((_head_4::String) ++ _tail_5)))))))
fm_term_core = (\_term_1-> (let _2931 = _term_1 in (case _2931 of {(0,f) -> u f (\_2932 _2933-> (u fm_name_show _2932)); (1,f) -> u f (\_2934-> (u fm_name_show _2934)); (2,f) -> u f ("*"); (3,f) -> u f (\_2935 _2936 _2937 _2938 _2939-> (let _eras_7=_2935 in (let _init_8=(let _2940 = _eras_7 in (if _2940 then "%" else "@")) in (let _self_9=(u fm_name_show _2936) in (let _name_10=(u fm_name_show _2937) in (let _xtyp_11=(u fm_term_core _2938) in (let _body_12=(u fm_term_core (u (u _2939 (u (u fm_term_var _2936) 0)) (u (u fm_term_var _2937) 0))) in (u string_flatten (u (u list_cons _init_8) (u (u list_cons _self_9) (u (u list_cons "(") (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _xtyp_11) (u (u list_cons ") ") (u (u list_cons _body_12) list_nil)))))))))))))))); (4,f) -> u f (\_2941 _2942-> (let _name_4=(u fm_name_show _2941) in (let _body_5=(u fm_term_core (u _2942 (u (u fm_term_var _2941) 0))) in (u string_flatten (u (u list_cons "#") (u (u list_cons _name_4) (u (u list_cons " ") (u (u list_cons _body_5) list_nil)))))))); (5,f) -> u f (\_2943 _2944-> (let _func_4=(u fm_term_core _2943) in (let _argm_5=(u fm_term_core _2944) in (u string_flatten (u (u list_cons "(") (u (u list_cons _func_4) (u (u list_cons " ") (u (u list_cons _argm_5) (u (u list_cons ")") list_nil))))))))); (6,f) -> u f (\_2945 _2946 _2947-> (let _name_5=(u fm_name_show _2945) in (let _expr_6=(u fm_term_core _2946) in (let _body_7=(u fm_term_core (u _2947 (u (u fm_term_var _2945) 0))) in (u string_flatten (u (u list_cons "!") (u (u list_cons _name_5) (u (u list_cons " = ") (u (u list_cons _expr_6) (u (u list_cons "; ") (u (u list_cons _body_7) list_nil))))))))))); (7,f) -> u f (\_2948 _2949 _2950-> (let _name_5=(u fm_name_show _2948) in (let _expr_6=(u fm_term_core _2949) in (let _body_7=(u fm_term_core (u _2950 (u (u fm_term_var _2948) 0))) in (u string_flatten (u (u list_cons "$") (u (u list_cons _name_5) (u (u list_cons " = ") (u (u list_cons _expr_6) (u (u list_cons "; ") (u (u list_cons _body_7) list_nil))))))))))); (8,f) -> u f (\_2951 _2952 _2953-> (let _term_5=(u fm_term_core _2952) in (let _type_6=(u fm_term_core _2953) in (u string_flatten (u (u list_cons "{") (u (u list_cons _term_5) (u (u list_cons ":") (u (u list_cons _type_6) (u (u list_cons "}") list_nil))))))))); (9,f) -> u f (\_2954 _2955 _2956-> "<GOL>"); (10,f) -> u f (\_2957-> "<HOL>"); (11,f) -> u f (\_2958-> (u string_flatten (u (u list_cons "+") (u (u list_cons (u nat_show _2958)) list_nil)))); (12,f) -> u f (\_2959-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _2959)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_2960-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _2960)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_2961 _2962 _2963 _2964 _2965 _2966-> "<CSE>"); (15,f) -> u f (\_2967 _2968-> (u fm_term_core _2968)); })))
fm_defs_core = (\_defs_1-> (let _result_2="" in (let _result_3=(u (u (u list_for (u map_values _defs_1)) _result_2) (\_defn_3-> (\_result_4-> (let _2969 = _defn_3 in (case _2969 of {(0,f) -> u f (\_2970 _2971 _2972 _2973 _2974 _2975-> (let _2976 = _2975 in (case _2976 of {(0,f) -> u f (_result_4); (1,f) -> u f (_result_4); (2,f) -> u f ((let _name_11=_2972 in (let _term_12=(u fm_term_core _2973) in (let _type_13=(u fm_term_core _2974) in (u string_flatten (u (u list_cons _result_4) (u (u list_cons _name_11) (u (u list_cons " : ") (u (u list_cons _type_13) (u (u list_cons " = ") (u (u list_cons _term_12) (u (u list_cons ";\n") list_nil)))))))))))); (3,f) -> u f (\_2977-> _result_4); }))); }))))) in _result_3)))
fm_to_core_io_one = (\_name_1-> (u (u (u monad_bind io_monad) (u (u fm_synth_one _name_1) map_new)) (\_defs_2-> (u (u monad_pure io_monad) (u fm_defs_core _defs_2)))))
maybe_bind = (\_m_3-> (\_f_4-> (let _2978 = _m_3 in (case _2978 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_2979-> (u _f_4 _2979)); }))))
maybe_monad = (u (u monad_new maybe_bind) maybe_some)
fm_term_show_as_nat_go = (\_term_1-> (let _2980 = _term_1 in (case _2980 of {(0,f) -> u f (\_2981 _2982-> maybe_none); (1,f) -> u f (\_2983-> (let _2984 = (((_2983::String) == "Nat.zero")) in (if _2984 then (u maybe_some 0) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_2985 _2986 _2987 _2988 _2989-> maybe_none); (4,f) -> u f (\_2990 _2991-> maybe_none); (5,f) -> u f (\_2992 _2993-> (let _2994 = _2992 in (case _2994 of {(0,f) -> u f (\_2995 _2996-> maybe_none); (1,f) -> u f (\_2997-> (let _2998 = (((_2997::String) == "Nat.succ")) in (if _2998 then (u (u (u monad_bind maybe_monad) (u fm_term_show_as_nat_go _2993)) (\_pred_5-> (u (u monad_pure maybe_monad) (u nat_succ _pred_5)))) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_2999 _3000 _3001 _3002 _3003-> maybe_none); (4,f) -> u f (\_3004 _3005-> maybe_none); (5,f) -> u f (\_3006 _3007-> maybe_none); (6,f) -> u f (\_3008 _3009 _3010-> maybe_none); (7,f) -> u f (\_3011 _3012 _3013-> maybe_none); (8,f) -> u f (\_3014 _3015 _3016-> maybe_none); (9,f) -> u f (\_3017 _3018 _3019-> maybe_none); (10,f) -> u f (\_3020-> maybe_none); (11,f) -> u f (\_3021-> maybe_none); (12,f) -> u f (\_3022-> maybe_none); (13,f) -> u f (\_3023-> maybe_none); (14,f) -> u f (\_3024 _3025 _3026 _3027 _3028 _3029-> maybe_none); (15,f) -> u f (\_3030 _3031-> maybe_none); }))); (6,f) -> u f (\_3032 _3033 _3034-> maybe_none); (7,f) -> u f (\_3035 _3036 _3037-> maybe_none); (8,f) -> u f (\_3038 _3039 _3040-> maybe_none); (9,f) -> u f (\_3041 _3042 _3043-> maybe_none); (10,f) -> u f (\_3044-> maybe_none); (11,f) -> u f (\_3045-> maybe_none); (12,f) -> u f (\_3046-> maybe_none); (13,f) -> u f (\_3047-> maybe_none); (14,f) -> u f (\_3048 _3049 _3050 _3051 _3052 _3053-> maybe_none); (15,f) -> u f (\_3054 _3055-> maybe_none); })))
fm_term_show_as_nat = (\_term_1-> (u (u maybe_mapped (u fm_term_show_as_nat_go _term_1)) nat_show))
fm_term_show_is_ref = (\_term_1-> (\_name_2-> (let _3056 = _term_1 in (case _3056 of {(0,f) -> u f (\_3057 _3058-> bool_false); (1,f) -> u f (\_3059-> (((_name_2::String) == _3059))); (2,f) -> u f (bool_false); (3,f) -> u f (\_3060 _3061 _3062 _3063 _3064-> bool_false); (4,f) -> u f (\_3065 _3066-> bool_false); (5,f) -> u f (\_3067 _3068-> bool_false); (6,f) -> u f (\_3069 _3070 _3071-> bool_false); (7,f) -> u f (\_3072 _3073 _3074-> bool_false); (8,f) -> u f (\_3075 _3076 _3077-> bool_false); (9,f) -> u f (\_3078 _3079 _3080-> bool_false); (10,f) -> u f (\_3081-> bool_false); (11,f) -> u f (\_3082-> bool_false); (12,f) -> u f (\_3083-> bool_false); (13,f) -> u f (\_3084-> bool_false); (14,f) -> u f (\_3085 _3086 _3087 _3088 _3089 _3090-> bool_false); (15,f) -> u f (\_3091 _3092-> bool_false); }))))
nat_eql = (\a0-> \a1-> ((a0::Integer) == a1))
fm_term_show_app = (\_term_1-> (\_path_2-> (\_args_3-> (let _3093 = _term_1 in (case _3093 of {(0,f) -> u f (\_3094 _3095-> (let _arity_6=(u list_length _args_3) in (let _3096 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_6::Integer) == 3)))) in (if _3096 then (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_8=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_9=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_8) (u (u list_cons " == ") (u (u list_cons _eq_rgt_9) list_nil))))))) else (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_8=(let _3097 = _func_7 in (if null (_3097::String) then bool_false else ((((fromIntegral (fromEnum (head _3097 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_9=(u (u string_join ",") _args_3) in (let _func_10=(let _3098 = _wrap_8 in (if _3098 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_7) (u (u list_cons ")") list_nil)))) else _func_7)) in (u string_flatten (u (u list_cons _func_10) (u (u list_cons "(") (u (u list_cons _args_9) (u (u list_cons ")") list_nil))))))))))))); (1,f) -> u f (\_3099-> (let _arity_5=(u list_length _args_3) in (let _3100 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _3100 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _3101 = _func_6 in (if null (_3101::String) then bool_false else ((((fromIntegral (fromEnum (head _3101 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _3102 = _wrap_7 in (if _3102 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (2,f) -> u f ((let _arity_4=(u list_length _args_3) in (let _3103 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_4::Integer) == 3)))) in (if _3103 then (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_6=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_7=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_6) (u (u list_cons " == ") (u (u list_cons _eq_rgt_7) list_nil))))))) else (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_6=(let _3104 = _func_5 in (if null (_3104::String) then bool_false else ((((fromIntegral (fromEnum (head _3104 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_7=(u (u string_join ",") _args_3) in (let _func_8=(let _3105 = _wrap_6 in (if _3105 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_5) (u (u list_cons ")") list_nil)))) else _func_5)) in (u string_flatten (u (u list_cons _func_8) (u (u list_cons "(") (u (u list_cons _args_7) (u (u list_cons ")") list_nil))))))))))))); (3,f) -> u f (\_3106 _3107 _3108 _3109 _3110-> (let _arity_9=(u list_length _args_3) in (let _3111 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_9::Integer) == 3)))) in (if _3111 then (let _func_10=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_11=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_12=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_11) (u (u list_cons " == ") (u (u list_cons _eq_rgt_12) list_nil))))))) else (let _func_10=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_11=(let _3112 = _func_10 in (if null (_3112::String) then bool_false else ((((fromIntegral (fromEnum (head _3112 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_12=(u (u string_join ",") _args_3) in (let _func_13=(let _3113 = _wrap_11 in (if _3113 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_10) (u (u list_cons ")") list_nil)))) else _func_10)) in (u string_flatten (u (u list_cons _func_13) (u (u list_cons "(") (u (u list_cons _args_12) (u (u list_cons ")") list_nil))))))))))))); (4,f) -> u f (\_3114 _3115-> (let _arity_6=(u list_length _args_3) in (let _3116 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_6::Integer) == 3)))) in (if _3116 then (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_8=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_9=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_8) (u (u list_cons " == ") (u (u list_cons _eq_rgt_9) list_nil))))))) else (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_8=(let _3117 = _func_7 in (if null (_3117::String) then bool_false else ((((fromIntegral (fromEnum (head _3117 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_9=(u (u string_join ",") _args_3) in (let _func_10=(let _3118 = _wrap_8 in (if _3118 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_7) (u (u list_cons ")") list_nil)))) else _func_7)) in (u string_flatten (u (u list_cons _func_10) (u (u list_cons "(") (u (u list_cons _args_9) (u (u list_cons ")") list_nil))))))))))))); (5,f) -> u f (\_3119 _3120-> (let _argm_6=(u (u fm_term_show_go _3120) (u fm_mpath_i _path_2)) in (u (u (u fm_term_show_app _3119) (u fm_mpath_o _path_2)) (u (u list_cons _argm_6) _args_3)))); (6,f) -> u f (\_3121 _3122 _3123-> (let _arity_7=(u list_length _args_3) in (let _3124 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _3124 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _3125 = _func_8 in (if null (_3125::String) then bool_false else ((((fromIntegral (fromEnum (head _3125 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _3126 = _wrap_9 in (if _3126 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (7,f) -> u f (\_3127 _3128 _3129-> (let _arity_7=(u list_length _args_3) in (let _3130 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _3130 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _3131 = _func_8 in (if null (_3131::String) then bool_false else ((((fromIntegral (fromEnum (head _3131 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _3132 = _wrap_9 in (if _3132 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (8,f) -> u f (\_3133 _3134 _3135-> (let _arity_7=(u list_length _args_3) in (let _3136 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _3136 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _3137 = _func_8 in (if null (_3137::String) then bool_false else ((((fromIntegral (fromEnum (head _3137 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _3138 = _wrap_9 in (if _3138 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (9,f) -> u f (\_3139 _3140 _3141-> (let _arity_7=(u list_length _args_3) in (let _3142 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _3142 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _3143 = _func_8 in (if null (_3143::String) then bool_false else ((((fromIntegral (fromEnum (head _3143 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _3144 = _wrap_9 in (if _3144 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (10,f) -> u f (\_3145-> (let _arity_5=(u list_length _args_3) in (let _3146 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _3146 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _3147 = _func_6 in (if null (_3147::String) then bool_false else ((((fromIntegral (fromEnum (head _3147 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _3148 = _wrap_7 in (if _3148 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (11,f) -> u f (\_3149-> (let _arity_5=(u list_length _args_3) in (let _3150 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _3150 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _3151 = _func_6 in (if null (_3151::String) then bool_false else ((((fromIntegral (fromEnum (head _3151 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _3152 = _wrap_7 in (if _3152 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (12,f) -> u f (\_3153-> (let _arity_5=(u list_length _args_3) in (let _3154 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _3154 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _3155 = _func_6 in (if null (_3155::String) then bool_false else ((((fromIntegral (fromEnum (head _3155 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _3156 = _wrap_7 in (if _3156 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (13,f) -> u f (\_3157-> (let _arity_5=(u list_length _args_3) in (let _3158 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _3158 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _3159 = _func_6 in (if null (_3159::String) then bool_false else ((((fromIntegral (fromEnum (head _3159 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _3160 = _wrap_7 in (if _3160 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (14,f) -> u f (\_3161 _3162 _3163 _3164 _3165 _3166-> (let _arity_10=(u list_length _args_3) in (let _3167 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_10::Integer) == 3)))) in (if _3167 then (let _func_11=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_12=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_13=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_12) (u (u list_cons " == ") (u (u list_cons _eq_rgt_13) list_nil))))))) else (let _func_11=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_12=(let _3168 = _func_11 in (if null (_3168::String) then bool_false else ((((fromIntegral (fromEnum (head _3168 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_13=(u (u string_join ",") _args_3) in (let _func_14=(let _3169 = _wrap_12 in (if _3169 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_11) (u (u list_cons ")") list_nil)))) else _func_11)) in (u string_flatten (u (u list_cons _func_14) (u (u list_cons "(") (u (u list_cons _args_13) (u (u list_cons ")") list_nil))))))))))))); (15,f) -> u f (\_3170 _3171-> (let _arity_6=(u list_length _args_3) in (let _3172 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_6::Integer) == 3)))) in (if _3172 then (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_8=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_9=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_8) (u (u list_cons " == ") (u (u list_cons _eq_rgt_9) list_nil))))))) else (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_8=(let _3173 = _func_7 in (if null (_3173::String) then bool_false else ((((fromIntegral (fromEnum (head _3173 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_9=(u (u string_join ",") _args_3) in (let _func_10=(let _3174 = _wrap_8 in (if _3174 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_7) (u (u list_cons ")") list_nil)))) else _func_7)) in (u string_flatten (u (u list_cons _func_10) (u (u list_cons "(") (u (u list_cons _args_9) (u (u list_cons ")") list_nil))))))))))))); })))))
map_to_list_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _3175 = _xs_2 in (case _3175 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_3176 _3177 _3178-> (let _list0_8=(let _3179 = _3176 in (case _3179 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_3180-> (u (u list_cons (u (u pair_new (u bits_reverse _key_3)) _3180)) _list_4)); })) in (let _list1_9=(u (u (u map_to_list_go _3177) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_to_list_go _3178) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_to_list = (\_xs_2-> (u list_reverse (u (u (u map_to_list_go _xs_2) bits_e) list_nil)))
bits_chunks_of_go = (\_len_1-> (\_bits_2-> (\_need_3-> (\_chunk_4-> (let _3181 = _bits_2 in (case _3181 of {(0,f) -> u f ((u (u list_cons (u bits_reverse _chunk_4)) list_nil)); (1,f) -> u f (\_3182-> (let _3183 = _need_3 in (if _3183==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_o _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _3182) (_3183-1)) _chunk_7))))); (2,f) -> u f (\_3184-> (let _3185 = _need_3 in (if _3185==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_i _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _3184) (_3185-1)) _chunk_7))))); }))))))
bits_chunks_of = (\_len_1-> (\_bits_2-> (u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e)))
word_from_bits = (\_size_1-> (\_bits_2-> (let _3186 = _size_1 in (if _3186==0 then word_e else (let _3187 = _bits_2 in (case _3187 of {(0,f) -> u f ((u word_o (u (u word_from_bits (_3186-1)) bits_e))); (1,f) -> u f (\_3188-> (u word_o (u (u word_from_bits (_3186-1)) _3188))); (2,f) -> u f (\_3189-> (u word_i (u (u word_from_bits (_3186-1)) _3189))); }))))))
fm_name_from_bits = (\_bits_1-> (let _list_2=(u (u bits_chunks_of 6) _bits_1) in (let _name_3=(u (u (u list_fold _list_2) string_nil) (\_bts_3-> (\_name_4-> (let _u16_5=(u u16_new (u (u word_from_bits 16) (u bits_reverse _bts_3))) in (let _chr_6=(let _3190 = (u (u (u u16_btw 0) _u16_5) 25) in (if _3190 then (((_u16_5::Word16) + 65)) else (let _3191 = (u (u (u u16_btw 26) _u16_5) 51) in (if _3191 then (((_u16_5::Word16) + 71)) else (let _3192 = (u (u (u u16_btw 52) _u16_5) 61) in (if _3192 then (((_u16_5::Word16) - 4)) else (let _3193 = (((62::Word16) == _u16_5)) in (if _3193 then 46 else 95)))))))) in (u (u string_cons _chr_6) _name_4)))))) in _name_3)))
pair_fst = (\_pair_3-> (let _3194 = _pair_3 in (case _3194 of {(0,f) -> u f (\_3195 _3196-> _3195); })))
fm_term_show_go = (\_term_1-> (\_path_2-> (let _3197 = (u fm_term_show_as_nat _term_1) in (case _3197 of {(0,f) -> u f ((let _3198 = _term_1 in (case _3198 of {(0,f) -> u f (\_3199 _3200-> (u fm_name_show _3199)); (1,f) -> u f (\_3201-> (let _name_4=(u fm_name_show _3201) in (let _3202 = _path_2 in (case _3202 of {(0,f) -> u f (_name_4); (1,f) -> u f (\_3203-> (let _path_val_6=(u (u bits_concat (u fm_path_to_bits _3203)) (u bits_i bits_e)) in (let _path_str_7=(u nat_show (u bits_to_nat _path_val_6)) in (u string_flatten (u (u list_cons _name_4) (u (u list_cons (u (u fm_color "2") ((("-"::String) ++ _path_str_7)))) list_nil)))))); })))); (2,f) -> u f ("Type"); (3,f) -> u f (\_3204 _3205 _3206 _3207 _3208-> (let _eras_8=_3204 in (let _self_9=(u fm_name_show _3205) in (let _name_10=(u fm_name_show _3206) in (let _type_11=(u (u fm_term_show_go _3207) (u fm_mpath_o _path_2)) in (let _open_12=(let _3209 = _eras_8 in (if _3209 then "<" else "(")) in (let _clos_13=(let _3210 = _eras_8 in (if _3210 then ">" else ")")) in (let _body_14=(u (u fm_term_show_go (u (u _3208 (u (u fm_term_var _3205) 0)) (u (u fm_term_var _3206) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _self_9) (u (u list_cons _open_12) (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _type_11) (u (u list_cons _clos_13) (u (u list_cons " ") (u (u list_cons _body_14) list_nil))))))))))))))))); (4,f) -> u f (\_3211 _3212-> (let _name_5=(u fm_name_show _3211) in (let _body_6=(u (u fm_term_show_go (u _3212 (u (u fm_term_var _3211) 0))) (u fm_mpath_o _path_2)) in (u string_flatten (u (u list_cons "(") (u (u list_cons _name_5) (u (u list_cons ") ") (u (u list_cons _body_6) list_nil)))))))); (5,f) -> u f (\_3213 _3214-> (u (u (u fm_term_show_app _term_1) _path_2) list_nil)); (6,f) -> u f (\_3215 _3216 _3217-> (let _name_6=(u fm_name_show _3215) in (let _expr_7=(u (u fm_term_show_go _3216) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _3217 (u (u fm_term_var _3215) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "let ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (7,f) -> u f (\_3218 _3219 _3220-> (let _name_6=(u fm_name_show _3218) in (let _expr_7=(u (u fm_term_show_go _3219) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _3220 (u (u fm_term_var _3218) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "def ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (8,f) -> u f (\_3221 _3222 _3223-> (let _term_6=(u (u fm_term_show_go _3222) (u fm_mpath_o _path_2)) in (let _type_7=(u (u fm_term_show_go _3223) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _term_6) (u (u list_cons "::") (u (u list_cons _type_7) list_nil))))))); (9,f) -> u f (\_3224 _3225 _3226-> (let _name_6=(u fm_name_show _3224) in (u string_flatten (u (u list_cons "?") (u (u list_cons _name_6) list_nil))))); (10,f) -> u f (\_3227-> "_"); (11,f) -> u f (\_3228-> (u string_flatten (u (u list_cons (u nat_show _3228)) list_nil))); (12,f) -> u f (\_3229-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _3229)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_3230-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _3230)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_3231 _3232 _3233 _3234 _3235 _3236-> (let _expr_9=(u (u fm_term_show_go _3232) (u fm_mpath_o _path_2)) in (let _name_10=(u fm_name_show _3233) in (let _wyth_11=(u (u string_join "") (u (u list_mapped _3234) (\_defn_11-> (let _3237 = _defn_11 in (case _3237 of {(0,f) -> u f (\_3238 _3239 _3240 _3241 _3242 _3243-> (let _name_18=(u fm_name_show _3240) in (let _type_19=(u (u fm_term_show_go _3242) maybe_none) in (let _term_20=(u (u fm_term_show_go _3241) maybe_none) in (u string_flatten (u (u list_cons _name_18) (u (u list_cons ": ") (u (u list_cons _type_19) (u (u list_cons " = ") (u (u list_cons _term_20) (u (u list_cons ";") list_nil))))))))))); }))))) in (let _cses_12=(u map_to_list _3235) in (let _cses_13=(u (u string_join "") (u (u list_mapped _cses_12) (\_x_13-> (let _name_14=(u fm_name_from_bits (u pair_fst _x_13)) in (let _term_15=(u (u fm_term_show_go (u pair_snd _x_13)) maybe_none) in (u string_flatten (u (u list_cons _name_14) (u (u list_cons ": ") (u (u list_cons _term_15) (u (u list_cons "; ") list_nil)))))))))) in (let _moti_14=(let _3244 = _3236 in (case _3244 of {(0,f) -> u f (""); (1,f) -> u f (\_3245-> (u string_flatten (u (u list_cons ": ") (u (u list_cons (u (u fm_term_show_go _3245) maybe_none)) list_nil)))); })) in (u string_flatten (u (u list_cons "case ") (u (u list_cons _expr_9) (u (u list_cons " as ") (u (u list_cons _name_10) (u (u list_cons _wyth_11) (u (u list_cons " { ") (u (u list_cons _cses_13) (u (u list_cons "}") (u (u list_cons _moti_14) list_nil))))))))))))))))); (15,f) -> u f (\_3246 _3247-> (u (u fm_term_show_go _3247) _path_2)); }))); (1,f) -> u f (\_3248-> _3248); }))))
fm_term_show = (\_term_1-> (u (u fm_term_show_go _term_1) maybe_none))
fm_error_relevant = (\_errors_1-> (\_got_2-> (let _3249 = _errors_1 in (case _3249 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3250 _3251-> (let _keep_5=(let _3252 = _3250 in (case _3252 of {(0,f) -> u f (\_3253 _3254 _3255 _3256-> ((not _got_2))); (1,f) -> u f (\_3257 _3258 _3259 _3260 _3261-> bool_true); (2,f) -> u f (\_3262-> bool_false); (3,f) -> u f (\_3263-> bool_false); (4,f) -> u f (\_3264 _3265-> bool_false); (5,f) -> u f (\_3266 _3267-> ((not _got_2))); (6,f) -> u f (\_3268 _3269 _3270-> ((not _got_2))); })) in (let _got_6=(let _3271 = _3250 in (case _3271 of {(0,f) -> u f (\_3272 _3273 _3274 _3275-> bool_true); (1,f) -> u f (\_3276 _3277 _3278 _3279 _3280-> _got_2); (2,f) -> u f (\_3281-> _got_2); (3,f) -> u f (\_3282-> _got_2); (4,f) -> u f (\_3283 _3284-> _got_2); (5,f) -> u f (\_3285 _3286-> bool_true); (6,f) -> u f (\_3287 _3288 _3289-> _got_2); })) in (let _tail_7=(u (u fm_error_relevant _3251) _got_6) in (let _3290 = _keep_5 in (if _3290 then (u (u list_cons _3250) _tail_7) else _tail_7)))))); }))))
fm_context_show = (\_context_1-> (let _3291 = _context_1 in (case _3291 of {(0,f) -> u f (""); (1,f) -> u f (\_3292 _3293-> (let _3294 = _3292 in (case _3294 of {(0,f) -> u f (\_3295 _3296-> (let _name_6=(u fm_name_show _3295) in (let _type_7=(u fm_term_show _3296) in (let _rest_8=(u fm_context_show _3293) in (u string_flatten (u (u list_cons _rest_8) (u (u list_cons "- ") (u (u list_cons _name_6) (u (u list_cons ": ") (u (u list_cons _type_7) (u (u list_cons "\n") list_nil))))))))))); }))); })))
fm_term_expand_at = (\_path_1-> (\_term_2-> (\_defs_3-> (u (u (u fm_term_patch_at _path_1) _term_2) (\_term_4-> (let _3297 = _term_4 in (case _3297 of {(0,f) -> u f (\_3298 _3299-> _term_4); (1,f) -> u f (\_3300-> (let _3301 = (u (u fm_get _3300) _defs_3) in (case _3301 of {(0,f) -> u f ((u fm_term_ref _3300)); (1,f) -> u f (\_3302-> (let _3303 = _3302 in (case _3303 of {(0,f) -> u f (\_3304 _3305 _3306 _3307 _3308 _3309-> _3307); }))); }))); (2,f) -> u f (_term_4); (3,f) -> u f (\_3310 _3311 _3312 _3313 _3314-> _term_4); (4,f) -> u f (\_3315 _3316-> _term_4); (5,f) -> u f (\_3317 _3318-> _term_4); (6,f) -> u f (\_3319 _3320 _3321-> _term_4); (7,f) -> u f (\_3322 _3323 _3324-> _term_4); (8,f) -> u f (\_3325 _3326 _3327-> _term_4); (9,f) -> u f (\_3328 _3329 _3330-> _term_4); (10,f) -> u f (\_3331-> _term_4); (11,f) -> u f (\_3332-> _term_4); (12,f) -> u f (\_3333-> _term_4); (13,f) -> u f (\_3334-> _term_4); (14,f) -> u f (\_3335 _3336 _3337 _3338 _3339 _3340-> _term_4); (15,f) -> u f (\_3341 _3342-> _term_4); })))))))
bool_or = (\a0-> \a1-> (a0 || a1))
fm_term_expand_ct = (\_term_1-> (\_defs_2-> (\_arity_3-> (let _3343 = _term_1 in (case _3343 of {(0,f) -> u f (\_3344 _3345-> (u (u fm_term_var _3344) _3345)); (1,f) -> u f (\_3346-> (let _expand_5=bool_false in (let _expand_6=(((((((_3346::String) == "Nat.succ")) && (((_arity_3::Integer) > 1)))) || _expand_5)) in (let _expand_7=(((((((_3346::String) == "Nat.zero")) && (((_arity_3::Integer) > 0)))) || _expand_6)) in (let _expand_8=(((((((_3346::String) == "Bool.true")) && (((_arity_3::Integer) > 0)))) || _expand_7)) in (let _expand_9=(((((((_3346::String) == "Bool.false")) && (((_arity_3::Integer) > 0)))) || _expand_8)) in (let _3347 = _expand_9 in (if _3347 then (let _3348 = (u (u fm_get _3346) _defs_2) in (case _3348 of {(0,f) -> u f ((u fm_term_ref _3346)); (1,f) -> u f (\_3349-> (let _3350 = _3349 in (case _3350 of {(0,f) -> u f (\_3351 _3352 _3353 _3354 _3355 _3356-> _3354); }))); })) else (u fm_term_ref _3346))))))))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3357 _3358 _3359 _3360 _3361-> (u (u (u (u (u fm_term_all _3357) _3358) _3359) (u (u (u fm_term_expand_ct _3360) _defs_2) 0)) (\_s_9-> (\_x_10-> (u (u (u fm_term_expand_ct (u (u _3361 _s_9) _x_10)) _defs_2) 0))))); (4,f) -> u f (\_3362 _3363-> (u (u fm_term_lam _3362) (\_x_6-> (u (u (u fm_term_expand_ct (u _3363 _x_6)) _defs_2) 0)))); (5,f) -> u f (\_3364 _3365-> (u (u fm_term_app (u (u (u fm_term_expand_ct _3364) _defs_2) (u nat_succ _arity_3))) (u (u (u fm_term_expand_ct _3365) _defs_2) 0))); (6,f) -> u f (\_3366 _3367 _3368-> (u (u (u fm_term_let _3366) (u (u (u fm_term_expand_ct _3367) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _3368 _x_7)) _defs_2) 0)))); (7,f) -> u f (\_3369 _3370 _3371-> (u (u (u fm_term_def _3369) (u (u (u fm_term_expand_ct _3370) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _3371 _x_7)) _defs_2) 0)))); (8,f) -> u f (\_3372 _3373 _3374-> (u (u (u fm_term_ann _3372) (u (u (u fm_term_expand_ct _3373) _defs_2) 0)) (u (u (u fm_term_expand_ct _3374) _defs_2) 0))); (9,f) -> u f (\_3375 _3376 _3377-> (u (u (u fm_term_gol _3375) _3376) _3377)); (10,f) -> u f (\_3378-> (u fm_term_hol _3378)); (11,f) -> u f (\_3379-> (u fm_term_nat _3379)); (12,f) -> u f (\_3380-> (u fm_term_chr _3380)); (13,f) -> u f (\_3381-> (u fm_term_str _3381)); (14,f) -> u f (\_3382 _3383 _3384 _3385 _3386 _3387-> _term_1); (15,f) -> u f (\_3388 _3389-> (u (u fm_term_ori _3388) _3389)); })))))
fm_term_expand = (\_dref_1-> (\_term_2-> (\_defs_3-> (let _term_4=(u (u fm_term_normalize _term_2) map_new) in (let _term_5=(u (u (u list_for _dref_1) _term_4) (\_path_5-> (\_term_6-> (let _term_7=(u (u (u fm_term_expand_at _path_5) _term_6) _defs_3) in (let _term_8=(u (u fm_term_normalize _term_7) map_new) in (let _term_9=(u (u (u fm_term_expand_ct _term_8) _defs_3) 0) in (let _term_10=(u (u fm_term_normalize _term_9) map_new) in _term_10))))))) in _term_5)))))
fm_error_show = (\_error_1-> (\_defs_2-> (let _3390 = _error_1 in (case _3390 of {(0,f) -> u f (\_3391 _3392 _3393 _3394-> (let _expected_7=(let _3395 = _3392 in (case _3395 of {(0,f) -> u f (\_3396-> _3396); (1,f) -> u f (\_3397-> (u fm_term_show (u (u fm_term_normalize _3397) map_new))); })) in (let _detected_8=(let _3398 = _3393 in (case _3398 of {(0,f) -> u f (\_3399-> _3399); (1,f) -> u f (\_3400-> (u fm_term_show (u (u fm_term_normalize _3400) map_new))); })) in (u string_flatten (u (u list_cons "Type mismatch.\n") (u (u list_cons "- Expected: ") (u (u list_cons _expected_7) (u (u list_cons "\n") (u (u list_cons "- Detected: ") (u (u list_cons _detected_8) (u (u list_cons "\n") (u (u list_cons (let _3401 = _3394 in (case _3401 of {(0,f) -> u f (""); (1,f) -> u f (\_3402 _3403-> (u string_flatten (u (u list_cons "With context:\n") (u (u list_cons (u fm_context_show _3394)) list_nil)))); }))) list_nil)))))))))))); (1,f) -> u f (\_3404 _3405 _3406 _3407 _3408-> (let _goal_name_8=(u string_flatten (u (u list_cons "Goal ?") (u (u list_cons (u fm_name_show _3404)) (u (u list_cons ":\n") list_nil)))) in (let _with_type_9=(let _3409 = _3407 in (case _3409 of {(0,f) -> u f (""); (1,f) -> u f (\_3410-> (let _goal_10=(u (u (u fm_term_expand _3405) _3410) _defs_2) in (u string_flatten (u (u list_cons "With type: ") (u (u list_cons (let _3411 = _3406 in (if _3411 then (u (u fm_term_show_go _goal_10) (u maybe_some (\_x_11-> _x_11))) else (u fm_term_show _goal_10)))) (u (u list_cons "\n") list_nil)))))); })) in (let _with_ctxt_10=(let _3412 = _3408 in (case _3412 of {(0,f) -> u f (""); (1,f) -> u f (\_3413 _3414-> (u string_flatten (u (u list_cons "With ctxt:\n") (u (u list_cons (u fm_context_show _3408)) list_nil)))); })) in (u string_flatten (u (u list_cons _goal_name_8) (u (u list_cons _with_type_9) (u (u list_cons _with_ctxt_10) list_nil)))))))); (2,f) -> u f (\_3415-> (u string_flatten (u (u list_cons "Waiting for '") (u (u list_cons _3415) (u (u list_cons "'.") list_nil))))); (3,f) -> u f (\_3416-> (u string_flatten (u (u list_cons "Error on dependency '") (u (u list_cons _3416) (u (u list_cons "'.") list_nil))))); (4,f) -> u f (\_3417 _3418-> (u string_flatten (u (u list_cons "Patching: ") (u (u list_cons (u fm_term_show _3418)) list_nil)))); (5,f) -> u f (\_3419 _3420-> (u string_flatten (u (u list_cons "Undefined reference: ") (u (u list_cons (u fm_name_show _3420)) (u (u list_cons "\n") list_nil))))); (6,f) -> u f (\_3421 _3422 _3423-> (let _term_6=(u fm_term_show _3422) in (let _context_7=(u fm_context_show _3423) in (u string_flatten (u (u list_cons "Can't infer type of: ") (u (u list_cons _term_6) (u (u list_cons "\n") (u (u list_cons "With ctxt:\n") (u (u list_cons _context_7) list_nil))))))))); }))))
fm_error_origin = (\_error_1-> (let _3424 = _error_1 in (case _3424 of {(0,f) -> u f (\_3425 _3426 _3427 _3428-> _3425); (1,f) -> u f (\_3429 _3430 _3431 _3432 _3433-> maybe_none); (2,f) -> u f (\_3434-> maybe_none); (3,f) -> u f (\_3435-> maybe_none); (4,f) -> u f (\_3436 _3437-> maybe_none); (5,f) -> u f (\_3438 _3439-> _3438); (6,f) -> u f (\_3440 _3441 _3442-> _3440); })))
fm_defs_report_go = (\_defs_1-> (\_list_2-> (\_errs_3-> (\_typs_4-> (let _3443 = _list_2 in (case _3443 of {(0,f) -> u f ((u string_flatten (u (u list_cons _typs_4) (u (u list_cons "\n") (u (u list_cons (let _3444 = _errs_3 in (if null (_3444::String) then "All terms check." else _errs_3))) list_nil))))); (1,f) -> u f (\_3445 _3446-> (let _name_7=_3445 in (let _3447 = (u (u fm_get _name_7) _defs_1) in (case _3447 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _3446) _errs_3) _typs_4)); (1,f) -> u f (\_3448-> (let _3449 = _3448 in (case _3449 of {(0,f) -> u f (\_3450 _3451 _3452 _3453 _3454 _3455-> (let _typs_15=(u string_flatten (u (u list_cons _typs_4) (u (u list_cons _name_7) (u (u list_cons ": ") (u (u list_cons (u fm_term_show _3454)) (u (u list_cons "\n") list_nil)))))) in (let _3456 = _3455 in (case _3456 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _3446) _errs_3) _typs_15)); (1,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _3446) _errs_3) _typs_15)); (2,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _3446) _errs_3) _typs_15)); (3,f) -> u f (\_3457-> (let _3458 = _3457 in (case _3458 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _3446) _errs_3) _typs_15)); (1,f) -> u f (\_3459 _3460-> (let _name_str_19=(u fm_name_show _3452) in (let _rel_errs_20=(u (u fm_error_relevant _3457) bool_false) in (let _rel_msgs_21=(u (u list_mapped _rel_errs_20) (\_err_21-> (u string_flatten (u (u list_cons (u (u fm_error_show _err_21) _defs_1)) (u (u list_cons (let _3461 = (u fm_error_origin _err_21) in (case _3461 of {(0,f) -> u f (""); (1,f) -> u f (\_3462-> (let _3463 = _3462 in (case _3463 of {(0,f) -> u f (\_3464 _3465 _3466-> (u string_flatten (u (u list_cons "Inside '") (u (u list_cons _3450) (u (u list_cons "':\n") (u (u list_cons (u (u (u fm_highlight _3451) _3465) _3466)) (u (u list_cons "\n") list_nil))))))); }))); }))) list_nil))))) in (let _errs_22=(u string_flatten (u (u list_cons _errs_3) (u (u list_cons (u (u string_join "\n") _rel_msgs_21)) (u (u list_cons "\n") list_nil)))) in (u (u (u (u fm_defs_report_go _defs_1) _3446) _errs_22) _typs_15)))))); }))); })))); }))); })))); }))))))
fm_defs_report = (\_defs_1-> (\_list_2-> (u (u (u (u fm_defs_report_go _defs_1) _list_2) "") "")))
fm_checker_io_one = (\_name_1-> (u (u (u monad_bind io_monad) (u (u fm_synth_one _name_1) map_new)) (\_defs_2-> (u io_print (u (u fm_defs_report _defs_2) (u (u list_cons _name_1) list_nil))))))
map_keys_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _3467 = _xs_2 in (case _3467 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_3468 _3469 _3470-> (let _list0_8=(let _3471 = _3468 in (case _3471 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_3472-> (u (u list_cons (u bits_reverse _key_3)) _list_4)); })) in (let _list1_9=(u (u (u map_keys_go _3469) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_keys_go _3470) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_keys = (\_xs_2-> (u list_reverse (u (u (u map_keys_go _xs_2) bits_e) list_nil)))
fm_synth_many = (\_names_1-> (\_defs_2-> (let _3473 = _names_1 in (case _3473 of {(0,f) -> u f ((u (u monad_pure io_monad) _defs_2)); (1,f) -> u f (\_3474 _3475-> (u (u (u monad_bind io_monad) (u (u fm_synth_one _3474) _defs_2)) (\_defs_5-> (u (u fm_synth_many _3475) _defs_5)))); }))))
fm_synth_file = (\_file_1-> (\_defs_2-> (u (u (u monad_bind io_monad) (u io_get_file _file_1)) (\_code_3-> (let _read_4=(u (u (u fm_defs_read _file_1) _code_3) _defs_2) in (let _3476 = _read_4 in (case _3476 of {(0,f) -> u f (\_3477-> (u (u monad_pure io_monad) (u either_left _3477))); (1,f) -> u f (\_3478-> (let _file_defs_6=_3478 in (let _file_keys_7=(u map_keys _file_defs_6) in (let _file_nams_8=(u (u list_mapped _file_keys_7) fm_name_from_bits) in (u (u (u monad_bind io_monad) (u (u fm_synth_many _file_nams_8) _file_defs_6)) (\_defs_9-> (u (u monad_pure io_monad) (u either_right (u (u pair_new _file_nams_8) _defs_9))))))))); })))))))
fm_checker_io_file = (\_file_1-> (u (u (u monad_bind io_monad) (u (u fm_synth_file _file_1) map_new)) (\_loaded_2-> (let _3479 = _loaded_2 in (case _3479 of {(0,f) -> u f (\_3480-> (u (u (u monad_bind io_monad) (u io_print (u string_flatten (u (u list_cons "On '") (u (u list_cons _file_1) (u (u list_cons "':") list_nil)))))) (\__4-> (u io_print _3480)))); (1,f) -> u f (\_3481-> (let _3482 = _3481 in (case _3482 of {(0,f) -> u f (\_3483 _3484-> (let _nams_6=_3483 in (let _defs_7=_3484 in (u io_print (u (u fm_defs_report _defs_7) _nams_6))))); }))); })))))
io_purify = (\_io_2-> (let _3485 = _io_2 in (case _3485 of {(0,f) -> u f (\_3486-> _3486); (1,f) -> u f (\_3487 _3488 _3489-> (u io_purify (u _3489 ""))); })))
fm_checker_code = (\_code_1-> (let _3490 = (u (u (u fm_defs_read "Main.fm") _code_1) map_new) in (case _3490 of {(0,f) -> u f (\_3491-> _3491); (1,f) -> u f (\_3492-> (u io_purify (let _defs_3=_3492 in (let _nams_4=(u (u list_mapped (u map_keys _defs_3)) fm_name_from_bits) in (u (u (u monad_bind io_monad) (u (u fm_synth_many _nams_4) _defs_3)) (\_defs_5-> (u (u monad_pure io_monad) (u (u fm_defs_report _defs_5) _nams_4)))))))); })))
fm_term_read = (\_code_1-> (let _3493 = (u (u fm_parser_term 0) _code_1) in (case _3493 of {(0,f) -> u f (\_3494 _3495 _3496-> maybe_none); (1,f) -> u f (\_3497 _3498 _3499-> (u maybe_some _3499)); })))
fm = (let ___1=fm_to_core_io_one in (let ___2=fm_checker_io_one in (let ___3=fm_checker_io_file in (let ___4=fm_checker_code in (let ___5=fm_term_read in (u fm_checker_io_file "Main.fm"))))))

